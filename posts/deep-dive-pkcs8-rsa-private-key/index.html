<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Deep dive - Anatomy of a PKCS#8 RSA private key | Learn part by part</title>
<meta name=keywords content="pkcs#8,openssl,rsa,privatekey,deepdive,pem,der"><meta name=description content="Dissect and explore a PKCS#8 RSA private key in PEM format"><meta name=author content><link rel=canonical href=https://partbypart.github.io/posts/deep-dive-pkcs8-rsa-private-key/><meta name=google-site-verification content="G-MF6MC03DXC"><link crossorigin=anonymous href=/assets/css/stylesheet.c7cdf9ec6ae3b64eadba619dd56fa18edf29c5eccfcb44ab0084078b63dfa9c7.css integrity="sha256-x8357Grjtk6tumGd1W+hjt8pxezPy0SrAIQHi2Pfqcc=" rel="preload stylesheet" as=style><link rel=icon href=https://partbypart.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://partbypart.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://partbypart.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://partbypart.github.io/apple-touch-icon.png><link rel=mask-icon href=https://partbypart.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=alternate hreflang=en href=https://partbypart.github.io/posts/deep-dive-pkcs8-rsa-private-key/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-MF6MC03DXC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-MF6MC03DXC")}</script><meta property="og:url" content="https://partbypart.github.io/posts/deep-dive-pkcs8-rsa-private-key/"><meta property="og:site_name" content="Learn part by part"><meta property="og:title" content="Deep dive - Anatomy of a PKCS#8 RSA private key"><meta property="og:description" content="Dissect and explore a PKCS#8 RSA private key in PEM format"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-26T00:00:00+00:00"><meta property="article:modified_time" content="2023-08-26T00:00:00+00:00"><meta property="article:tag" content="Pkcs#8"><meta property="article:tag" content="Openssl"><meta property="article:tag" content="Rsa"><meta property="article:tag" content="Privatekey"><meta property="article:tag" content="Deepdive"><meta property="article:tag" content="Pem"><meta property="og:image" content="https://partbypart.github.io/posts/deep-dive-pkcs8-rsa-private-key/images/pkcs8-private.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://partbypart.github.io/posts/deep-dive-pkcs8-rsa-private-key/images/pkcs8-private.png"><meta name=twitter:title content="Deep dive - Anatomy of a PKCS#8 RSA private key"><meta name=twitter:description content="Dissect and explore a PKCS#8 RSA private key in PEM format"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://partbypart.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Deep dive - Anatomy of a PKCS#8 RSA private key","item":"https://partbypart.github.io/posts/deep-dive-pkcs8-rsa-private-key/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Deep dive - Anatomy of a PKCS#8 RSA private key","name":"Deep dive - Anatomy of a PKCS#8 RSA private key","description":"Dissect and explore a PKCS#8 RSA private key in PEM format","keywords":["pkcs#8","openssl","rsa","privatekey","deepdive","pem","der"],"articleBody":"Prerequisites Linux/MacOS openssl command line tool (version 1.0.2 or higher) RSA key components 101 - ASN.1, DER, PEM, PKCS#1, PKCS#8 Quick bytes - Basics of Distinguished Encoding Rules Part 1 - ASN.1 syntax to store RSA private key in PKCS#8 format RSA Private key syntax. (Additional reference: AlgorithmIdentifier syntax) PrivateKeyInfo ::= SEQUENCE { version Version, privateKeyAlgorithm AlgorithmIdentifier {{PrivateKeyAlgorithms}}, privateKey PrivateKey, -- \"RSAPrivateKey\" for an RSA private key attributes [0] Attributes OPTIONAL } Version ::= INTEGER {v1(0)} (v1,...) PrivateKeyAlgorithmIdentifier ::= AlgorithmIdentifier AlgorithmIdentifier ::= SEQUENCE { algorithm OBJECT IDENTIFIER, parameters ANY DEFINED BY algorithm OPTIONAL } PrivateKey ::= OCTET STRING -- \"RSAPrivateKey\" for an RSA private key Attributes ::= SET OF Attributes For an RSA private key, the contents of PrivateKey are a BER encoding of a value of type RSAPrivateKey (Reference). Here’s the ASN.1 syntax for RSAPrivateKey as specified by RFC8017 RSAPrivateKey ::= SEQUENCE { version Version, modulus INTEGER, -- n publicExponent INTEGER, -- e privateExponent INTEGER, -- d prime1 INTEGER, -- p prime2 INTEGER, -- q exponent1 INTEGER, -- d mod (p-1) exponent2 INTEGER, -- d mod (q-1) coefficient INTEGER, -- (inverse of q) mod p otherPrimeInfos OtherPrimeInfos OPTIONAL } openssl genrsa and openssl genpkey command in OpenSSL 3 (or higher) generate RSA private key in PKCS #8 format by default. openssl genrsa in OpenSSL 1.0.2 generates RSA private key in PKCS#1 format by default. openssl pkcs8 can be used in OpenSSL 1.0.2 to convert RSA private key in PKCS#1 to PKCS#8 format Verify PKCS #8 RSA private key syntax $ openssl version -v OpenSSL 1.0.2s 28 May 2019 # Create a sample 2048 bit RSA private key (PKCS #1 by default) $ openssl genrsa -out /tmp/id_rsa_2048_pkcs1.pem 2048 $ grep \"BEGIN\\|END\" /tmp/id_rsa_2048_pkcs1.pem -----BEGIN RSA PRIVATE KEY----- -----END RSA PRIVATE KEY----- # Read a traditional format private key and write a PKCS#8 format key $ openssl pkcs8 -topk8 -in /tmp/id_rsa_2048_pkcs1.pem -nocrypt -out /tmp/id_rsa_2048_pkcs8.pem $ grep \"BEGIN\\|END\" /tmp/id_rsa_2048_pkcs8.pem -----BEGIN PRIVATE KEY----- -----END PRIVATE KEY----- $ openssl asn1parse -in /tmp/id_rsa_2048_pkcs8.pem -i 0:d=0 hl=4 l=1213 cons: SEQUENCE 4:d=1 hl=2 l= 1 prim: INTEGER :00 7:d=1 hl=2 l= 13 cons: SEQUENCE 9:d=2 hl=2 l= 9 prim: OBJECT :rsaEncryption 20:d=2 hl=2 l= 0 prim: NULL 22:d=1 hl=4 l=1191 prim: OCTET STRING [HEX DUMP]:3082...E155 # Drill into the OCTET STRING at offset 22 $ openssl asn1parse -in /tmp/id_rsa_2048_pkcs8.pem -i -strparse 22 0:d=0 hl=4 l=1187 cons: SEQUENCE 4:d=1 hl=2 l= 1 prim: INTEGER :00 7:d=1 hl=4 l= 257 prim: INTEGER :DE95...E8D7 268:d=1 hl=2 l= 3 prim: INTEGER :010001 273:d=1 hl=4 l= 256 prim: INTEGER :0799...41F1 533:d=1 hl=3 l= 129 prim: INTEGER :F967...AE4F 665:d=1 hl=3 l= 129 prim: INTEGER :E478...42F9 797:d=1 hl=3 l= 128 prim: INTEGER :72A7...7BA1 928:d=1 hl=3 l= 129 prim: INTEGER :B1B5...2701 1060:d=1 hl=3 l= 128 prim: INTEGER :47D8...E155 Part 2 - Commonly used tag values Tag (hex) Type 0x02 INTEGER 0x03 BIT STRING 0x04 OCTET STRING 0x05 NULL 0x06 OBJECT IDENTIFIER 0x0C UTF8String 0x10 (0x30*) SEQUENCE and SEQUENCE OF 0x11 (0x31*) SET and SET OF * The two tags marked with a * are always encoded as 0x30 or 0x31, because bit 6 is used to indicate whether a field is Constructed vs Primitive. These tags are always Constructed, so their encoding has bit 6 set to 1.\nHere is the complete list of Identifier octets for tags used in DER Part 3 - Steps to dissect a private key generated by openssl Lets use a sample 2048 bit PKCS #8 RSA private key as an example.\n$ cat /tmp/id_rsa_2048_pkcs8.pem -----BEGIN PRIVATE KEY----- MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDelT9ocLmSYOiW ... /bMIZw/LIEnLGWi7aCbR4VU= -----END PRIVATE KEY----- Remove the delimiters (encapsulation boundaries) used to demarcate the beginning and end of encoded data block in PEM format (applicable to both public and private keys) Delete the first and last line using sed tool $ sed '1d;$d' /tmp/id_rsa_2048_pkcs8.pem MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDelT9ocLmSYOiW ... /bMIZw/LIEnLGWi7aCbR4VU= Decode the base64 encoded text using base64 tool and save the output in a file (contents will be binary) $ sed '1d;$d' /tmp/id_rsa_2048_pkcs8.pem | base64 -d \u003e /tmp/id_rsa_2048_pkcs8.decoded $ file /tmp/id_rsa_2048_pkcs8.decoded /tmp/id_rsa_2048_pkcs8.decoded: data Display the contents of file in hex using hexdump or xxd $ cat /tmp/id_rsa_2048_pkcs8.decoded | hexdump -e '30/1 \"%.2x \" \"\\n\"' 30 82 04 bd 02 01 00 30 0d 06 09 2a 86 48 86 f7 0d 01 01 01 05 00 04 82 04 a7 30 82 04 a3 02 01 00 02 82 01 01 00 de 95 3f 68 70 b9 92 60 e8 96 e4 bc 72 16 15 54 20 5a 1e df 42 24 1f ba 6f a1 52 97 ab 1b fb a2 78 4b e3 1a a3 ba 0c d1 27 4f bd 89 45 fa 54 fc 46 ab 02 bc ... ae de 5e f2 5a 64 3c 58 33 c6 2a 83 bf da d4 d8 f2 64 e4 62 87 87 34 f8 26 2c 33 1d ac d4 fd b3 08 67 0f cb 20 49 cb 19 68 bb 68 26 d1 e1 55 The sequence of bytes in hex are now ready to be analyzed Part 4 - Examining a PKCS #8 RSA private key in PEM format .Unwrap a PKCS #8 RSA private key to display the contents in hex $ grep \"BEGIN\\|END\" /tmp/id_rsa_2048_pkcs8.pem -----BEGIN PRIVATE KEY----- -----END PRIVATE KEY----- $ sed '1d;$d' /tmp/id_rsa_2048_pkcs8.pem | base64 -d | hexdump -ve '30/1 \"%.2x \" \"\\n\"' 30 82 04 bd 02 01 00 30 0d 06 09 2a 86 48 86 f7 0d 01 01 01 05 00 04 82 04 a7 30 82 04 a3 02 01 00 02 82 01 01 00 de 95 3f 68 70 b9 92 60 e8 96 e4 bc 72 16 15 54 20 5a 1e df 42 24 1f ba 6f a1 52 97 ab 1b fb a2 78 4b e3 1a a3 ba 0c d1 27 4f bd 89 45 fa 54 fc 46 ab 02 bc 24 97 32 5f ae c1 62 41 e4 92 d5 77 60 6a 91 a9 6f 82 57 83 3a 84 1b 9d d1 10 5c 35 a6 1b 5c 94 cd 2c 2c 56 b5 cd 16 9e 86 fd 16 88 b2 eb a0 42 c8 76 bf 25 39 5a 71 ec e0 71 23 fa ab 96 21 e0 97 85 dd eb 62 5a 67 6f 4a d6 2e 0d a0 50 ca d7 01 0f 16 d0 31 1b f9 9e 0b 7b 40 4e 5c 2a b5 ad 23 36 fa ac 8b d4 9f 6e 80 a9 5e 73 6e 16 cf 9d 41 16 b7 79 8e 62 5d b5 54 42 36 5b 47 06 02 cc ab 43 29 d7 9b 4a 88 02 b4 bd 1f 41 57 d5 a8 cd 50 e1 59 2c 10 64 09 93 86 38 69 5c ff 68 81 63 4b e1 42 72 ac 28 a8 98 4d a3 83 d9 90 be fd 12 f9 6b d3 38 11 e8 fe ab 79 33 fc 77 cb 83 e1 a1 04 e6 a1 b8 f8 fa 41 cd 64 95 e8 d7 02 03 01 00 01 02 82 01 00 07 99 4f 9a 43 ca 22 14 31 49 67 19 50 af c7 eb 07 22 1f b4 e4 bc 91 c7 ee 3d b3 17 f2 10 85 e6 ec a8 d8 fb 68 0b 23 ce 14 2a 18 f4 38 31 93 77 fb c8 d8 05 a8 b7 bc b7 eb ee d0 36 24 14 f4 d2 b4 b5 c1 e2 e7 8d de 36 94 1a a4 7f 85 65 10 97 3b 7d ea 71 d4 74 f2 35 c4 6c 58 9d f1 49 6f dc e8 10 6e 12 06 67 32 9f c8 82 13 5e 03 7f 92 ee ad af c2 a5 85 a6 c3 b9 60 7f 36 d1 fd 41 df 0a 90 22 a0 ed 24 ce 98 3e 88 2b 6a ba 2d 46 d0 c2 82 03 44 83 26 47 8a 95 54 fe 6f e7 13 fd a5 34 dd 3e e3 f9 84 d0 40 81 42 19 c8 7f 83 7b 63 5e 6f 1b 86 31 f2 df ad 06 61 b6 6a c6 fa b2 dd 39 87 a3 fe 97 7b c9 86 59 52 f2 b5 3a e9 52 77 94 ed 95 b3 a8 ed 99 5e bb 03 4d dc 0a bb 1f c5 63 d1 0f ea 0b bb cc 98 cc fc 9b 66 87 f9 df 0d 0b b4 f7 5e fa 73 93 ba 30 f5 15 ac db ca d0 41 f1 02 81 81 00 f9 67 95 e8 54 e5 42 21 27 ca 87 aa ac 4a e3 92 f8 49 72 79 86 f3 5d 71 a6 28 9c d0 4b 73 b1 fa a0 87 83 cf 9a 17 6b 21 6c c2 66 7a 35 3b 37 5b 18 d9 1c 40 56 2a 31 94 63 b6 93 f9 ac 38 30 93 3d 5d c0 dd 63 81 0f 9e bc 7f a7 41 8f 50 90 a2 9c 9a 87 11 a5 82 b0 c4 c6 74 01 7e 02 21 5d f7 70 53 1e f8 f0 9f 64 01 61 b9 9e 4f 27 bc b5 44 fd c4 66 e4 66 e2 79 55 e6 4a dd 4e bb 0a ae 4f 02 81 81 00 e4 78 15 e7 b9 36 d2 a7 cd b6 42 77 bb 11 5f 9f c5 cd 56 e1 2f 2a c7 36 98 fd fd d2 76 aa 73 17 03 d2 7a f7 30 07 39 ae 72 b2 74 b6 cf 55 aa 19 80 ff 0d 82 c2 57 6e 55 fd 27 ee 91 05 be d0 61 fc 16 65 14 4a b7 c1 92 4e 25 08 74 22 a3 8c bb 59 d4 ad 78 d7 c9 77 86 71 1a db 87 c6 44 8e 0d 24 5d 81 d4 41 bd be 3b a1 55 c2 6b 83 41 fd d0 b3 2b cb 5a 7f 3d 76 51 b7 ec b4 59 e7 1e 42 f9 02 81 80 72 a7 5c 12 e2 74 42 62 5b 98 8f a5 b6 6e f7 0f a9 74 9a 5b a3 de 5d 26 d1 eb f9 ab 08 04 b7 dd 2f cf 1c 99 63 8d 40 82 ad 2c f1 4f 5d 09 4b f9 65 02 ea 29 e9 72 9c 38 4b 5e b3 c8 23 93 f1 40 bf 05 4a 94 7c 19 e8 c4 60 83 8e b0 64 e1 f4 9b cc c2 7d 35 6f 91 15 12 60 e9 13 86 8a 14 2c ce 83 a4 b2 a8 5e 75 e7 d3 7a c9 8a 2d 79 67 17 2e 10 3b 29 d1 f6 3a 46 ed 66 61 24 3b fd 60 7b a1 02 81 81 00 b1 b5 36 54 a7 9c 1c fe a8 e3 bb 8f a5 d2 3d ae e9 0c 6f 27 78 a8 ad 8b aa 34 e5 d9 6e b3 e6 11 60 c7 b7 1d ce 1d d0 a0 00 57 0e b1 a3 53 de 9b 37 db 2b 87 29 e3 17 cf 8a ba 24 b6 68 e1 a2 f4 94 40 57 1f 11 7f 1c f1 d0 16 be 1c 97 54 df 82 5a bd 32 b1 6c 27 28 f1 49 c8 ba 39 41 de d1 1f 27 ca 13 d2 25 d0 90 c7 91 16 43 c3 9c b5 17 d7 dd 85 93 07 31 31 7d 76 d2 b9 2b 0f 42 d6 27 01 02 81 80 47 d8 24 2a 1f 5f 12 68 83 5e 39 f5 42 f9 fb f9 5b 56 a7 bf bf d0 89 32 33 fc 59 bd fe df 0d 55 a4 28 7c 63 a5 7c 19 be fb fc 01 ea 93 1b 9b 8d da eb c9 34 17 79 6b fd c1 75 02 b7 f0 e5 72 57 88 d6 c0 d3 08 24 11 cc a4 2b a8 9c 64 fa 26 b7 e3 ae de 5e f2 5a 64 3c 58 33 c6 2a 83 bf da d4 d8 f2 64 e4 62 87 87 34 f8 26 2c 33 1d ac d4 fd b3 08 67 0f cb 20 49 cb 19 68 bb 68 26 d1 e1 55 . Here is the list of Identifier octets for tags used in DER 30 82 04 bd 0x30 is the tag value for a SEQUENCE. PrivateKeyInfo is a SEQUENCE 0x82 is the length. However, since the high bit (bit 7) is set (0x1000 0010), it indicates that the length can be found in the next 7 bits (2). Next 2 bytes indicate the length of SEQUENCE as 0x04bd (1213 bytes) The bytes following 0x04bd are the contents of SEQUENCE 02 01 00 0x02 is the tag value of an INTEGER 0x01 (1 byte) is the length of this integer 1 byte following 0x01 is 0x00 and that’s the version (0) 30 0d 0x30 is the tag value for a SEQUENCE. AlgorithmIdentifier is a SEQUENCE 0x0d is the length. Since the high bit (bit 7) is not set (0x0000 1101), it indicates that the length is 0x0d (13 bytes) The 13 bytes following 0x0d are the contents of SEQUENCE (AlgorithmIdentifier) 06 09 0x06 is the tag value for an OBJECT IDENTIFIER. algorithm is an OBJECT IDENTIFIER type primitive 0x09 is the length. Since the high bit (bit 7) is not set (0x0000 1001), it indicates that the length is 0x09 (9 bytes) The 9 bytes following 0x09 are the contents of OBJECT IDENTIFIER (algorithm) 2a 86 48 86 f7 0d 01 01 01 Object identifier for RSA private key is 1.2.840.113549.1.1.1 The first two components are processed in a special way in DER encoding. If x.y are the first two components, they are encoded as 40x + y in hex. So, in our case, 1.2 would be encoded as 42 = 40x1 + 2 which is 0x2A in hex. Subsequent bytes are represented using Variable Length Quantity (VLQ), also called base 128. Encoding 840 840 cannot be represented using short form (single byte) since the value is greater than 127 Represent the value in binary notation: 0b 0000 0011 0100 1000 Break it up in groups of 7 bits starting from the lowest significant bit (0b 0000110 1001000). This is equivalent to representing the number in base 128. Take the lowest 7 bits, and that gives you the least significant byte (0100 1000). This byte comes last. Add a 0 bit as highest bit for last octet since the last octet should indicate the end of value For all the other groups of 7 bits, set the MSb to 1. These added bits denote whether there is another byte to follow or not. Thus, by definition, the very last byte of a variable-length integer will have 0 as its MSb. By this definition our encoding will look like 0b 1000 0110 0100 1000 which can be represented in hex as 86 48 Encoding 113549 Represent the value in binary notation: 0b 0001 1011 1011 1000 1101 Break it up in groups of 7 bits starting from the lowest significant bit (0b 0000110 1110111 0001101) Take the lowest 7 bits, and that gives you the least significant byte (0b0000 1101) represented in hex as 0x0D For all the other groups of 7 bits, set the MSb to 1. Our encoding will now look like 0b 1000 0110 1111 0111 which can be represented in hex as 0x86f7 Combining them, we get 113549 represented as 86 f7 0d Encoding 1.1.1 These components can be encoded in short-form (1 byte) and hence they are encoded as 01 01 01 05 00 0x05 is the tag value for a NULL. parameters is NULL 0x00 indicates 0 length for parameters So, there are no parameters 04 82 04 a7 0x04 is the tag value of a OCTET STRING. The algorithm identifier dictates the format of PrivateKey. So, for this RSA example, the DER encoded RSAPrivateKey is the value of the OCTET STRING. 0x82 is the length. However, since the high bit (bit 7) is set (0x1000 0010), it indicates that the length can be found in the next 7 bits (2). Next 2 bytes indicate the length of OCTET STRING to be 0x04a7 (1191 bytes) The bytes following 0x04a7 are the contents of OCTET STRING (SEQUENCE of RSAPrivateKey) 30 82 04 a3 0x30 is the tag value for a SEQUENCE. RSAPrivateKey is a SEQUENCE 0x82 is the length. However, since the high bit (bit 7) is set (0x1000 0010), it indicates that the length can be found in the next 7 bits (2). Next 2 bytes indicate the length of SEQUENCE as 0x04a3 (1187 bytes) The bytes following 0x04a3 are the contents of SEQUENCE 02 01 00 0x02 is the tag value of an INTEGER 0x01 (1 byte) is the length of this integer 1 byte following 0x01 is 0x00 and that’s the version (0) 02 82 01 01 0x02 is the tag value of an INTEGER. modulus is an INTEGER 0x82 is the length. Since the high bit (bit 7) is set (0x1000 0010), it indicates that the length can be found in the next 7 bits (next 2 bytes). So, 0x0101 (257 bytes) is the length of INTEGER 256 bytes are used for 2048 bit modulus and 1 byte is used as a sign byte (0 indicates positive integer) 257 bytes following 0x0101 represent the public modulus 00 de 95 3f 68 70 b9 92 60 e8 96 e4 bc 72 16 15 54 20 5a 1e df 42 24 1f ba 6f a1 52 97 ab 1b fb a2 78 4b e3 1a a3 ba 0c d1 27 4f bd 89 45 fa 54 fc 46 ab 02 bc 24 97 32 5f ae c1 62 41 e4 92 d5 77 60 6a 91 a9 6f 82 57 83 3a 84 1b 9d d1 10 5c 35 a6 1b 5c 94 cd 2c 2c 56 b5 cd 16 9e 86 fd 16 88 b2 eb a0 42 c8 76 bf 25 39 5a 71 ec e0 71 23 fa ab 96 21 e0 97 85 dd eb 62 5a 67 6f 4a d6 2e 0d a0 50 ca d7 01 0f 16 d0 31 1b f9 9e 0b 7b 40 4e 5c 2a b5 ad 23 36 fa ac 8b d4 9f 6e 80 a9 5e 73 6e 16 cf 9d 41 16 b7 79 8e 62 5d b5 54 42 36 5b 47 06 02 cc ab 43 29 d7 9b 4a 88 02 b4 bd 1f 41 57 d5 a8 cd 50 e1 59 2c 10 64 09 93 86 38 69 5c ff 68 81 63 4b e1 42 72 ac 28 a8 98 4d a3 83 d9 90 be fd 12 f9 6b d3 38 11 e8 fe ab 79 33 fc 77 cb 83 e1 a1 04 e6 a1 b8 f8 fa 41 cd 64 95 e8 d7 Value of public modulus represented in 257 bytes 02 03 0x02 is the tag value of an INTEGER. publicexponent is an INTEGER 0x03 (3 bytes) is the length of this integer 3 bytes following 0x03 represent the public exponent 01 00 01 Value of public exponent (65537) 02 82 01 00 0x02 is the tag value of an INTEGER. privateExponent is an INTEGER 0x82 is the length. Since the high bit (bit 7) is set (0x1000 0010), it indicates that the length can be found in the next 7 bits (next 2 bytes). So, 0x0100 (256 bytes) is the length of privateExponent 256 bytes following 0x0100 represent the private exponent 07 99 4f 9a 43 ca 22 14 31 49 67 19 50 af c7 eb 07 22 1f b4 e4 bc 91 c7 ee 3d b3 17 f2 10 85 e6 ec a8 d8 fb 68 0b 23 ce 14 2a 18 f4 38 31 93 77 fb c8 d8 05 a8 b7 bc b7 eb ee d0 36 24 14 f4 d2 b4 b5 c1 e2 e7 8d de 36 94 1a a4 7f 85 65 10 97 3b 7d ea 71 d4 74 f2 35 c4 6c 58 9d f1 49 6f dc e8 10 6e 12 06 67 32 9f c8 82 13 5e 03 7f 92 ee ad af c2 a5 85 a6 c3 b9 60 7f 36 d1 fd 41 df 0a 90 22 a0 ed 24 ce 98 3e 88 2b 6a ba 2d 46 d0 c2 82 03 44 83 26 47 8a 95 54 fe 6f e7 13 fd a5 34 dd 3e e3 f9 84 d0 40 81 42 19 c8 7f 83 7b 63 5e 6f 1b 86 31 f2 df ad 06 61 b6 6a c6 fa b2 dd 39 87 a3 fe 97 7b c9 86 59 52 f2 b5 3a e9 52 77 94 ed 95 b3 a8 ed 99 5e bb 03 4d dc 0a bb 1f c5 63 d1 0f ea 0b bb cc 98 cc fc 9b 66 87 f9 df 0d 0b b4 f7 5e fa 73 93 ba 30 f5 15 ac db ca d0 41 f1 Value of private exponent represented in 256 bytes 02 81 81 0x02 is the tag value of an INTEGER (prime1) 0x81 is the length. However, since the high bit (bit 7) is set (0x1000 0001), it indicates that the length can be found in the next 7 bits (next 1 byte). So, 0x81 (129 bytes) is the length of INTEGER (prime1) 129 bytes following 0x81 represent the prime1 00 f9 67 95 e8 54 e5 42 21 27 ca 87 aa ac 4a e3 92 f8 49 72 79 86 f3 5d 71 a6 28 9c d0 4b 73 b1 fa a0 87 83 cf 9a 17 6b 21 6c c2 66 7a 35 3b 37 5b 18 d9 1c 40 56 2a 31 94 63 b6 93 f9 ac 38 30 93 3d 5d c0 dd 63 81 0f 9e bc 7f a7 41 8f 50 90 a2 9c 9a 87 11 a5 82 b0 c4 c6 74 01 7e 02 21 5d f7 70 53 1e f8 f0 9f 64 01 61 b9 9e 4f 27 bc b5 44 fd c4 66 e4 66 e2 79 55 e6 4a dd 4e bb 0a ae 4f Value of prime1 represented in 129 bytes 02 81 81 0x02 is the tag value of an INTEGER (prime2) 0x81 is the length. However, since the high bit (bit 7) is set (0x1000 0001), it indicates that the length can be found in the next 7 bits (next 1 byte). So, 0x81 (129 bytes) is the length of INTEGER (prime2) 129 bytes following 0x81 represent the prime2 00 e4 78 15 e7 b9 36 d2 a7 cd b6 42 77 bb 11 5f 9f c5 cd 56 e1 2f 2a c7 36 98 fd fd d2 76 aa 73 17 03 d2 7a f7 30 07 39 ae 72 b2 74 b6 cf 55 aa 19 80 ff 0d 82 c2 57 6e 55 fd 27 ee 91 05 be d0 61 fc 16 65 14 4a b7 c1 92 4e 25 08 74 22 a3 8c bb 59 d4 ad 78 d7 c9 77 86 71 1a db 87 c6 44 8e 0d 24 5d 81 d4 41 bd be 3b a1 55 c2 6b 83 41 fd d0 b3 2b cb 5a 7f 3d 76 51 b7 ec b4 59 e7 1e 42 f9 Value of prime2 represented in 129 bytes 02 81 80 0x02 is the tag value of an INTEGER (exponent1) 0x81 is the length. However, since the high bit (bit 7) is set (0x1000 0001), it indicates that the length can be found in the next 7 bits (next 1 byte). So, 0x80 (128 bytes) is the length of INTEGER (exponent1) 128 bytes following 0x80 represent exponent1 72 a7 5c 12 e2 74 42 62 5b 98 8f a5 b6 6e f7 0f a9 74 9a 5b a3 de 5d 26 d1 eb f9 ab 08 04 b7 dd 2f cf 1c 99 63 8d 40 82 ad 2c f1 4f 5d 09 4b f9 65 02 ea 29 e9 72 9c 38 4b 5e b3 c8 23 93 f1 40 bf 05 4a 94 7c 19 e8 c4 60 83 8e b0 64 e1 f4 9b cc c2 7d 35 6f 91 15 12 60 e9 13 86 8a 14 2c ce 83 a4 b2 a8 5e 75 e7 d3 7a c9 8a 2d 79 67 17 2e 10 3b 29 d1 f6 3a 46 ed 66 61 24 3b fd 60 7b a1 Value of exponent1 represented in 128 bytes 02 81 81 0x02 is the tag value of an INTEGER (exponent2) 0x81 is the length. However, since the high bit (bit 7) is set (0x1000 0001), it indicates that the length can be found in the next 7 bits (next 1 byte). So, 0x81 (129 bytes) is the length of INTEGER (exponent2) 129 bytes following 0x81 represent the exponent2 00 b1 b5 36 54 a7 9c 1c fe a8 e3 bb 8f a5 d2 3d ae e9 0c 6f 27 78 a8 ad 8b aa 34 e5 d9 6e b3 e6 11 60 c7 b7 1d ce 1d d0 a0 00 57 0e b1 a3 53 de 9b 37 db 2b 87 29 e3 17 cf 8a ba 24 b6 68 e1 a2 f4 94 40 57 1f 11 7f 1c f1 d0 16 be 1c 97 54 df 82 5a bd 32 b1 6c 27 28 f1 49 c8 ba 39 41 de d1 1f 27 ca 13 d2 25 d0 90 c7 91 16 43 c3 9c b5 17 d7 dd 85 93 07 31 31 7d 76 d2 b9 2b 0f 42 d6 27 01 Value of exponent2 represented in 129 bytes 02 81 80 0x02 is the tag value of an INTEGER (coefficient) 0x81 is the length. However, since the high bit (bit 7) is set (0x1000 0001), it indicates that the length can be found in the next 7 bits (next 1 byte). So, 0x80 (128 bytes) is the length of INTEGER (coefficient) 128 bytes following 0x80 represent coefficient 47 d8 24 2a 1f 5f 12 68 83 5e 39 f5 42 f9 fb f9 5b 56 a7 bf bf d0 89 32 33 fc 59 bd fe df 0d 55 a4 28 7c 63 a5 7c 19 be fb fc 01 ea 93 1b 9b 8d da eb c9 34 17 79 6b fd c1 75 02 b7 f0 e5 72 57 88 d6 c0 d3 08 24 11 cc a4 2b a8 9c 64 fa 26 b7 e3 ae de 5e f2 5a 64 3c 58 33 c6 2a 83 bf da d4 d8 f2 64 e4 62 87 87 34 f8 26 2c 33 1d ac d4 fd b3 08 67 0f cb 20 49 cb 19 68 bb 68 26 d1 e1 55 Value of coefficient represented in 128 bytes Values of RSA private key can be verified using openssl rsa command $ openssl rsa -in /tmp/id_rsa_2048_pkcs8.pem -noout -text Private-Key: (2048 bit, 2 primes) modulus: 00:de:95:3f:68:70:b9:92:60:e8:96:e4:bc:72:16: ... e8:d7 publicExponent: 65537 (0x10001) privateExponent: 07:99:4f:9a:43:ca:22:14:31:49:67:19:50:af:c7: ...41:f1 prime1: 00:f9:67:95:e8:54:e5:42:21:27:ca:87:aa:ac:4a: ... 55:e6:4a:dd:4e:bb:0a:ae:4f prime2: 00:e4:78:15:e7:b9:36:d2:a7:cd:b6:42:77:bb:11: ... 51:b7:ec:b4:59:e7:1e:42:f9 exponent1: 72:a7:5c:12:e2:74:42:62:5b:98:8f:a5:b6:6e:f7: ... 66:61:24:3b:fd:60:7b:a1 exponent2: 00:b1:b5:36:54:a7:9c:1c:fe:a8:e3:bb:8f:a5:d2: ... 76:d2:b9:2b:0f:42:d6:27:01 coefficient: 47:d8:24:2a:1f:5f:12:68:83:5e:39:f5:42:f9:fb: ... 19:68:bb:68:26:d1:e1:55 References RFC 5208 - Private-Key Information Syntax OpenSSL 1.0.2 - openssl-genrsa OpenSSL 1.0.2 - openssl-asn1parse OpenSSL 1.0.2 - openssl-pkcs8 Wiki: PKCS #8 Wiki: ASN.1 Wiki: Length octets encoding forms Wiki: Identifier octets ASN.1 Javascript decoder tool Explained: Variable length quantity ","wordCount":"4660","inLanguage":"en","image":"https://partbypart.github.io/posts/deep-dive-pkcs8-rsa-private-key/images/pkcs8-private.png","datePublished":"2023-08-26T00:00:00Z","dateModified":"2023-08-26T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://partbypart.github.io/posts/deep-dive-pkcs8-rsa-private-key/"},"publisher":{"@type":"Organization","name":"Learn part by part","logo":{"@type":"ImageObject","url":"https://partbypart.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://partbypart.github.io/ accesskey=h title="PartByPart (Alt + H)"><img src=https://partbypart.github.io/apple-touch-icon.png alt aria-label=logo height=35>PartByPart</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://partbypart.github.io/categories/ title=CATEGORIES><span>CATEGORIES</span></a></li><li><a href=https://partbypart.github.io/tags/ title=TAGS><span>TAGS</span></a></li><li><a href=https://partbypart.github.io/archives/ title=ARCHIVES><span>ARCHIVES</span></a></li><li><a href=https://partbypart.github.io/search/ title="SEARCH (Alt + /)" accesskey=/><span>SEARCH</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://partbypart.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://partbypart.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Deep dive - Anatomy of a PKCS#8 RSA private key</h1><div class=post-description>Dissect and explore a PKCS#8 RSA private key in PEM format</div><div class=post-meta><span title='2023-08-26 00:00:00 +0000 UTC'>August 26, 2023</span>&nbsp;·&nbsp;22 min&nbsp;·&nbsp;4660 words</div></header><figure class=entry-cover><img loading=eager src=https://partbypart.github.io/images/pkcs8-private.png alt="Private key picture"><figcaption>Outlie icons created by pikepicture - Flaticon (<a href=https://www.flaticon.com/free-icons/outlie>https://www.flaticon.com/free-icons/outlie</a>)</figcaption></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#part-1---asn1-syntax-to-store-rsa-private-key-in-pkcs8-format>Part 1 - ASN.1 syntax to store RSA private key in PKCS#8 format</a></li><li><a href=#part-2---commonly-used-tag-values>Part 2 - Commonly used tag values</a></li><li><a href=#dissect-a-key>Part 3 - Steps to dissect a private key generated by openssl</a></li><li><a href=#part-4---examining-a-pkcs-8-rsa-private-key-in-pem-format>Part 4 - Examining a PKCS #8 RSA private key in PEM format</a></li><li><a href=#references>References</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h3 id=prerequisites>Prerequisites<a hidden class=anchor aria-hidden=true href=#prerequisites>#</a></h3><ul><li>Linux/MacOS</li><li><code>openssl</code> command line tool (version 1.0.2 or higher)</li><li><a href=https://partbypart.github.io/posts/rsa-key-components/>RSA key components</a></li><li><a href=https://partbypart.github.io/posts/demystifying-asn1-der-pem-pkcs1-pkcs8/>101 - ASN.1, DER, PEM, PKCS#1, PKCS#8</a></li><li><a href=https://partbypart.github.io/posts/quick-bytes-der-basics/>Quick bytes - Basics of Distinguished Encoding Rules</a></li></ul><h3 id=part-1---asn1-syntax-to-store-rsa-private-key-in-pkcs8-format>Part 1 - ASN.1 syntax to store RSA private key in PKCS#8 format<a hidden class=anchor aria-hidden=true href=#part-1---asn1-syntax-to-store-rsa-private-key-in-pkcs8-format>#</a></h3><ul><li>RSA Private key <a href=https://www.rfc-editor.org/rfc/rfc5208#appendix-A>syntax</a>. (Additional reference: AlgorithmIdentifier <a href=https://www.rfc-editor.org/rfc/rfc8410>syntax</a>)<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PrivateKeyInfo ::<span class=o>=</span> SEQUENCE <span class=o>{</span>
</span></span><span class=line><span class=cl>	version Version,
</span></span><span class=line><span class=cl>	privateKeyAlgorithm AlgorithmIdentifier <span class=o>{{</span>PrivateKeyAlgorithms<span class=o>}}</span>,
</span></span><span class=line><span class=cl>	privateKey PrivateKey,            -- <span class=s2>&#34;RSAPrivateKey&#34;</span> <span class=k>for</span> an RSA private key
</span></span><span class=line><span class=cl>	attributes <span class=o>[</span>0<span class=o>]</span> Attributes OPTIONAL 
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Version ::<span class=o>=</span> INTEGER <span class=o>{</span>v1<span class=o>(</span>0<span class=o>)}</span> <span class=o>(</span>v1,...<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PrivateKeyAlgorithmIdentifier ::<span class=o>=</span> AlgorithmIdentifier
</span></span><span class=line><span class=cl>AlgorithmIdentifier  ::<span class=o>=</span>  SEQUENCE  <span class=o>{</span>
</span></span><span class=line><span class=cl>    algorithm               OBJECT IDENTIFIER,
</span></span><span class=line><span class=cl>    parameters              ANY DEFINED BY algorithm OPTIONAL  
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>PrivateKey ::<span class=o>=</span> OCTET STRING     -- <span class=s2>&#34;RSAPrivateKey&#34;</span> <span class=k>for</span> an RSA private key
</span></span><span class=line><span class=cl>Attributes ::<span class=o>=</span> SET OF Attributes
</span></span></code></pre></div></li><li>For an RSA private key, the contents of <code>PrivateKey</code> are a BER encoding of a value of type <code>RSAPrivateKey</code> (<a href=https://www.rfc-editor.org/rfc/rfc5208#section-5>Reference</a>). Here&rsquo;s the ASN.1 syntax for <code>RSAPrivateKey</code> as specified by <a href=https://datatracker.ietf.org/doc/html/rfc8017#appendix-A.1.2>RFC8017</a><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>RSAPrivateKey ::<span class=o>=</span> SEQUENCE <span class=o>{</span>
</span></span><span class=line><span class=cl>	version           Version,
</span></span><span class=line><span class=cl>	modulus           INTEGER,  -- n
</span></span><span class=line><span class=cl>	publicExponent    INTEGER,  -- e
</span></span><span class=line><span class=cl>	privateExponent   INTEGER,  -- d
</span></span><span class=line><span class=cl>	prime1            INTEGER,  -- p
</span></span><span class=line><span class=cl>	prime2            INTEGER,  -- q
</span></span><span class=line><span class=cl>	exponent1         INTEGER,  -- d mod <span class=o>(</span>p-1<span class=o>)</span>
</span></span><span class=line><span class=cl>	exponent2         INTEGER,  -- d mod <span class=o>(</span>q-1<span class=o>)</span>
</span></span><span class=line><span class=cl>	coefficient       INTEGER,  -- <span class=o>(</span>inverse of q<span class=o>)</span> mod p
</span></span><span class=line><span class=cl>	otherPrimeInfos   OtherPrimeInfos OPTIONAL
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div></li><li><code>openssl genrsa</code> and <code>openssl genpkey</code> command in OpenSSL 3 (or higher) generate RSA private key in PKCS #8 format by default.</li><li><code>openssl genrsa</code> in OpenSSL 1.0.2 generates RSA private key in PKCS#1 format by default.</li><li><code>openssl pkcs8</code> can be used in OpenSSL 1.0.2 to convert RSA private key in PKCS#1 to PKCS#8 format</li><li>Verify PKCS #8 RSA private key syntax<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl version -v
</span></span><span class=line><span class=cl>OpenSSL 1.0.2s  <span class=m>28</span> May <span class=m>2019</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create a sample 2048 bit RSA private key (PKCS #1 by default)</span>
</span></span><span class=line><span class=cl>$ openssl genrsa -out /tmp/id_rsa_2048_pkcs1.pem <span class=m>2048</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ grep <span class=s2>&#34;BEGIN\|END&#34;</span> /tmp/id_rsa_2048_pkcs1.pem
</span></span><span class=line><span class=cl>-----BEGIN RSA PRIVATE KEY-----
</span></span><span class=line><span class=cl>-----END RSA PRIVATE KEY-----
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read a traditional format private key and write a PKCS#8 format key</span>
</span></span><span class=line><span class=cl>$ openssl pkcs8 -topk8 -in /tmp/id_rsa_2048_pkcs1.pem -nocrypt -out /tmp/id_rsa_2048_pkcs8.pem
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ grep <span class=s2>&#34;BEGIN\|END&#34;</span> /tmp/id_rsa_2048_pkcs8.pem
</span></span><span class=line><span class=cl>-----BEGIN PRIVATE KEY-----
</span></span><span class=line><span class=cl>-----END PRIVATE KEY-----
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ openssl asn1parse -in /tmp/id_rsa_2048_pkcs8.pem -i
</span></span><span class=line><span class=cl>    0:d<span class=o>=</span><span class=m>0</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span><span class=m>1213</span> cons: SEQUENCE
</span></span><span class=line><span class=cl>    4:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>1</span> prim:  INTEGER           :00
</span></span><span class=line><span class=cl>    7:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>  <span class=m>13</span> cons:  SEQUENCE
</span></span><span class=line><span class=cl>    9:d<span class=o>=</span><span class=m>2</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>9</span> prim:   OBJECT            :rsaEncryption
</span></span><span class=line><span class=cl>   20:d<span class=o>=</span><span class=m>2</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>0</span> prim:   NULL
</span></span><span class=line><span class=cl>   22:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span><span class=m>1191</span> prim:  OCTET STRING      <span class=o>[</span>HEX DUMP<span class=o>]</span>:3082...E155
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Drill into the OCTET STRING at offset 22</span>
</span></span><span class=line><span class=cl>$ openssl asn1parse -in /tmp/id_rsa_2048_pkcs8.pem -i -strparse <span class=m>22</span>
</span></span><span class=line><span class=cl>    0:d<span class=o>=</span><span class=m>0</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span><span class=m>1187</span> cons: SEQUENCE
</span></span><span class=line><span class=cl>    4:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>1</span> prim:  INTEGER           :00
</span></span><span class=line><span class=cl>    7:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span> <span class=m>257</span> prim:  INTEGER           :DE95...E8D7
</span></span><span class=line><span class=cl>  268:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>3</span> prim:  INTEGER           :010001
</span></span><span class=line><span class=cl>  273:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span> <span class=m>256</span> prim:  INTEGER           :0799...41F1
</span></span><span class=line><span class=cl>  533:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>3</span> <span class=nv>l</span><span class=o>=</span> <span class=m>129</span> prim:  INTEGER           :F967...AE4F
</span></span><span class=line><span class=cl>  665:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>3</span> <span class=nv>l</span><span class=o>=</span> <span class=m>129</span> prim:  INTEGER           :E478...42F9
</span></span><span class=line><span class=cl>  797:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>3</span> <span class=nv>l</span><span class=o>=</span> <span class=m>128</span> prim:  INTEGER           :72A7...7BA1
</span></span><span class=line><span class=cl>  928:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>3</span> <span class=nv>l</span><span class=o>=</span> <span class=m>129</span> prim:  INTEGER           :B1B5...2701
</span></span><span class=line><span class=cl> 1060:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>3</span> <span class=nv>l</span><span class=o>=</span> <span class=m>128</span> prim:  INTEGER           :47D8...E155
</span></span></code></pre></div></li></ul><h3 id=part-2---commonly-used-tag-values>Part 2 - Commonly used tag values<a hidden class=anchor aria-hidden=true href=#part-2---commonly-used-tag-values>#</a></h3><table><thead><tr><th>Tag (hex)</th><th>Type</th></tr></thead><tbody><tr><td><code>0x02</code></td><td><code>INTEGER</code></td></tr><tr><td><code>0x03</code></td><td><code>BIT STRING</code></td></tr><tr><td><code>0x04</code></td><td><code>OCTET STRING</code></td></tr><tr><td><code>0x05</code></td><td><code>NULL</code></td></tr><tr><td><code>0x06</code></td><td><code>OBJECT IDENTIFIER</code></td></tr><tr><td><code>0x0C</code></td><td><code>UTF8String</code></td></tr><tr><td><code>0x10</code> (<code>0x30</code>*)</td><td><code>SEQUENCE</code> and <code>SEQUENCE OF</code></td></tr><tr><td><code>0x11</code> (<code>0x31</code>*)</td><td><code>SET</code> and <code>SET OF</code></td></tr></tbody></table><p>* The two tags marked with a <code>*</code> are always encoded as 0x30 or 0x31, because bit 6 is used to indicate whether a field is Constructed vs Primitive. These tags are always Constructed, so their encoding has bit 6 set to 1.</p><ul><li><a href=https://en.wikipedia.org/wiki/X.690#Identifier_octets>Here is the complete list of Identifier octets</a> for tags used in DER</li></ul><h3 id=dissect-a-key>Part 3 - Steps to dissect a private key generated by openssl<a hidden class=anchor aria-hidden=true href=#dissect-a-key>#</a></h3><p>Lets use a sample 2048 bit PKCS #8 RSA private key as an example.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat /tmp/id_rsa_2048_pkcs8.pem
</span></span><span class=line><span class=cl>-----BEGIN PRIVATE KEY-----
</span></span><span class=line><span class=cl>MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDelT9ocLmSYOiW
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>/bMIZw/LIEnLGWi7aCbR4VU<span class=o>=</span>
</span></span><span class=line><span class=cl>-----END PRIVATE KEY-----
</span></span></code></pre></div><ol><li>Remove the delimiters (encapsulation boundaries) used to demarcate the beginning and end of encoded data block in PEM format (applicable to both public and private keys)<ul><li>Delete the first and last line using <code>sed</code> tool</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sed <span class=s1>&#39;1d;$d&#39;</span> /tmp/id_rsa_2048_pkcs8.pem
</span></span><span class=line><span class=cl>MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDelT9ocLmSYOiW
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>/bMIZw/LIEnLGWi7aCbR4VU<span class=o>=</span>
</span></span></code></pre></div></li><li>Decode the base64 encoded text using <code>base64</code> tool and save the output in a file (contents will be binary)<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sed <span class=s1>&#39;1d;$d&#39;</span> /tmp/id_rsa_2048_pkcs8.pem <span class=p>|</span> base64 -d &gt; /tmp/id_rsa_2048_pkcs8.decoded
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ file /tmp/id_rsa_2048_pkcs8.decoded
</span></span><span class=line><span class=cl>/tmp/id_rsa_2048_pkcs8.decoded: data
</span></span></code></pre></div></li><li>Display the contents of file in hex using <code>hexdump</code> or <code>xxd</code><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat /tmp/id_rsa_2048_pkcs8.decoded <span class=p>|</span> hexdump -e <span class=s1>&#39;30/1 &#34;%.2x &#34; &#34;\n&#34;&#39;</span>
</span></span><span class=line><span class=cl><span class=m>30</span> <span class=m>82</span> <span class=m>04</span> bd <span class=m>02</span> <span class=m>01</span> <span class=m>00</span> <span class=m>30</span> 0d <span class=m>06</span> <span class=m>09</span> 2a <span class=m>86</span> <span class=m>48</span> <span class=m>86</span> f7 0d <span class=m>01</span> <span class=m>01</span> <span class=m>01</span> <span class=m>05</span> <span class=m>00</span> <span class=m>04</span> <span class=m>82</span> <span class=m>04</span> a7 <span class=m>30</span> <span class=m>82</span> <span class=m>04</span> a3
</span></span><span class=line><span class=cl><span class=m>02</span> <span class=m>01</span> <span class=m>00</span> <span class=m>02</span> <span class=m>82</span> <span class=m>01</span> <span class=m>01</span> <span class=m>00</span> de <span class=m>95</span> 3f <span class=m>68</span> <span class=m>70</span> b9 <span class=m>92</span> <span class=m>60</span> e8 <span class=m>96</span> e4 bc <span class=m>72</span> <span class=m>16</span> <span class=m>15</span> <span class=m>54</span> <span class=m>20</span> 5a 1e df <span class=m>42</span> <span class=m>24</span>
</span></span><span class=line><span class=cl>1f ba 6f a1 <span class=m>52</span> <span class=m>97</span> ab 1b fb a2 <span class=m>78</span> 4b e3 1a a3 ba 0c d1 <span class=m>27</span> 4f bd <span class=m>89</span> <span class=m>45</span> fa <span class=m>54</span> <span class=nb>fc</span> <span class=m>46</span> ab <span class=m>02</span> bc
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>ae de 5e f2 5a <span class=m>64</span> 3c <span class=m>58</span> <span class=m>33</span> c6 2a <span class=m>83</span> bf da d4 d8 f2 <span class=m>64</span> e4 <span class=m>62</span> <span class=m>87</span> <span class=m>87</span> <span class=m>34</span> f8 <span class=m>26</span> 2c <span class=m>33</span> 1d ac d4
</span></span><span class=line><span class=cl>fd b3 <span class=m>08</span> <span class=m>67</span> 0f cb <span class=m>20</span> <span class=m>49</span> cb <span class=m>19</span> <span class=m>68</span> bb <span class=m>68</span> <span class=m>26</span> d1 e1 <span class=m>55</span>
</span></span></code></pre></div></li><li>The sequence of bytes in hex are now ready to be analyzed</li></ol><h3 id=part-4---examining-a-pkcs-8-rsa-private-key-in-pem-format>Part 4 - Examining a PKCS #8 RSA private key in PEM format<a hidden class=anchor aria-hidden=true href=#part-4---examining-a-pkcs-8-rsa-private-key-in-pem-format>#</a></h3><ul><li>.<a href=#dissect-a-key>Unwrap a PKCS #8 RSA private key to display the contents in hex</a><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ grep <span class=s2>&#34;BEGIN\|END&#34;</span> /tmp/id_rsa_2048_pkcs8.pem
</span></span><span class=line><span class=cl>-----BEGIN PRIVATE KEY-----
</span></span><span class=line><span class=cl>-----END PRIVATE KEY-----
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ sed <span class=s1>&#39;1d;$d&#39;</span> /tmp/id_rsa_2048_pkcs8.pem <span class=p>|</span> base64 -d <span class=p>|</span> hexdump -ve <span class=s1>&#39;30/1 &#34;%.2x &#34; &#34;\n&#34;&#39;</span>
</span></span><span class=line><span class=cl><span class=m>30</span> <span class=m>82</span> <span class=m>04</span> bd <span class=m>02</span> <span class=m>01</span> <span class=m>00</span> <span class=m>30</span> 0d <span class=m>06</span> <span class=m>09</span> 2a <span class=m>86</span> <span class=m>48</span> <span class=m>86</span> f7 0d <span class=m>01</span> <span class=m>01</span> <span class=m>01</span> <span class=m>05</span> <span class=m>00</span> <span class=m>04</span> <span class=m>82</span> <span class=m>04</span> a7 <span class=m>30</span> <span class=m>82</span> <span class=m>04</span> a3
</span></span><span class=line><span class=cl><span class=m>02</span> <span class=m>01</span> <span class=m>00</span> <span class=m>02</span> <span class=m>82</span> <span class=m>01</span> <span class=m>01</span> <span class=m>00</span> de <span class=m>95</span> 3f <span class=m>68</span> <span class=m>70</span> b9 <span class=m>92</span> <span class=m>60</span> e8 <span class=m>96</span> e4 bc <span class=m>72</span> <span class=m>16</span> <span class=m>15</span> <span class=m>54</span> <span class=m>20</span> 5a 1e df <span class=m>42</span> <span class=m>24</span>
</span></span><span class=line><span class=cl>1f ba 6f a1 <span class=m>52</span> <span class=m>97</span> ab 1b fb a2 <span class=m>78</span> 4b e3 1a a3 ba 0c d1 <span class=m>27</span> 4f bd <span class=m>89</span> <span class=m>45</span> fa <span class=m>54</span> <span class=nb>fc</span> <span class=m>46</span> ab <span class=m>02</span> bc
</span></span><span class=line><span class=cl><span class=m>24</span> <span class=m>97</span> <span class=m>32</span> 5f ae c1 <span class=m>62</span> <span class=m>41</span> e4 <span class=m>92</span> d5 <span class=m>77</span> <span class=m>60</span> 6a <span class=m>91</span> a9 6f <span class=m>82</span> <span class=m>57</span> <span class=m>83</span> 3a <span class=m>84</span> 1b 9d d1 <span class=m>10</span> 5c <span class=m>35</span> a6 1b
</span></span><span class=line><span class=cl>5c <span class=m>94</span> <span class=nb>cd</span> 2c 2c <span class=m>56</span> b5 <span class=nb>cd</span> <span class=m>16</span> 9e <span class=m>86</span> fd <span class=m>16</span> <span class=m>88</span> b2 eb a0 <span class=m>42</span> c8 <span class=m>76</span> bf <span class=m>25</span> <span class=m>39</span> 5a <span class=m>71</span> ec e0 <span class=m>71</span> <span class=m>23</span> fa
</span></span><span class=line><span class=cl>ab <span class=m>96</span> <span class=m>21</span> e0 <span class=m>97</span> <span class=m>85</span> dd eb <span class=m>62</span> 5a <span class=m>67</span> 6f 4a d6 2e 0d a0 <span class=m>50</span> ca d7 <span class=m>01</span> 0f <span class=m>16</span> d0 <span class=m>31</span> 1b f9 9e 0b 7b
</span></span><span class=line><span class=cl><span class=m>40</span> 4e 5c 2a b5 ad <span class=m>23</span> <span class=m>36</span> fa ac 8b d4 9f 6e <span class=m>80</span> a9 5e <span class=m>73</span> 6e <span class=m>16</span> cf 9d <span class=m>41</span> <span class=m>16</span> b7 <span class=m>79</span> 8e <span class=m>62</span> 5d b5
</span></span><span class=line><span class=cl><span class=m>54</span> <span class=m>42</span> <span class=m>36</span> 5b <span class=m>47</span> <span class=m>06</span> <span class=m>02</span> cc ab <span class=m>43</span> <span class=m>29</span> d7 9b 4a <span class=m>88</span> <span class=m>02</span> b4 bd 1f <span class=m>41</span> <span class=m>57</span> d5 a8 <span class=nb>cd</span> <span class=m>50</span> e1 <span class=m>59</span> 2c <span class=m>10</span> <span class=m>64</span>
</span></span><span class=line><span class=cl><span class=m>09</span> <span class=m>93</span> <span class=m>86</span> <span class=m>38</span> <span class=m>69</span> 5c ff <span class=m>68</span> <span class=m>81</span> <span class=m>63</span> 4b e1 <span class=m>42</span> <span class=m>72</span> ac <span class=m>28</span> a8 <span class=m>98</span> 4d a3 <span class=m>83</span> d9 <span class=m>90</span> be fd <span class=m>12</span> f9 6b d3 <span class=m>38</span>
</span></span><span class=line><span class=cl><span class=m>11</span> e8 fe ab <span class=m>79</span> <span class=m>33</span> <span class=nb>fc</span> <span class=m>77</span> cb <span class=m>83</span> e1 a1 <span class=m>04</span> e6 a1 b8 f8 fa <span class=m>41</span> <span class=nb>cd</span> <span class=m>64</span> <span class=m>95</span> e8 d7 <span class=m>02</span> <span class=m>03</span> <span class=m>01</span> <span class=m>00</span> <span class=m>01</span> <span class=m>02</span>
</span></span><span class=line><span class=cl><span class=m>82</span> <span class=m>01</span> <span class=m>00</span> <span class=m>07</span> <span class=m>99</span> 4f 9a <span class=m>43</span> ca <span class=m>22</span> <span class=m>14</span> <span class=m>31</span> <span class=m>49</span> <span class=m>67</span> <span class=m>19</span> <span class=m>50</span> af c7 eb <span class=m>07</span> <span class=m>22</span> 1f b4 e4 bc <span class=m>91</span> c7 ee 3d b3
</span></span><span class=line><span class=cl><span class=m>17</span> f2 <span class=m>10</span> <span class=m>85</span> e6 ec a8 d8 fb <span class=m>68</span> 0b <span class=m>23</span> ce <span class=m>14</span> 2a <span class=m>18</span> f4 <span class=m>38</span> <span class=m>31</span> <span class=m>93</span> <span class=m>77</span> fb c8 d8 <span class=m>05</span> a8 b7 bc b7 eb
</span></span><span class=line><span class=cl>ee d0 <span class=m>36</span> <span class=m>24</span> <span class=m>14</span> f4 d2 b4 b5 c1 e2 e7 8d de <span class=m>36</span> <span class=m>94</span> 1a a4 7f <span class=m>85</span> <span class=m>65</span> <span class=m>10</span> <span class=m>97</span> 3b 7d ea <span class=m>71</span> d4 <span class=m>74</span> f2
</span></span><span class=line><span class=cl><span class=m>35</span> c4 6c <span class=m>58</span> 9d f1 <span class=m>49</span> 6f dc e8 <span class=m>10</span> 6e <span class=m>12</span> <span class=m>06</span> <span class=m>67</span> <span class=m>32</span> 9f c8 <span class=m>82</span> <span class=m>13</span> 5e <span class=m>03</span> 7f <span class=m>92</span> ee ad af c2 a5 <span class=m>85</span>
</span></span><span class=line><span class=cl>a6 c3 b9 <span class=m>60</span> 7f <span class=m>36</span> d1 fd <span class=m>41</span> df 0a <span class=m>90</span> <span class=m>22</span> a0 ed <span class=m>24</span> ce <span class=m>98</span> 3e <span class=m>88</span> 2b 6a ba 2d <span class=m>46</span> d0 c2 <span class=m>82</span> <span class=m>03</span> <span class=m>44</span>
</span></span><span class=line><span class=cl><span class=m>83</span> <span class=m>26</span> <span class=m>47</span> 8a <span class=m>95</span> <span class=m>54</span> fe 6f e7 <span class=m>13</span> fd a5 <span class=m>34</span> dd 3e e3 f9 <span class=m>84</span> d0 <span class=m>40</span> <span class=m>81</span> <span class=m>42</span> <span class=m>19</span> c8 7f <span class=m>83</span> 7b <span class=m>63</span> 5e 6f
</span></span><span class=line><span class=cl>1b <span class=m>86</span> <span class=m>31</span> f2 df ad <span class=m>06</span> <span class=m>61</span> b6 6a c6 fa b2 dd <span class=m>39</span> <span class=m>87</span> a3 fe <span class=m>97</span> 7b c9 <span class=m>86</span> <span class=m>59</span> <span class=m>52</span> f2 b5 3a e9 <span class=m>52</span> <span class=m>77</span>
</span></span><span class=line><span class=cl><span class=m>94</span> ed <span class=m>95</span> b3 a8 ed <span class=m>99</span> 5e bb <span class=m>03</span> 4d dc 0a bb 1f c5 <span class=m>63</span> d1 0f ea 0b bb cc <span class=m>98</span> cc <span class=nb>fc</span> 9b <span class=m>66</span> <span class=m>87</span> f9
</span></span><span class=line><span class=cl>df 0d 0b b4 f7 5e fa <span class=m>73</span> <span class=m>93</span> ba <span class=m>30</span> f5 <span class=m>15</span> ac db ca d0 <span class=m>41</span> f1 <span class=m>02</span> <span class=m>81</span> <span class=m>81</span> <span class=m>00</span> f9 <span class=m>67</span> <span class=m>95</span> e8 <span class=m>54</span> e5 <span class=m>42</span>
</span></span><span class=line><span class=cl><span class=m>21</span> <span class=m>27</span> ca <span class=m>87</span> aa ac 4a e3 <span class=m>92</span> f8 <span class=m>49</span> <span class=m>72</span> <span class=m>79</span> <span class=m>86</span> f3 5d <span class=m>71</span> a6 <span class=m>28</span> 9c d0 4b <span class=m>73</span> b1 fa a0 <span class=m>87</span> <span class=m>83</span> cf 9a
</span></span><span class=line><span class=cl><span class=m>17</span> 6b <span class=m>21</span> 6c c2 <span class=m>66</span> 7a <span class=m>35</span> 3b <span class=m>37</span> 5b <span class=m>18</span> d9 1c <span class=m>40</span> <span class=m>56</span> 2a <span class=m>31</span> <span class=m>94</span> <span class=m>63</span> b6 <span class=m>93</span> f9 ac <span class=m>38</span> <span class=m>30</span> <span class=m>93</span> 3d 5d c0
</span></span><span class=line><span class=cl>dd <span class=m>63</span> <span class=m>81</span> 0f 9e bc 7f a7 <span class=m>41</span> 8f <span class=m>50</span> <span class=m>90</span> a2 9c 9a <span class=m>87</span> <span class=m>11</span> a5 <span class=m>82</span> b0 c4 c6 <span class=m>74</span> <span class=m>01</span> 7e <span class=m>02</span> <span class=m>21</span> 5d f7 <span class=m>70</span>
</span></span><span class=line><span class=cl><span class=m>53</span> 1e f8 f0 9f <span class=m>64</span> <span class=m>01</span> <span class=m>61</span> b9 9e 4f <span class=m>27</span> bc b5 <span class=m>44</span> fd c4 <span class=m>66</span> e4 <span class=m>66</span> e2 <span class=m>79</span> <span class=m>55</span> e6 4a dd 4e bb 0a ae
</span></span><span class=line><span class=cl>4f <span class=m>02</span> <span class=m>81</span> <span class=m>81</span> <span class=m>00</span> e4 <span class=m>78</span> <span class=m>15</span> e7 b9 <span class=m>36</span> d2 a7 <span class=nb>cd</span> b6 <span class=m>42</span> <span class=m>77</span> bb <span class=m>11</span> 5f 9f c5 <span class=nb>cd</span> <span class=m>56</span> e1 2f 2a c7 <span class=m>36</span> <span class=m>98</span>
</span></span><span class=line><span class=cl>fd fd d2 <span class=m>76</span> aa <span class=m>73</span> <span class=m>17</span> <span class=m>03</span> d2 7a f7 <span class=m>30</span> <span class=m>07</span> <span class=m>39</span> ae <span class=m>72</span> b2 <span class=m>74</span> b6 cf <span class=m>55</span> aa <span class=m>19</span> <span class=m>80</span> ff 0d <span class=m>82</span> c2 <span class=m>57</span> 6e
</span></span><span class=line><span class=cl><span class=m>55</span> fd <span class=m>27</span> ee <span class=m>91</span> <span class=m>05</span> be d0 <span class=m>61</span> <span class=nb>fc</span> <span class=m>16</span> <span class=m>65</span> <span class=m>14</span> 4a b7 c1 <span class=m>92</span> 4e <span class=m>25</span> <span class=m>08</span> <span class=m>74</span> <span class=m>22</span> a3 8c bb <span class=m>59</span> d4 ad <span class=m>78</span> d7
</span></span><span class=line><span class=cl>c9 <span class=m>77</span> <span class=m>86</span> <span class=m>71</span> 1a db <span class=m>87</span> c6 <span class=m>44</span> 8e 0d <span class=m>24</span> 5d <span class=m>81</span> d4 <span class=m>41</span> bd be 3b a1 <span class=m>55</span> c2 6b <span class=m>83</span> <span class=m>41</span> fd d0 b3 2b cb
</span></span><span class=line><span class=cl>5a 7f 3d <span class=m>76</span> <span class=m>51</span> b7 ec b4 <span class=m>59</span> e7 1e <span class=m>42</span> f9 <span class=m>02</span> <span class=m>81</span> <span class=m>80</span> <span class=m>72</span> a7 5c <span class=m>12</span> e2 <span class=m>74</span> <span class=m>42</span> <span class=m>62</span> 5b <span class=m>98</span> 8f a5 b6 6e
</span></span><span class=line><span class=cl>f7 0f a9 <span class=m>74</span> 9a 5b a3 de 5d <span class=m>26</span> d1 eb f9 ab <span class=m>08</span> <span class=m>04</span> b7 dd 2f cf 1c <span class=m>99</span> <span class=m>63</span> 8d <span class=m>40</span> <span class=m>82</span> ad 2c f1 4f
</span></span><span class=line><span class=cl>5d <span class=m>09</span> 4b f9 <span class=m>65</span> <span class=m>02</span> ea <span class=m>29</span> e9 <span class=m>72</span> 9c <span class=m>38</span> 4b 5e b3 c8 <span class=m>23</span> <span class=m>93</span> f1 <span class=m>40</span> bf <span class=m>05</span> 4a <span class=m>94</span> 7c <span class=m>19</span> e8 c4 <span class=m>60</span> <span class=m>83</span>
</span></span><span class=line><span class=cl>8e b0 <span class=m>64</span> e1 f4 9b cc c2 7d <span class=m>35</span> 6f <span class=m>91</span> <span class=m>15</span> <span class=m>12</span> <span class=m>60</span> e9 <span class=m>13</span> <span class=m>86</span> 8a <span class=m>14</span> 2c ce <span class=m>83</span> a4 b2 a8 5e <span class=m>75</span> e7 d3
</span></span><span class=line><span class=cl>7a c9 8a 2d <span class=m>79</span> <span class=m>67</span> <span class=m>17</span> 2e <span class=m>10</span> 3b <span class=m>29</span> d1 f6 3a <span class=m>46</span> ed <span class=m>66</span> <span class=m>61</span> <span class=m>24</span> 3b fd <span class=m>60</span> 7b a1 <span class=m>02</span> <span class=m>81</span> <span class=m>81</span> <span class=m>00</span> b1 b5
</span></span><span class=line><span class=cl><span class=m>36</span> <span class=m>54</span> a7 9c 1c fe a8 e3 bb 8f a5 d2 3d ae e9 0c 6f <span class=m>27</span> <span class=m>78</span> a8 ad 8b aa <span class=m>34</span> e5 d9 6e b3 e6 <span class=m>11</span>
</span></span><span class=line><span class=cl><span class=m>60</span> c7 b7 1d ce 1d d0 a0 <span class=m>00</span> <span class=m>57</span> 0e b1 a3 <span class=m>53</span> de 9b <span class=m>37</span> db 2b <span class=m>87</span> <span class=m>29</span> e3 <span class=m>17</span> cf 8a ba <span class=m>24</span> b6 <span class=m>68</span> e1
</span></span><span class=line><span class=cl>a2 f4 <span class=m>94</span> <span class=m>40</span> <span class=m>57</span> 1f <span class=m>11</span> 7f 1c f1 d0 <span class=m>16</span> be 1c <span class=m>97</span> <span class=m>54</span> df <span class=m>82</span> 5a bd <span class=m>32</span> b1 6c <span class=m>27</span> <span class=m>28</span> f1 <span class=m>49</span> c8 ba <span class=m>39</span>
</span></span><span class=line><span class=cl><span class=m>41</span> de d1 1f <span class=m>27</span> ca <span class=m>13</span> d2 <span class=m>25</span> d0 <span class=m>90</span> c7 <span class=m>91</span> <span class=m>16</span> <span class=m>43</span> c3 9c b5 <span class=m>17</span> d7 dd <span class=m>85</span> <span class=m>93</span> <span class=m>07</span> <span class=m>31</span> <span class=m>31</span> 7d <span class=m>76</span> d2 b9
</span></span><span class=line><span class=cl>2b 0f <span class=m>42</span> d6 <span class=m>27</span> <span class=m>01</span> <span class=m>02</span> <span class=m>81</span> <span class=m>80</span> <span class=m>47</span> d8 <span class=m>24</span> 2a 1f 5f <span class=m>12</span> <span class=m>68</span> <span class=m>83</span> 5e <span class=m>39</span> f5 <span class=m>42</span> f9 fb f9 5b <span class=m>56</span> a7 bf bf
</span></span><span class=line><span class=cl>d0 <span class=m>89</span> <span class=m>32</span> <span class=m>33</span> <span class=nb>fc</span> <span class=m>59</span> bd fe df 0d <span class=m>55</span> a4 <span class=m>28</span> 7c <span class=m>63</span> a5 7c <span class=m>19</span> be fb <span class=nb>fc</span> <span class=m>01</span> ea <span class=m>93</span> 1b 9b 8d da eb c9
</span></span><span class=line><span class=cl><span class=m>34</span> <span class=m>17</span> <span class=m>79</span> 6b fd c1 <span class=m>75</span> <span class=m>02</span> b7 f0 e5 <span class=m>72</span> <span class=m>57</span> <span class=m>88</span> d6 c0 d3 <span class=m>08</span> <span class=m>24</span> <span class=m>11</span> cc a4 2b a8 9c <span class=m>64</span> fa <span class=m>26</span> b7 e3
</span></span><span class=line><span class=cl>ae de 5e f2 5a <span class=m>64</span> 3c <span class=m>58</span> <span class=m>33</span> c6 2a <span class=m>83</span> bf da d4 d8 f2 <span class=m>64</span> e4 <span class=m>62</span> <span class=m>87</span> <span class=m>87</span> <span class=m>34</span> f8 <span class=m>26</span> 2c <span class=m>33</span> 1d ac d4
</span></span><span class=line><span class=cl>fd b3 <span class=m>08</span> <span class=m>67</span> 0f cb <span class=m>20</span> <span class=m>49</span> cb <span class=m>19</span> <span class=m>68</span> bb <span class=m>68</span> <span class=m>26</span> d1 e1 <span class=m>55</span>
</span></span></code></pre></div></li><li>. <a href=https://en.wikipedia.org/wiki/X.690#Identifier_octets>Here is the list of Identifier octets</a> for tags used in DER</li><li><span class="key-text highlight-sequence-type-length">30 82 04 bd</span><ul><li><code>0x30</code> is the tag value for a <code>SEQUENCE</code>. <code>PrivateKeyInfo</code> is a <code>SEQUENCE</code></li><li><code>0x82</code> is the length. However, since the high bit (bit 7) is set (<code>0x1000 0010</code>), it indicates that the length can be found in the next 7 bits (2). Next 2 bytes indicate the length of <code>SEQUENCE</code> as <code>0x04bd</code> (1213 bytes)</li><li>The bytes following <code>0x04bd</code> are the contents of <code>SEQUENCE</code></li></ul></li><li><span class="key-text highlight-integer-type-length">02 01 00</span><ul><li><code>0x02</code> is the tag value of an <code>INTEGER</code></li><li><code>0x01</code> (1 byte) is the length of this integer</li><li>1 byte following <code>0x01</code> is <code>0x00</code> and that&rsquo;s the version (<code>0</code>)</li></ul></li><li><span class="key-text highlight-integer-type-length">30 0d</span><ul><li><code>0x30</code> is the tag value for a <code>SEQUENCE</code>. <code>AlgorithmIdentifier</code> is a <code>SEQUENCE</code></li><li><code>0x0d</code> is the length. Since the high bit (bit 7) is not set (<code>0x0000 1101</code>), it indicates that the length is <code>0x0d</code> (13 bytes)</li><li>The 13 bytes following <code>0x0d</code> are the contents of <code>SEQUENCE</code> (<code>AlgorithmIdentifier</code>)</li></ul></li><li><span class="key-text highlight-oid-type">06 09</span><ul><li><code>0x06</code> is the tag value for an <code>OBJECT IDENTIFIER</code>. <code>algorithm</code> is an <code>OBJECT IDENTIFIER</code> type primitive</li><li><code>0x09</code> is the length. Since the high bit (bit 7) is not set (<code>0x0000 1001</code>), it indicates that the length is <code>0x09</code> (9 bytes)</li><li>The 9 bytes following <code>0x09</code> are the contents of <code>OBJECT IDENTIFIER</code> (<code>algorithm</code>)</li></ul></li><li><span class="key-text highlight-oid">2a 86 48 86 f7 0d 01 01 01</span><ul><li><a href=http://www.oid-info.com/get/1.2.840.113549.1.1.1>Object identifier for RSA private key</a> is <code>1.2.840.113549.1.1.1</code></li><li>The first two components are processed in a special way in DER encoding. If <code>x.y</code> are the first two components, they are encoded as <code>40x + y</code> in hex. So, in our case, <code>1.2</code> would be encoded as <code>42 = 40x1 + 2</code> which is <code>0x2A</code> in hex.</li><li>Subsequent bytes are represented using <a href=https://en.wikipedia.org/wiki/Variable-length_quantity#Examples>Variable Length Quantity (VLQ)</a>, also called base 128.</li><li>Encoding <code>840</code><ul><li><code>840</code> cannot be represented using short form (single byte) since the value is greater than 127</li><li>Represent the value in binary notation: <code>0b 0000 0011 0100 1000</code></li><li>Break it up in groups of 7 bits starting from the lowest significant bit (<code>0b 0000110 1001000</code>). This is equivalent to representing the number in base 128.</li><li>Take the lowest 7 bits, and that gives you the least significant byte (<strong>0</strong>100 1000). This byte comes last. Add a <code>0</code> bit as highest bit for last octet since the last octet should indicate the end of value</li><li>For all the other groups of 7 bits, set the <a href=https://en.wikipedia.org/wiki/Most_significant_bit title="Most significant bit">MSb</a> to <code>1</code>. These added bits denote whether there is another byte to follow or not. Thus, by definition, the very last byte of a variable-length integer will have 0 as its MSb. By this definition our encoding will look like <code>0b 1000 0110 0100 1000</code> which can be represented in hex as <code>86 48</code></li></ul></li><li>Encoding <code>113549</code><ul><li>Represent the value in binary notation: <code>0b 0001 1011 1011 1000 1101</code></li><li>Break it up in groups of 7 bits starting from the lowest significant bit (<code>0b 0000110 1110111 0001101</code>)</li><li>Take the lowest 7 bits, and that gives you the least significant byte (0b<strong>0</strong>000 1101) represented in hex as <code>0x0D</code></li><li>For all the other groups of 7 bits, set the MSb to <code>1</code>. Our encoding will now look like <code>0b 1000 0110 1111 0111</code> which can be represented in hex as <code>0x86f7</code></li><li>Combining them, we get <code>113549</code> represented as <code>86 f7 0d</code></li></ul></li><li>Encoding <code>1.1.1</code><ul><li>These components can be encoded in short-form (1 byte) and hence they are encoded as <code>01 01 01</code></li></ul></li></ul></li><li><span class="key-text highlight-oid">05 00</span><ul><li><code>0x05 </code>is the tag value for a <code>NULL</code>. <code>parameters</code> is <code>NULL</code></li><li><code>0x00</code> indicates 0 length for <code>parameters</code></li><li>So, there are no parameters</li></ul></li><li><span class="key-text highlight-octetstring-type">04 82 04 a7</span><ul><li><code>0x04</code> is the tag value of a <code>OCTET STRING</code>. The algorithm identifier dictates the format of <code>PrivateKey</code>. So, for this RSA example, the DER encoded <code>RSAPrivateKey</code> is the value of the <code>OCTET STRING</code>.</li><li><code>0x82</code> is the length. However, since the high bit (bit 7) is set (<code>0x1000 0010</code>), it indicates that the length can be found in the next 7 bits (2). Next 2 bytes indicate the length of <code>OCTET STRING</code> to be <code>0x04a7</code> (1191 bytes)</li><li>The bytes following <code>0x04a7</code> are the contents of <code>OCTET STRING</code> (<code>SEQUENCE</code> of <code>RSAPrivateKey</code>)</li></ul></li><li><span class="key-text highlight-sequence-type-length">30 82 04 a3</span><ul><li><code>0x30</code> is the tag value for a <code>SEQUENCE</code>. <code>RSAPrivateKey</code> is a <code>SEQUENCE</code></li><li><code>0x82</code> is the length. However, since the high bit (bit 7) is set (<code>0x1000 0010</code>), it indicates that the length can be found in the next 7 bits (2). Next 2 bytes indicate the length of <code>SEQUENCE</code> as <code>0x04a3</code> (1187 bytes)</li><li>The bytes following <code>0x04a3</code> are the contents of <code>SEQUENCE</code></li></ul></li><li><span class="key-text highlight-integer-type-length">02 01 00</span><ul><li><code>0x02</code> is the tag value of an <code>INTEGER</code></li><li><code>0x01</code> (1 byte) is the length of this integer</li><li>1 byte following <code>0x01</code> is <code>0x00</code> and that&rsquo;s the version (<code>0</code>)</li></ul></li><li><span class="key-text highlight-integer-type-length">02 82 01 01</span><ul><li><code>0x02</code> is the tag value of an <code>INTEGER</code>. <code>modulus</code> is an <code>INTEGER</code></li><li><code>0x82</code> is the length. Since the high bit (bit 7) is set (<code>0x1000 0010</code>), it indicates that the length can be found in the next 7 bits (next 2 bytes). So, <code>0x0101</code> (257 bytes) is the length of <code>INTEGER</code></li><li>256 bytes are used for 2048 bit modulus and 1 byte is used as a sign byte (<code>0</code> indicates positive integer)</li><li>257 bytes following <code>0x0101</code> represent the public modulus</li></ul></li><li><span class="key-text highlight-modulus">00 de 95 3f 68 70 b9 92 60 e8 96 e4 bc 72 16 15 54 20 5a 1e df 42 24
1f ba 6f a1 52 97 ab 1b fb a2 78 4b e3 1a a3 ba 0c d1 27 4f bd 89 45 fa 54 fc 46 ab 02 bc
24 97 32 5f ae c1 62 41 e4 92 d5 77 60 6a 91 a9 6f 82 57 83 3a 84 1b 9d d1 10 5c 35 a6 1b
5c 94 cd 2c 2c 56 b5 cd 16 9e 86 fd 16 88 b2 eb a0 42 c8 76 bf 25 39 5a 71 ec e0 71 23 fa
ab 96 21 e0 97 85 dd eb 62 5a 67 6f 4a d6 2e 0d a0 50 ca d7 01 0f 16 d0 31 1b f9 9e 0b 7b
40 4e 5c 2a b5 ad 23 36 fa ac 8b d4 9f 6e 80 a9 5e 73 6e 16 cf 9d 41 16 b7 79 8e 62 5d b5
54 42 36 5b 47 06 02 cc ab 43 29 d7 9b 4a 88 02 b4 bd 1f 41 57 d5 a8 cd 50 e1 59 2c 10 64
09 93 86 38 69 5c ff 68 81 63 4b e1 42 72 ac 28 a8 98 4d a3 83 d9 90 be fd 12 f9 6b d3 38
11 e8 fe ab 79 33 fc 77 cb 83 e1 a1 04 e6 a1 b8 f8 fa 41 cd 64 95 e8 d7</span><ul><li>Value of public modulus represented in 257 bytes</li></ul></li><li><span class="key-text highlight-integer-type-length">02 03</span><ul><li><code>0x02</code> is the tag value of an <code>INTEGER</code>. <code>publicexponent</code> is an <code>INTEGER</code></li><li><code>0x03</code> (3 bytes) is the length of this integer</li><li>3 bytes following <code>0x03</code> represent the public exponent</li></ul></li><li><span class="key-text highlight-exponent">01 00 01</span><ul><li>Value of public exponent (65537)</li></ul></li><li><span class="key-text highlight-integer-type-length">02 82 01 00</span><ul><li><code>0x02</code> is the tag value of an <code>INTEGER</code>. <code>privateExponent</code> is an <code>INTEGER</code></li><li><code>0x82</code> is the length. Since the high bit (bit 7) is set (<code>0x1000 0010</code>), it indicates that the length can be found in the next 7 bits (next 2 bytes). So, <code>0x0100</code> (256 bytes) is the length of <code>privateExponent</code></li><li>256 bytes following <code>0x0100</code> represent the private exponent</li></ul></li><li><span class="key-text highlight-private-exponent">07 99 4f 9a 43 ca 22 14 31 49 67 19 50 af c7 eb 07 22 1f b4 e4 bc 91 c7 ee 3d b3
17 f2 10 85 e6 ec a8 d8 fb 68 0b 23 ce 14 2a 18 f4 38 31 93 77 fb c8 d8 05 a8 b7 bc b7 eb
ee d0 36 24 14 f4 d2 b4 b5 c1 e2 e7 8d de 36 94 1a a4 7f 85 65 10 97 3b 7d ea 71 d4 74 f2
35 c4 6c 58 9d f1 49 6f dc e8 10 6e 12 06 67 32 9f c8 82 13 5e 03 7f 92 ee ad af c2 a5 85
a6 c3 b9 60 7f 36 d1 fd 41 df 0a 90 22 a0 ed 24 ce 98 3e 88 2b 6a ba 2d 46 d0 c2 82 03 44
83 26 47 8a 95 54 fe 6f e7 13 fd a5 34 dd 3e e3 f9 84 d0 40 81 42 19 c8 7f 83 7b 63 5e 6f
1b 86 31 f2 df ad 06 61 b6 6a c6 fa b2 dd 39 87 a3 fe 97 7b c9 86 59 52 f2 b5 3a e9 52 77
94 ed 95 b3 a8 ed 99 5e bb 03 4d dc 0a bb 1f c5 63 d1 0f ea 0b bb cc 98 cc fc 9b 66 87 f9
df 0d 0b b4 f7 5e fa 73 93 ba 30 f5 15 ac db ca d0 41 f1</span><ul><li>Value of private exponent represented in 256 bytes</li></ul></li><li><span class="key-text highlight-integer-type-length">02 81 81</span><ul><li><code>0x02</code> is the tag value of an <code>INTEGER</code> (prime1)</li><li><code>0x81</code> is the length. However, since the high bit (bit 7) is set (<code>0x1000 0001</code>), it indicates that the length can be found in the next 7 bits (next 1 byte). So, <code>0x81</code> (129 bytes) is the length of <code>INTEGER</code> (prime1)</li><li>129 bytes following <code>0x81</code> represent the prime1</li></ul></li><li><span class="key-text highlight-prime1">00 f9 67 95 e8 54 e5 42
21 27 ca 87 aa ac 4a e3 92 f8 49 72 79 86 f3 5d 71 a6 28 9c d0 4b 73 b1 fa a0 87 83 cf 9a
17 6b 21 6c c2 66 7a 35 3b 37 5b 18 d9 1c 40 56 2a 31 94 63 b6 93 f9 ac 38 30 93 3d 5d c0
dd 63 81 0f 9e bc 7f a7 41 8f 50 90 a2 9c 9a 87 11 a5 82 b0 c4 c6 74 01 7e 02 21 5d f7 70
53 1e f8 f0 9f 64 01 61 b9 9e 4f 27 bc b5 44 fd c4 66 e4 66 e2 79 55 e6 4a dd 4e bb 0a ae
4f</span><ul><li>Value of <code>prime1</code> represented in 129 bytes</li></ul></li><li><span class="key-text highlight-integer-type-length">02 81 81</span><ul><li><code>0x02</code> is the tag value of an <code>INTEGER</code> (prime2)</li><li><code>0x81</code> is the length. However, since the high bit (bit 7) is set (<code>0x1000 0001</code>), it indicates that the length can be found in the next 7 bits (next 1 byte). So, <code>0x81</code> (129 bytes) is the length of <code>INTEGER</code> (prime2)</li><li>129 bytes following <code>0x81</code> represent the prime2</li></ul></li><li><span class="key-text highlight-prime2">00 e4 78 15 e7 b9 36 d2 a7 cd b6 42 77 bb 11 5f 9f c5 cd 56 e1 2f 2a c7 36 98
fd fd d2 76 aa 73 17 03 d2 7a f7 30 07 39 ae 72 b2 74 b6 cf 55 aa 19 80 ff 0d 82 c2 57 6e
55 fd 27 ee 91 05 be d0 61 fc 16 65 14 4a b7 c1 92 4e 25 08 74 22 a3 8c bb 59 d4 ad 78 d7
c9 77 86 71 1a db 87 c6 44 8e 0d 24 5d 81 d4 41 bd be 3b a1 55 c2 6b 83 41 fd d0 b3 2b cb
5a 7f 3d 76 51 b7 ec b4 59 e7 1e 42 f9</span><ul><li>Value of <code>prime2</code> represented in 129 bytes</li></ul></li><li><span class="key-text highlight-integer-type-length">02 81 80</span><ul><li><code>0x02</code> is the tag value of an <code>INTEGER</code> (exponent1)</li><li><code>0x81</code> is the length. However, since the high bit (bit 7) is set (<code>0x1000 0001</code>), it indicates that the length can be found in the next 7 bits (next 1 byte). So, <code>0x80</code> (128 bytes) is the length of <code>INTEGER</code> (exponent1)</li><li>128 bytes following <code>0x80</code> represent <code>exponent1</code></li></ul></li><li><span class="key-text highlight-exp1">72 a7 5c 12 e2 74 42 62 5b 98 8f a5 b6 6e
f7 0f a9 74 9a 5b a3 de 5d 26 d1 eb f9 ab 08 04 b7 dd 2f cf 1c 99 63 8d 40 82 ad 2c f1 4f
5d 09 4b f9 65 02 ea 29 e9 72 9c 38 4b 5e b3 c8 23 93 f1 40 bf 05 4a 94 7c 19 e8 c4 60 83
8e b0 64 e1 f4 9b cc c2 7d 35 6f 91 15 12 60 e9 13 86 8a 14 2c ce 83 a4 b2 a8 5e 75 e7 d3
7a c9 8a 2d 79 67 17 2e 10 3b 29 d1 f6 3a 46 ed 66 61 24 3b fd 60 7b a1</span><ul><li>Value of <code>exponent1</code> represented in 128 bytes</li></ul></li><li><span class="key-text highlight-integer-type-length">02 81 81</span><ul><li><code>0x02</code> is the tag value of an <code>INTEGER</code> (exponent2)</li><li><code>0x81</code> is the length. However, since the high bit (bit 7) is set (<code>0x1000 0001</code>), it indicates that the length can be found in the next 7 bits (next 1 byte). So, <code>0x81</code> (129 bytes) is the length of <code>INTEGER</code> (exponent2)</li><li>129 bytes following <code>0x81</code> represent the exponent2</li></ul></li><li><span class="key-text highlight-exp2">00 b1 b5
36 54 a7 9c 1c fe a8 e3 bb 8f a5 d2 3d ae e9 0c 6f 27 78 a8 ad 8b aa 34 e5 d9 6e b3 e6 11
60 c7 b7 1d ce 1d d0 a0 00 57 0e b1 a3 53 de 9b 37 db 2b 87 29 e3 17 cf 8a ba 24 b6 68 e1
a2 f4 94 40 57 1f 11 7f 1c f1 d0 16 be 1c 97 54 df 82 5a bd 32 b1 6c 27 28 f1 49 c8 ba 39
41 de d1 1f 27 ca 13 d2 25 d0 90 c7 91 16 43 c3 9c b5 17 d7 dd 85 93 07 31 31 7d 76 d2 b9
2b 0f 42 d6 27 01</span><ul><li>Value of <code>exponent2</code> represented in 129 bytes</li></ul></li><li><span class="key-text highlight-integer-type-length">02 81 80</span><ul><li><code>0x02</code> is the tag value of an <code>INTEGER</code> (coefficient)</li><li><code>0x81</code> is the length. However, since the high bit (bit 7) is set (<code>0x1000 0001</code>), it indicates that the length can be found in the next 7 bits (next 1 byte). So, <code>0x80</code> (128 bytes) is the length of <code>INTEGER</code> (coefficient)</li><li>128 bytes following <code>0x80</code> represent <code>coefficient</code></li></ul></li><li><span class="key-text highlight-coefficient">47 d8 24 2a 1f 5f 12 68 83 5e 39 f5 42 f9 fb f9 5b 56 a7 bf bf
d0 89 32 33 fc 59 bd fe df 0d 55 a4 28 7c 63 a5 7c 19 be fb fc 01 ea 93 1b 9b 8d da eb c9
34 17 79 6b fd c1 75 02 b7 f0 e5 72 57 88 d6 c0 d3 08 24 11 cc a4 2b a8 9c 64 fa 26 b7 e3
ae de 5e f2 5a 64 3c 58 33 c6 2a 83 bf da d4 d8 f2 64 e4 62 87 87 34 f8 26 2c 33 1d ac d4
fd b3 08 67 0f cb 20 49 cb 19 68 bb 68 26 d1 e1 55</span><ul><li>Value of <code>coefficient</code> represented in 128 bytes</li></ul></li><li>Values of RSA private key can be verified using <code>openssl rsa</code> command<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl rsa -in /tmp/id_rsa_2048_pkcs8.pem -noout -text
</span></span><span class=line><span class=cl>Private-Key: <span class=o>(</span><span class=m>2048</span> bit, <span class=m>2</span> primes<span class=o>)</span>
</span></span><span class=line><span class=cl>modulus:
</span></span><span class=line><span class=cl>    00:de:95:3f:68:70:b9:92:60:e8:96:e4:bc:72:16:
</span></span><span class=line><span class=cl>    ...
</span></span><span class=line><span class=cl>    e8:d7
</span></span><span class=line><span class=cl>publicExponent: <span class=m>65537</span> <span class=o>(</span>0x10001<span class=o>)</span>
</span></span><span class=line><span class=cl>privateExponent:
</span></span><span class=line><span class=cl>    07:99:4f:9a:43:ca:22:14:31:49:67:19:50:af:c7:
</span></span><span class=line><span class=cl>	...41:f1
</span></span><span class=line><span class=cl>prime1:
</span></span><span class=line><span class=cl>    00:f9:67:95:e8:54:e5:42:21:27:ca:87:aa:ac:4a:
</span></span><span class=line><span class=cl>    ...
</span></span><span class=line><span class=cl>    55:e6:4a:dd:4e:bb:0a:ae:4f
</span></span><span class=line><span class=cl>prime2:
</span></span><span class=line><span class=cl>    00:e4:78:15:e7:b9:36:d2:a7:cd:b6:42:77:bb:11:
</span></span><span class=line><span class=cl>	...
</span></span><span class=line><span class=cl>    51:b7:ec:b4:59:e7:1e:42:f9
</span></span><span class=line><span class=cl>exponent1:
</span></span><span class=line><span class=cl>    72:a7:5c:12:e2:74:42:62:5b:98:8f:a5:b6:6e:f7:
</span></span><span class=line><span class=cl>    ...
</span></span><span class=line><span class=cl>    66:61:24:3b:fd:60:7b:a1
</span></span><span class=line><span class=cl>exponent2:
</span></span><span class=line><span class=cl>    00:b1:b5:36:54:a7:9c:1c:fe:a8:e3:bb:8f:a5:d2:
</span></span><span class=line><span class=cl>    ...
</span></span><span class=line><span class=cl>    76:d2:b9:2b:0f:42:d6:27:01
</span></span><span class=line><span class=cl>coefficient:
</span></span><span class=line><span class=cl>    47:d8:24:2a:1f:5f:12:68:83:5e:39:f5:42:f9:fb:
</span></span><span class=line><span class=cl>    ...
</span></span><span class=line><span class=cl>    19:68:bb:68:26:d1:e1:55
</span></span></code></pre></div></li></ul><h3 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h3><ul><li><a href=https://www.rfc-editor.org/rfc/rfc5208#section-5>RFC 5208 - Private-Key Information Syntax</a></li><li><a href=https://www.openssl.org/docs/man1.0.2/man1/openssl-genrsa.html>OpenSSL 1.0.2 - openssl-genrsa</a></li><li><a href=https://www.openssl.org/docs/man1.0.2/man1/openssl-asn1parse.html>OpenSSL 1.0.2 - openssl-asn1parse</a></li><li><a href=https://www.openssl.org/docs/man1.0.2/man1/openssl-pkcs8.html>OpenSSL 1.0.2 - openssl-pkcs8</a></li><li><a href=https://en.wikipedia.org/wiki/PKCS_8>Wiki: PKCS #8</a></li><li><a href=https://en.wikipedia.org/wiki/ASN.1>Wiki: ASN.1</a></li><li><a href=https://en.wikipedia.org/wiki/X.690#Length_octets>Wiki: Length octets encoding forms</a></li><li><a href=https://en.wikipedia.org/wiki/X.690#Identifier_octets>Wiki: Identifier octets</a></li><li><a href=https://rawcdn.githack.com/lapo-luchini/asn1js/1.2.4/index.html>ASN.1 Javascript decoder tool</a></li><li><a href=https://en.wikipedia.org/wiki/Variable-length_quantity>Explained: Variable length quantity</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://partbypart.github.io/tags/pkcs%238/>Pkcs#8</a></li><li><a href=https://partbypart.github.io/tags/openssl/>Openssl</a></li><li><a href=https://partbypart.github.io/tags/rsa/>Rsa</a></li><li><a href=https://partbypart.github.io/tags/privatekey/>Privatekey</a></li><li><a href=https://partbypart.github.io/tags/deepdive/>Deepdive</a></li><li><a href=https://partbypart.github.io/tags/pem/>Pem</a></li><li><a href=https://partbypart.github.io/tags/der/>Der</a></li></ul><nav class=paginav><a class=prev href=https://partbypart.github.io/posts/deep-dive-subjectpublickeyinfo-rsa-public-key/><span class=title>« Prev</span><br><span>Deep dive - Anatomy of a SubjectPublicKeyInfo RSA public key</span>
</a><a class=next href=https://partbypart.github.io/posts/deep-dive-pkcs1-rsa-private-key/><span class=title>Next »</span><br><span>Deep dive - Anatomy of a PKCS#1 RSA private key</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Deep dive - Anatomy of a PKCS#8 RSA private key on x" href="https://x.com/intent/tweet/?text=Deep%20dive%20-%20Anatomy%20of%20a%20PKCS%238%20RSA%20private%20key&amp;url=https%3a%2f%2fpartbypart.github.io%2fposts%2fdeep-dive-pkcs8-rsa-private-key%2f&amp;hashtags=pkcs%238%2copenssl%2crsa%2cprivatekey%2cdeepdive%2cpem%2cder"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Deep dive - Anatomy of a PKCS#8 RSA private key on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fpartbypart.github.io%2fposts%2fdeep-dive-pkcs8-rsa-private-key%2f&amp;title=Deep%20dive%20-%20Anatomy%20of%20a%20PKCS%238%20RSA%20private%20key&amp;summary=Deep%20dive%20-%20Anatomy%20of%20a%20PKCS%238%20RSA%20private%20key&amp;source=https%3a%2f%2fpartbypart.github.io%2fposts%2fdeep-dive-pkcs8-rsa-private-key%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Deep dive - Anatomy of a PKCS#8 RSA private key on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fpartbypart.github.io%2fposts%2fdeep-dive-pkcs8-rsa-private-key%2f&title=Deep%20dive%20-%20Anatomy%20of%20a%20PKCS%238%20RSA%20private%20key"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Deep dive - Anatomy of a PKCS#8 RSA private key on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fpartbypart.github.io%2fposts%2fdeep-dive-pkcs8-rsa-private-key%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Deep dive - Anatomy of a PKCS#8 RSA private key on whatsapp" href="https://api.whatsapp.com/send?text=Deep%20dive%20-%20Anatomy%20of%20a%20PKCS%238%20RSA%20private%20key%20-%20https%3a%2f%2fpartbypart.github.io%2fposts%2fdeep-dive-pkcs8-rsa-private-key%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Deep dive - Anatomy of a PKCS#8 RSA private key on telegram" href="https://telegram.me/share/url?text=Deep%20dive%20-%20Anatomy%20of%20a%20PKCS%238%20RSA%20private%20key&amp;url=https%3a%2f%2fpartbypart.github.io%2fposts%2fdeep-dive-pkcs8-rsa-private-key%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Deep dive - Anatomy of a PKCS#8 RSA private key on ycombinator" href="https://news.ycombinator.com/submitlink?t=Deep%20dive%20-%20Anatomy%20of%20a%20PKCS%238%20RSA%20private%20key&u=https%3a%2f%2fpartbypart.github.io%2fposts%2fdeep-dive-pkcs8-rsa-private-key%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://partbypart.github.io/>Learn part by part</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a><br><a href=https://www.flaticon.com/free-icons/timber title="timber icons">Timber icons created by imaginationlol - Flaticon</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>