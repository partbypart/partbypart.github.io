<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Deep dive - Verify SSL/TLS Certificate Signature | Learn part by part</title>
<meta name=keywords content="tls"><meta name=description content="Learn how to download an SSL/TLS certificate and verify the signature using simple OpenSSL commands"><meta name=author content><link rel=canonical href=http://localhost:1313/posts/deep-dive-verify-tls-cert-signature/><meta name=google-site-verification content="G-MF6MC03DXC"><link crossorigin=anonymous href=/assets/css/stylesheet.3d7762722335c73f2381169d306394abeb2bec3f9af8fbf9b5851e7265c1c292.css integrity="sha256-PXdiciM1xz8jgRadMGOUq+sr7D+a+Pv5tYUecmXBwpI=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=alternate hreflang=en href=http://localhost:1313/posts/deep-dive-verify-tls-cert-signature/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-MF6MC03DXC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-MF6MC03DXC")}</script><meta property="og:url" content="http://localhost:1313/posts/deep-dive-verify-tls-cert-signature/"><meta property="og:site_name" content="Learn part by part"><meta property="og:title" content="Deep dive - Verify SSL/TLS Certificate Signature"><meta property="og:description" content="Learn how to download an SSL/TLS certificate and verify the signature using simple OpenSSL commands"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:tag" content="Tls"><meta property="og:image" content="http://localhost:1313/posts/deep-dive-verify-tls-cert-signature/images/https-padlock-logo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/posts/deep-dive-verify-tls-cert-signature/images/https-padlock-logo.png"><meta name=twitter:title content="Deep dive - Verify SSL/TLS Certificate Signature"><meta name=twitter:description content="Learn how to download an SSL/TLS certificate and verify the signature using simple OpenSSL commands"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Deep dive - Verify SSL/TLS Certificate Signature","item":"http://localhost:1313/posts/deep-dive-verify-tls-cert-signature/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Deep dive - Verify SSL/TLS Certificate Signature","name":"Deep dive - Verify SSL\/TLS Certificate Signature","description":"Learn how to download an SSL/TLS certificate and verify the signature using simple OpenSSL commands","keywords":["tls"],"articleBody":"TODO Shorten Introduction If you’ve read/heard about digital signatures, openssl, public key cryptography, https or tls, you may have wondered\n“How does my browser use these signatures?” “How does my browser verify these digital signatures?” “When amazon.com provides a digital certificate, how and why does my browser trust it?” This article lets us take the reins of browser and be the verification guard using openssl tools. Let’s try to understand what goes behind the scenes of a browser’s certificate signature verification.\nPrerequisites Linux based machine OpenSSL (it’s usually installed on linux based machines) First of all, why should we (as in browsers) verify? Let’s say we’ve read about uses of Diffie-Hellman, RSA1 public key cryptography, AES-CBC2 and hash algorithms. Now, if we were supposed to design a secure architecture to browse amazon.com, our thought process would be something like: “Hmm, let me see… First of all, I need to encrypt my passwords, credit card info etc, so I need a key to encrypt. The server also needs to have the same key to decrypt my content and to encrypt the data it sends me” “However, it’s impractical to visit Amazon Seattle HQ and get a key exchanged. It’s also ridiculously idiotic to trade our secret key as plaintext on internet. It’s as good as handing out the key to anyone listening to our connection. I need a secure key exchange protocol like DHKE3!” “If I can trade my DH4 public parameters with amazon.com, we (server and I) can securely generate our own little shared secret key and we can use that to encrypt/decrypt stuff” “Whoops! If I receive DH public parameters as plaintext on internet, the person listening to our connection in starbucks could also send me those parameters and I could end up trading keys with him! That’s bad!” “IDEA!! Is this the best idea or what! What if amazon.com can share it’s public key with me, sign DH parameters using it’s private key! Now, when I decrypt using amazon’s public key, I can be 100% sure that amazon.com had signed it using it’s private key and nobody else! YAY!! Problem solved!” (After a few minutes …) “I think I celebrated a little early! I think we’re back to the same problem. What if this impersonator in my network sends me a public key and claims that amazon.com sent it? How do I verify??” This is where we need a “Trusted Third Party/Certificate Authority/CA)”. CA computes a hash over all the certificate data (except signature) and encrypts the hash with it’s private key.\n[Q] Why was the signature excluded from hash? [A] CA doesn’t have a time machine to go into the future and see what signature would be generated. If it did, it would sign the entire certificate including the future signature.\nFYI: Encrypting the hash is called signing. This is how a signature is generated. We can’t know the signature beforehand to sign it.\n[Q] So, the signature is delivered separately to clients? [A] No, it’s part of the certificate. All of the data you need to validate the server’s identity is contained in the certificate (including the signature). So, you need to remove the signature field before computing the hash and verifying.\n[Q] What data is signed?? [A] Entity’s identity, validity, extensions, public key and a lot of other data related to entity is signed by the CA. If any parts of the certificate are modified by a man-in-the-middle, the CA’s signature will not validate.\nBasic structure of a X.509 certificate The basic structure of a certificate is shown in the specification for X.509 certificates on the Internet, RFC5280.\nX.509 v3 certificate basic syntax:\nCertificate ::= SEQUENCE { tbsCertificate TBSCertificate, signatureAlgorithm AlgorithmIdentifier, signatureValue BIT STRING } label meaning tbsCertificate The field contains the names of the subject and issuer, a public key associated with the subject, a validity period, and other associated information signatureAlgorithm Identifier for the cryptographic algorithm used by the CA to sign this certificate signatureValue Digital signature computed upon the ASN.1 DER encoded tbsCertificate tbs: to be signed\nConsider tbsCertificate, signatureAlgorithm, signatureValue as custom data types (struct) with other fields.\nSo, Certificate has a SEQUENCE. A SEQUENCE contains an ordered field of one or more types. It is encoded into a TLV triplet that begins with a Tag byte of 0x30. tbsCertificate and signatureAlgorithm also have a SEQUENCE.\nTBSCertificate ::= SEQUENCE { version [0] EXPLICIT Version DEFAULT v1, serialNumber CertificateSerialNumber, signature AlgorithmIdentifier, issuer Name, validity Validity, subject Name, subjectPublicKeyInfo SubjectPublicKeyInfo, issuerUniqueID [1] IMPLICIT UniqueIdentifier OPTIONAL, -- If present, version MUST be v2 or v3 subjectUniqueID [2] IMPLICIT UniqueIdentifier OPTIONAL, -- If present, version MUST be v2 or v3 extensions [3] EXPLICIT Extensions OPTIONAL -- If present, version MUST be v3 } AlgorithmIdentifier ::= SEQUENCE { algorithm OBJECT IDENTIFIER, parameters ANY DEFINED BY algorithm OPTIONAL } Just to get a glimpse of how this data is structured, it’s probably a good time to take a look at the super helpful ASN.1 decoder by Lapo Luchini.\nDownload a sample google certificate in PEM format from here\nUpload the file on ASN.1 JavaScript decoder and observe the hierarchy\nThe top level SEQUENCE has 3 fields (SEQUENCE, SEQUENCE, BIT STRING) which corresponds to tbsCertificate, signatureAlgorithm and signatureValue respectively.\nIn this certificate:\nTBSCertificate lives at offset 4\nAlgorithmIdentifier lives at offset 1377\nsignatureValue lives at offset 1392\nYou can confirm the same using openssl asn1parse tool as well (Shown later in this article)\nIn order to verify that a certificate was signed by a specific CA, we would need to possess the following:\nPublic key of the CA (issuer) Signature and Algorithm used to generate the signature Verifying server’s public key Download the server’s certificates to /tmp in PEM format.\n$ openssl s_client -connect stackoverflow.com:443 -showcerts 2\u003e/dev/null ","wordCount":"2961","inLanguage":"en","image":"http://localhost:1313/posts/deep-dive-verify-tls-cert-signature/images/https-padlock-logo.png","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/deep-dive-verify-tls-cert-signature/"},"publisher":{"@type":"Organization","name":"Learn part by part","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="PartByPart (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>PartByPart</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=CATEGORIES><span>CATEGORIES</span></a></li><li><a href=http://localhost:1313/tags/ title=TAGS><span>TAGS</span></a></li><li><a href=http://localhost:1313/archives/ title=ARCHIVES><span>ARCHIVES</span></a></li><li><a href=http://localhost:1313/search/ title="SEARCH (Alt + /)" accesskey=/><span>SEARCH</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Deep dive - Verify SSL/TLS Certificate Signature
<span class=entry-hint title=Draft><svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h1><div class=post-description>Learn how to download an SSL/TLS certificate and verify the signature using simple OpenSSL commands</div><div class=post-meta>14 min&nbsp;·&nbsp;2961 words</div></header><figure class=entry-cover><img loading=eager src=http://localhost:1313/images/https-padlock-logo.png alt="https padlock"></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#todo>TODO</a></li><li><a href=#introduction>Introduction</a></li><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#first-of-all-why-should-we-as-in-browsers-verify>First of all, why should we (as in browsers) verify?</a></li><li><a href=#basic-structure-of-a-x509-certificate>Basic structure of a X.509 certificate</a></li><li><a href=#verifying-servers-public-key>Verifying server&rsquo;s public key</a></li><li><a href=#faq>FAQ</a></li><li><a href=#footnotes>Footnotes</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h3 id=todo>TODO<a hidden class=anchor aria-hidden=true href=#todo>#</a></h3><ul><li>Shorten</li></ul><h3 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h3><p>If you&rsquo;ve read/heard about digital signatures, openssl, public key cryptography,
https or tls, you may have wondered</p><ul><li><em>&ldquo;How does my browser use these signatures?&rdquo;</em></li><li><em>&ldquo;How does my browser verify these digital signatures?&rdquo;</em></li><li><em>&ldquo;When amazon.com provides a digital certificate, how and why does my browser
trust it?&rdquo;</em></li></ul><p>This article lets us take the reins of browser and be the verification guard
using <code>openssl</code> tools. Let&rsquo;s try to understand what goes behind the scenes of
a browser&rsquo;s certificate signature verification.</p><h3 id=prerequisites>Prerequisites<a hidden class=anchor aria-hidden=true href=#prerequisites>#</a></h3><ul><li>Linux based machine</li><li>OpenSSL (it&rsquo;s usually installed on linux based machines)</li></ul><h3 id=first-of-all-why-should-we-as-in-browsers-verify>First of all, why should we (as in browsers) verify?<a hidden class=anchor aria-hidden=true href=#first-of-all-why-should-we-as-in-browsers-verify>#</a></h3><p>Let&rsquo;s say we&rsquo;ve read about uses of Diffie-Hellman, RSA<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> public key
cryptography, AES-CBC<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> and hash algorithms. Now, if we were supposed to
design a secure architecture to browse <em>amazon.com</em>, our thought process would
be something like:<br></p><ul><li><em>&ldquo;Hmm, let me see&mldr; First of all, I need to encrypt my passwords, credit card
info etc, so I need a key to encrypt. The server also needs to have the same
key to decrypt my content and to encrypt the data it sends me&rdquo;</em></li><li><em>&ldquo;However, it&rsquo;s impractical to visit Amazon Seattle HQ and get a key
exchanged. It&rsquo;s also ridiculously idiotic to trade our secret key as
plaintext on internet. It&rsquo;s as good as handing out the key to anyone
listening to our connection. I need a secure key exchange protocol like
DHKE<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>!&rdquo;</em></li><li><em>&ldquo;If I can trade my DH<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup> public parameters with amazon.com, we (server and I)
can securely generate our own little shared secret key and we can use that
to encrypt/decrypt stuff&rdquo;</em></li><li><em>&ldquo;Whoops! If I receive DH public parameters as plaintext on internet, the
person listening to our connection in starbucks could also send me those
parameters and I could end up trading keys with him! That&rsquo;s bad!&rdquo;</em></li><li><em>&ldquo;IDEA!! Is this the best idea or what! What if amazon.com can share it&rsquo;s
public key with me, sign DH parameters using it&rsquo;s private key! Now, when
I decrypt using amazon&rsquo;s public key, I can be 100% sure that amazon.com
had signed it using it&rsquo;s private key and nobody else! YAY!! Problem
solved!&rdquo;</em><br><br><em>(After a few minutes &mldr;)</em><br><br></li><li><em>&ldquo;I think I celebrated a little early! I think we&rsquo;re back to the same
problem. What if this impersonator in my network sends me a public key
and claims that amazon.com sent it? How do I verify??&rdquo;</em></li></ul><p>This is where we need a <em>&ldquo;Trusted Third Party/Certificate Authority/CA)&rdquo;</em>.
CA computes a hash over all the certificate data (<em><strong>except signature</strong></em>) and
encrypts the hash with it&rsquo;s private key.</p><p><strong>[Q]</strong> <em><strong>Why was the signature excluded from hash?</strong></em><br><strong>[A]</strong> CA doesn&rsquo;t have a time machine to go into the future and see what signature
would be generated. If it did, it would sign the entire certificate including
the future signature.</p><blockquote><p>FYI: Encrypting the hash is called signing. This is how a signature is
generated. We can&rsquo;t know the signature beforehand to sign it.</p></blockquote><p><strong>[Q]</strong> <em><strong>So, the signature is delivered separately to clients?</strong></em><br><strong>[A]</strong> No, it&rsquo;s part of the certificate. All of the data you need to validate the
server&rsquo;s identity is contained in the certificate (including the signature).
So, you need to remove the signature field before computing the hash and
verifying.</p><p><strong>[Q]</strong> <em><strong>What data is signed?</strong></em>?<br><strong>[A]</strong> Entity&rsquo;s identity, validity, extensions, public key and a lot of
other data related to entity is signed by the CA.
If any parts of the certificate are modified by a man-in-the-middle, the CA&rsquo;s
signature will not validate.</p><h3 id=basic-structure-of-a-x509-certificate>Basic structure of a X.509 certificate<a hidden class=anchor aria-hidden=true href=#basic-structure-of-a-x509-certificate>#</a></h3><p>The basic structure of a certificate is shown in the specification for X.509
certificates on the Internet, <a href=https://tools.ietf.org/html/rfc5280#section-4.1>RFC5280</a>.</p><p><a href=https://tools.ietf.org/html/rfc5280#section-4.1>X.509 v3 certificate basic syntax</a>:</p><pre tabindex=0><code>   Certificate  ::=  SEQUENCE  {
        tbsCertificate       TBSCertificate,
        signatureAlgorithm   AlgorithmIdentifier,
        signatureValue       BIT STRING  }
</code></pre><table><thead><tr><th>label</th><th>meaning</th></tr></thead><tbody><tr><td><em>tbsCertificate</em></td><td>The field contains the names of the subject and issuer, a public key associated with the subject, a validity period, and other associated information</td></tr><tr><td><em>signatureAlgorithm</em></td><td>Identifier for the cryptographic algorithm used by the CA to sign this certificate</td></tr><tr><td><em>signatureValue</em></td><td>Digital signature computed upon the ASN.1 DER encoded <em>tbsCertificate</em></td></tr></tbody></table><blockquote><p><em>tbs</em>: to be signed</p></blockquote><p>Consider <em>tbsCertificate</em>, <em>signatureAlgorithm</em>, <em>signatureValue</em> as custom
data types (struct) with other fields.</p><p>So, Certificate has a <em>SEQUENCE</em>. A <em>SEQUENCE</em> contains an ordered field of one
or more types. It is encoded into a TLV triplet that begins with a <strong>Tag</strong> byte
of <em>0x30</em>. <em>tbsCertificate</em> and <em>signatureAlgorithm</em> also have a <em>SEQUENCE.</em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>TBSCertificate  ::<span class=o>=</span>  SEQUENCE  <span class=o>{</span>
</span></span><span class=line><span class=cl>        version         <span class=o>[</span>0<span class=o>]</span>  EXPLICIT Version DEFAULT v1,
</span></span><span class=line><span class=cl>        serialNumber         CertificateSerialNumber,
</span></span><span class=line><span class=cl>        signature            AlgorithmIdentifier,
</span></span><span class=line><span class=cl>        issuer               Name,
</span></span><span class=line><span class=cl>        validity             Validity,
</span></span><span class=line><span class=cl>        subject              Name,
</span></span><span class=line><span class=cl>        subjectPublicKeyInfo SubjectPublicKeyInfo,
</span></span><span class=line><span class=cl>        issuerUniqueID  <span class=o>[</span>1<span class=o>]</span>  IMPLICIT UniqueIdentifier OPTIONAL,
</span></span><span class=line><span class=cl>                             -- If present, version MUST be v2 or v3
</span></span><span class=line><span class=cl>        subjectUniqueID <span class=o>[</span>2<span class=o>]</span>  IMPLICIT UniqueIdentifier OPTIONAL,
</span></span><span class=line><span class=cl>                             -- If present, version MUST be v2 or v3
</span></span><span class=line><span class=cl>        extensions      <span class=o>[</span>3<span class=o>]</span>  EXPLICIT Extensions OPTIONAL
</span></span><span class=line><span class=cl>                             -- If present, version MUST be v3
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>AlgorithmIdentifier  ::<span class=o>=</span>  SEQUENCE  <span class=o>{</span>
</span></span><span class=line><span class=cl>        algorithm               OBJECT IDENTIFIER,
</span></span><span class=line><span class=cl>        parameters              ANY DEFINED BY algorithm OPTIONAL  <span class=o>}</span>
</span></span></code></pre></div><p>Just to get a glimpse of how this data is structured, it&rsquo;s probably a good time
to take a look at the super helpful ASN.1 decoder by
<a href=https://github.com/lapo-luchini>Lapo Luchini</a>.</p><ul><li><p>Download a sample google certificate in PEM format from
<a href=https://raw.githubusercontent.com/google/certificate-transparency/master/test/testdata/google-cert.pem>here</a></p></li><li><p>Upload the file on <a href=https://lapo.it/asn1js>ASN.1 JavaScript decoder</a> and
observe the hierarchy</p><p><img alt="Certificate sequence" loading=lazy src=%7B%7Bsite.baseurl%7D%7D%7B%7Bpage.imgdir%7D%7Dsequence_hierarchy.png title="Hierarchy of SEQUENCES in x.509 Certificates"></p></li></ul><p>The top level <em>SEQUENCE</em> has 3 fields (<em>SEQUENCE</em>, <em>SEQUENCE</em>, <em>BIT STRING</em>)
which corresponds to <em>tbsCertificate</em>, <em>signatureAlgorithm</em> and
<em>signatureValue</em> respectively.</p><p>In this certificate:</p><ul><li><p><em>TBSCertificate</em> lives at offset 4</p><p><img alt="TBSCertificate offset" loading=lazy src=%7B%7Bsite.baseurl%7D%7D%7B%7Bpage.imgdir%7D%7DTBSCertificate_offset.png title="TBSCertificate offset"></p></li><li><p><em>AlgorithmIdentifier</em> lives at offset 1377</p><p><img alt="AlgorithmIdentifier offset" loading=lazy src=%7B%7Bsite.baseurl%7D%7D%7B%7Bpage.imgdir%7D%7DAlgorithmIdentifier_offset.png title="AlgorithmIdentifier offset"></p></li><li><p><em>signatureValue</em> lives at offset 1392</p><p><img alt="signatureValue offset" loading=lazy src=%7B%7Bsite.baseurl%7D%7D%7B%7Bpage.imgdir%7D%7DsignatureValue_offset.png title="signatureValue offset"></p></li></ul><blockquote><p>You can confirm the same using <code>openssl asn1parse</code> tool as well (Shown later
in this article)</p></blockquote><p>In order to verify that a certificate was signed by a specific CA, we would
need to possess the following:</p><ul><li>Public key of the CA (issuer)</li><li>Signature and Algorithm used to generate the signature</li></ul><h3 id=verifying-servers-public-key>Verifying server&rsquo;s public key<a hidden class=anchor aria-hidden=true href=#verifying-servers-public-key>#</a></h3><ol><li><p>Download the server&rsquo;s certificates to <code>/tmp</code> in PEM format.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl s_client -connect stackoverflow.com:443 -showcerts 2&gt;/dev/null &lt;/dev/null <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=p>|</span> sed -n <span class=s1>&#39;/-----BEGIN/,/-----END/p&#39;</span> &gt; /tmp/stackoverflow-certs.crt
</span></span></code></pre></div><p>Command options:</p><p><code>s_client</code> : Implements a generic SSL/TLS client which connects to a remote
host using SSL/TLS</p><p><code>-connect</code>: Specifies the host and optional port to connect to</p><p><code>-showcerts</code>: Displays the server certificate list as sent by the server</p><p><code>2>/dev/null</code>: redirects stderr to <code>/dev/null</code></p><p><code>&lt; /dev/null</code>: instantly send EOF to the program, so that it doesn&rsquo;t wait
for input</p><blockquote><p><code>/dev/null</code>is a special file that discards all data written to it, but
reports that the write operation succeeded</p></blockquote><p><code>sed</code>: stream editor for filtering and transforming text</p><p><code>-n</code>: suppress automatic printing of pattern space</p><blockquote><p>PEM (Privacy Enhanced Mail) is nothing more than a base64-encoded DER
(Distinguished Encoding Rules)</p></blockquote><p><strong>[Q]</strong> <em><strong>I thought a server has one certificate, what are these other certificates
that we&rsquo;re downloading?</strong></em></p><p><strong>[A]</strong> You are right, server always needs to show just one certificate. The other
certificates are the intermediary and probably root CA certificates. We need
those to get the intermediary public keys (Issuer&rsquo;s public key)</p><p>The above <em>openssl</em> command creates a file in this format:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat /tmp/stackoverflow-certs.crt 
</span></span><span class=line><span class=cl>-----BEGIN CERTIFICATE-----
</span></span><span class=line><span class=cl>MIIIPDCCBySgAwIBAgIQB2XGTnTlkdaAOcoqhHVj8DANBgkqhkiG9w0BAQsFADBw
</span></span><span class=line><span class=cl>MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>aVnw9vahqf7nKHHcC2VRTUgkQfn9yDmmBOo0nQ8Xgfpd65/PaxVfBnuKfEkXBfpM
</span></span><span class=line><span class=cl>-----END CERTIFICATE-----
</span></span><span class=line><span class=cl>-----BEGIN CERTIFICATE-----
</span></span><span class=line><span class=cl>MIIEsTCCA5mgAwIBAgIQBOHnpNxc8vNtwCtCuF0VnzANBgkqhkiG9w0BAQsFADBs
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>/D6q1UEL2tU2ob8cbkdJf17ZSHwD2f2LSaCYJkJA69aSEaRkCldUxPUd1gJea6zu
</span></span><span class=line><span class=cl>xICaEnL6VpPX/78whQYwvwt/Tv9XBZ0k7YXDK/umdaisLRbvfXknsuvCnQsH6qqF
</span></span><span class=line><span class=cl>0wGjIChBWUMo0oHjqvbsezt3tkBigAVBRQHvFwY+3sAzm2fTYS5yh+Rp/BIAV0Ae
</span></span><span class=line><span class=cl><span class=nv>cPUeybQ</span><span class=o>=</span>
</span></span><span class=line><span class=cl>-----END CERTIFICATE-----
</span></span></code></pre></div><p>There&rsquo;s a <code>bash</code> one-liner magic that can extract certificates in their own files:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl s_client -showcerts -verify <span class=m>5</span> -connect stackoverflow.com:443 &lt; /dev/null <span class=p>|</span> awk <span class=s1>&#39;/BEGIN/,/END/{ if(/BEGIN/){a++}; out=&#34;cert&#34;a&#34;.crt&#34;; print &gt;out}&#39;</span> <span class=o>&amp;&amp;</span> <span class=k>for</span> cert in *.crt<span class=p>;</span> <span class=k>do</span> <span class=nv>newname</span><span class=o>=</span><span class=k>$(</span>openssl x509 -noout -subject -in <span class=nv>$cert</span> <span class=p>|</span> sed -n <span class=s1>&#39;s/^.*CN=\(.*\)$/\1/; s/[ ,.*]/_/g; s/__/_/g; s/^_//g;p&#39;</span><span class=k>)</span>.pem<span class=p>;</span> mv <span class=nv>$cert</span> <span class=nv>$newname</span><span class=p>;</span> <span class=k>done</span>
</span></span></code></pre></div><p>Command credits: <a href=https://unix.stackexchange.com/a/487546>stackoverflow.com</a>
The above command will create the following for <code>stackoverflow.com</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl s_client -showcerts -verify <span class=m>5</span> -connect stackoverflow.com:443 &lt; /dev/null <span class=p>|</span> awk <span class=s1>&#39;/BEGIN/,/END/{ if(/BEGIN/){a++}; out=&#34;cert&#34;a&#34;.crt&#34;; print &gt;out}&#39;</span> <span class=o>&amp;&amp;</span> <span class=k>for</span> cert in *.crt<span class=p>;</span> <span class=k>do</span> <span class=nv>newname</span><span class=o>=</span><span class=k>$(</span>openssl x509 -noout -subject -in <span class=nv>$cert</span> <span class=p>|</span> sed -n <span class=s1>&#39;s/^.*CN=\(.*\)$/\1/; s/[ ,.*]/_/g; s/__/_/g; s/^_//g;p&#39;</span><span class=k>)</span>.pem<span class=p>;</span> mv <span class=nv>$cert</span> <span class=nv>$newname</span><span class=p>;</span> <span class=k>done</span>
</span></span><span class=line><span class=cl>verify depth is <span class=m>5</span>
</span></span><span class=line><span class=cl><span class=nv>depth</span><span class=o>=</span><span class=m>1</span> <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> DigiCert Inc, <span class=nv>OU</span> <span class=o>=</span> www.digicert.com, <span class=nv>CN</span> <span class=o>=</span> DigiCert SHA2 High Assurance Server CA
</span></span><span class=line><span class=cl>verify error:num<span class=o>=</span>20:unable to get <span class=nb>local</span> issuer certificate
</span></span><span class=line><span class=cl>verify <span class=k>return</span>:1
</span></span><span class=line><span class=cl><span class=nv>depth</span><span class=o>=</span><span class=m>1</span> <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>O</span> <span class=o>=</span> DigiCert Inc, <span class=nv>OU</span> <span class=o>=</span> www.digicert.com, <span class=nv>CN</span> <span class=o>=</span> DigiCert SHA2 High Assurance Server CA
</span></span><span class=line><span class=cl>verify error:num<span class=o>=</span>27:certificate not trusted
</span></span><span class=line><span class=cl>verify <span class=k>return</span>:1
</span></span><span class=line><span class=cl><span class=nv>depth</span><span class=o>=</span><span class=m>0</span> <span class=nv>C</span> <span class=o>=</span> US, <span class=nv>ST</span> <span class=o>=</span> NY, <span class=nv>L</span> <span class=o>=</span> New York, <span class=nv>O</span> <span class=o>=</span> <span class=s2>&#34;Stack Exchange, Inc.&#34;</span>, <span class=nv>CN</span> <span class=o>=</span> *.stackexchange.com
</span></span><span class=line><span class=cl>verify <span class=k>return</span>:1
</span></span><span class=line><span class=cl>poll error
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ ls -la
</span></span><span class=line><span class=cl>total <span class=m>16</span>
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>4</span> &lt;username&gt;  &lt;groupname&gt;   <span class=m>128</span> Mar <span class=m>11</span> 13:22 .
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>16</span> &lt;username&gt;  &lt;groupname&gt;   <span class=m>512</span> Mar <span class=m>11</span> 13:22 ..
</span></span><span class=line><span class=cl>-rw-r--r--   <span class=m>1</span> &lt;username&gt;  &lt;groupname&gt;  <span class=m>1688</span> Mar <span class=m>11</span> 13:22 DigiCert_SHA2_High_Assurance_Server_CA.pem
</span></span><span class=line><span class=cl>-rw-r--r--   <span class=m>1</span> &lt;username&gt;  &lt;groupname&gt;  <span class=m>2914</span> Mar <span class=m>11</span> 13:22 stackexchange_com.pem
</span></span></code></pre></div><p><strong>OR</strong></p><p>If you&rsquo;re uncomfortable using that one-liner, that&rsquo;s fine too. 2 more steps
and we will get the same output.</p><ul><li><p>Download all the certificates offered by server to a file
<code>/tmp/stackoverflow-certs.crt</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl s_client -connect stackoverflow.com:443 -showcerts 2&gt;/dev/null <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>&lt;/dev/null <span class=p>|</span> sed -n <span class=s1>&#39;/-----BEGIN/,/-----END/p&#39;</span> &gt; /tmp/stackoverflow-certs.crt
</span></span></code></pre></div><blockquote><p><code>*.crt</code> is just an extension to identify it as certificate but the file
is of PEM type</p></blockquote><p>Just copy the contents between <code>-----BEGIN CERTIFICATE-----</code> and
<code>-----END CERTIFICATE-----</code>(including these delimiters) into their own
files. In this case, I have 2 sections with those delimiters and hence I
will create 2 files</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ls -la stackoverflow*
</span></span><span class=line><span class=cl>-rw-rw-r-- <span class=m>1</span> &lt;username&gt;  &lt;groupname&gt; <span class=m>1688</span> Mar <span class=m>11</span> 13:28 stackoverflow.1.crt
</span></span><span class=line><span class=cl>-rw-rw-r-- <span class=m>1</span> &lt;username&gt;  &lt;groupname&gt; <span class=m>2914</span> Mar <span class=m>11</span> 13:29 stackoverflow.2.crt
</span></span><span class=line><span class=cl>-rw-rw-r-- <span class=m>1</span> &lt;username&gt;  &lt;groupname&gt; <span class=m>4602</span> Mar <span class=m>11</span> 12:03 stackoverflow-certs.crt
</span></span></code></pre></div></li><li><p>Look for the subject names and rename the certificates for easy
identification</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl x509 -in stackoverflow.1.crt -subject -noout
</span></span><span class=line><span class=cl><span class=nv>subject</span><span class=o>=</span> /C<span class=o>=</span>US/O<span class=o>=</span>DigiCert Inc/OU<span class=o>=</span>www.digicert.com/CN<span class=o>=</span>DigiCert SHA2 High Assurance Server CA
</span></span><span class=line><span class=cl>$ openssl x509 -in stackoverflow.2.crt -subject -noout
</span></span><span class=line><span class=cl><span class=nv>subject</span><span class=o>=</span> /C<span class=o>=</span>US/ST<span class=o>=</span>NY/L<span class=o>=</span>New York/O<span class=o>=</span>Stack Exchange, Inc./CN<span class=o>=</span>*.stackexchange.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ mv stackoverflow.1.crt DigiCert_SHA2_High_Assurance_Server_CA.crt
</span></span><span class=line><span class=cl>$ mv stackoverflow.2.crt stackexchange.crt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ ls -la *.crt
</span></span><span class=line><span class=cl>-rw-rw-r--  <span class=m>1</span> &lt;username&gt;  &lt;groupname&gt;  <span class=m>1688</span> Mar <span class=m>11</span> 13:28 DigiCert_SHA2_High_Assurance_Server_CA.crt
</span></span><span class=line><span class=cl>-rw-rw-r--  <span class=m>1</span> &lt;username&gt;  &lt;groupname&gt;  <span class=m>2914</span> Mar <span class=m>11</span> 13:29 stackexchange.crt
</span></span><span class=line><span class=cl>-rw-rw-r-- <span class=m>1</span> &lt;username&gt;  &lt;groupname&gt; <span class=m>4602</span> Mar <span class=m>11</span> 12:03 stackoverflow-certs.crt
</span></span></code></pre></div></li></ul><blockquote><p>FYI: You can also do this process in GUI but with the ever changing UI
landscapes and increasing number of browser options, it&rsquo;s just hard to
keep an article up-to-date with those changes and ways to download
certificates from a website.</p></blockquote></li><li><p>Make sure you have the issuer certificate of <code>stackoverflow.com</code> certificate</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl x509 -in stackexchange.crt -noout -issuer
</span></span><span class=line><span class=cl><span class=nv>issuer</span><span class=o>=</span> /C<span class=o>=</span>US/O<span class=o>=</span>DigiCert Inc/OU<span class=o>=</span>www.digicert.com/CN<span class=o>=</span>DigiCert SHA2 High Assurance Server CA
</span></span></code></pre></div><p>The issuer is <code>DigiCert SHA2 High Assurance Server CA</code> and we have issuer&rsquo;s
certificate <code>DigiCert_SHA2_High_Assurance_Server_CA.crt</code> which has issuer&rsquo;s public key</p></li><li><p>Obtain Issuer&rsquo;s public key</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl x509 -in DigiCert_SHA2_High_Assurance_Server_CA.crt -noout <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -pubkey &gt; issuer-pub.pem
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ cat issuer-pub.pem 
</span></span><span class=line><span class=cl>-----BEGIN PUBLIC KEY-----
</span></span><span class=line><span class=cl>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtuAvwiQGyG0EX9fvCmQG
</span></span><span class=line><span class=cl>sn0iJmUWrkJAm87cn592Bz7DMFWHGblPlA5alB9VVrTCAiqv0JjuC0DXxNA7csgU
</span></span><span class=line><span class=cl>nu+QsRGprtLIuEM62QsL1dWV9UCvyB3tTZxfV7eGUGiZ9Yra0scFH6iXydyksYKE
</span></span><span class=line><span class=cl>LcatpZzHGYKmhQ9eRFgqN4/9NfELCCcyWvW7i56kvVHQJ+LdO0IzowUoxLsozJqs
</span></span><span class=line><span class=cl>KyMNeMZ75l5xt0o+CPuBtxYWoZ0jEk3l15IIrHWknLrNF7IeRDVlf1MlOdEcCppj
</span></span><span class=line><span class=cl>GxmSdGgKN8LCUkjLOVqituFdwd2gILghopMmbxRKIUHH7W2b8kgv8wP1omiSUy9e
</span></span><span class=line><span class=cl>4wIDAQAB
</span></span><span class=line><span class=cl>-----END PUBLIC KEY-----
</span></span></code></pre></div><p>Where,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>x509: display certificate information, convert certificates to 
</span></span><span class=line><span class=cl>     various forms, sign certificate requests or edit certificate trust 
</span></span><span class=line><span class=cl>     settings
</span></span><span class=line><span class=cl>-in: input filename to <span class=nb>read</span> a certificate from
</span></span><span class=line><span class=cl>-noout: prevents output of the encoded version of the certificate
</span></span><span class=line><span class=cl>-pubkey: Outputs the certificate<span class=se>\&#39;</span>s SubjectPublicKeyInfo block in PEM format
</span></span></code></pre></div></li><li><p>Get the signature of certificate in binary format</p><p>The default behavior of the following command is to print all fields</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl x509 -in stackexchange.crt -noout -text
</span></span></code></pre></div><p>However, there are command line options to specify which fields should be
excluded while printing</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl x509 -in stackexchange.crt -text -noout -certopt ca_default <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -certopt no_validity -certopt no_serial -certopt no_subject <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -certopt no_extensions -certopt no_signame
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Signature Algorithm: sha256WithRSAEncryption
</span></span><span class=line><span class=cl>         00:93:ce:f7:ff:ed:90:b3:02:9f:25:24:27:fa:26:5e:65:cf:
</span></span><span class=line><span class=cl>         2e:88:68:3d:f6:99:9d:d3:4f:04:d9:c9:86:12:ba:8d:cc:f7:
</span></span><span class=line><span class=cl>         25:2b:d2:0d:6c:f8:f0:c6:5f:73:22:04:dc:5e:91:7f:52:d0:
</span></span><span class=line><span class=cl>         55:55:2d:59:ed:7a:3c:de:a7:ec:18:c3:dd:33:36:2d:dc:5f:
</span></span><span class=line><span class=cl>         a1:42:94:18:2e:19:46:17:ee:49:7f:6c:7a:65:bd:73:8d:3f:
</span></span><span class=line><span class=cl>         da:33:71:8c:74:68:be:e8:e3:d5:f9:81:e5:ff:08:14:7b:8e:
</span></span><span class=line><span class=cl>         4d:ea:44:6e:0d:99:d5:2f:5e:bb:f9:6d:e5:da:70:fe:99:28:
</span></span><span class=line><span class=cl>         4e:ff:bc:6a:c0:78:99:bb:3d:06:1f:20:47:46:9e:62:e3:76:
</span></span><span class=line><span class=cl>         e5:1f:4b:e0:eb:bb:09:f2:0b:8d:f3:5a:5a:a6:ea:58:da:fe:
</span></span><span class=line><span class=cl>         fc:15:cb:d1:f2:3d:04:2d:f8:32:7a:1b:56:a6:31:77:bf:32:
</span></span><span class=line><span class=cl>         92:ab:fa:d8:da:c3:17:4d:8c:d2:3e:a3:1e:92:cb:1e:1c:d8:
</span></span><span class=line><span class=cl>         52:31:85:3a:5b:0f:61:f6:9c:8c:69:59:f0:f6:f6:a1:a9:fe:
</span></span><span class=line><span class=cl>         e7:28:71:dc:0b:65:51:4d:48:24:41:f9:fd:c8:39:a6:04:ea:
</span></span><span class=line><span class=cl>         34:9d:0f:17:81:fa:5d:eb:9f:cf:6b:15:5f:06:7b:8a:7c:49:
</span></span><span class=line><span class=cl>         17:05:fa:4c
</span></span></code></pre></div><p>Where,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>x509: display certificate information, convert certificates to various forms, sign certificate requests or edit 		
</span></span><span class=line><span class=cl>	  certificate trust settings
</span></span><span class=line><span class=cl>-in: input filename to <span class=nb>read</span> a certificate from
</span></span><span class=line><span class=cl>-noout: prevents output of the encoded version of the certificate
</span></span><span class=line><span class=cl>-text: Prints out the certificate in text form. Full details are output including the public key, signature algorithms, 
</span></span><span class=line><span class=cl>	   issuer and subject names, serial number any extensions present and any trust settings
</span></span><span class=line><span class=cl>-certopt: Customise the output format used with -text
</span></span></code></pre></div><p>The output tells us that the certificate was hashed using<code>SHA256</code> . However,
the output you see is in hex and is separated by <code>:</code>. Let&rsquo;s remove the first
line, colon separator and spaces to get just the hex part</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nv>SIGNATURE_HEX</span><span class=o>=</span><span class=k>$(</span>openssl x509 -in stackexchange.crt -text -noout -certopt ca_default -certopt no_validity -certopt no_serial -certopt no_subject -certopt no_extensions -certopt no_signame <span class=p>|</span> grep -v <span class=s1>&#39;Signature Algorithm&#39;</span> <span class=p>|</span> tr -d <span class=s1>&#39;[:space:]:&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=nv>$SIGNATURE_HEX</span> 
</span></span><span class=line><span class=cl>0093cef7ffed90b3029f252427fa265e65cf2e88683df6999dd34f04d9c98612ba8dccf7252bd20d6cf8f0c65f732204dc5e917f52d055552d59ed7a3cdea7ec18c3dd33362ddc5fa14294182e194617ee497f6c7a65bd738d3fda33718c7468bee8e3d5f981e5ff08147b8e4dea446e0d99d52f5ebbf96de5da70fe99284effbc6ac07899bb3d061f2047469e62e376e51f4be0ebbb09f20b8df35a5aa6ea58dafefc15cbd1f23d042df8327a1b56a63177bf3292abfad8dac3174d8cd23ea31e92cb1e1cd85231853a5b0f61f69c8c6959f0f6f6a1a9fee72871dc0b65514d482441f9fdc839a604ea349d0f1781fa5deb9fcf6b155f067b8a7c491705fa4c
</span></span></code></pre></div><p>Convert the signature to binary</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=si>${</span><span class=nv>SIGNATURE_HEX</span><span class=si>}</span> <span class=p>|</span> xxd -r -p &gt; stackexchange-signature.bin
</span></span></code></pre></div><p>Where,</p><p><code>xxd</code>: makes a hexdump or does the reverse</p><p><code>-r</code>: convert hexdump into binary.</p><p><code>-p</code>: plain hexdump style</p><p>We need to use the combination <code>-r</code> <code>-p</code> to read plain hexadecimal dumps
without line number information and without a particular column layout.</p><p><strong>OR</strong></p><p>If you prefer a straightforward command-line to obtain your signature in binary:</p><ul><li><p>Find out the offset where RSA signature lives in the certificate:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl asn1parse -in stackexchange.crt
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl> 1836:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>  <span class=m>13</span> cons: SEQUENCE          
</span></span><span class=line><span class=cl> 1838:d<span class=o>=</span><span class=m>2</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>9</span> prim: OBJECT            :sha256WithRSAEncryption
</span></span><span class=line><span class=cl> 1849:d<span class=o>=</span><span class=m>2</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>0</span> prim: NULL              
</span></span><span class=line><span class=cl> 1851:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span> <span class=m>257</span> prim: BIT STRING
</span></span></code></pre></div></li><li><p>You can also use <a href=https://lapo.it/asn1js>https://lapo.it/asn1js</a> to verify where your BIT STRING starts
<img alt="stackoverflow signature offset image" loading=lazy src=%7B%7Bsite.baseurl%7D%7D%7B%7Bpage.imgdir%7D%7Dso_signature.png title="signature offset"></p></li><li><p>In my example, the signature begins at an offset of <code>1851</code>. There is no
other section/content below it. So you can safely consume everything from
offset <code>1851</code> and it will be the signature bytes</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl asn1parse -in stackexchange.crt -strparse <span class=m>1851</span> -out stackexchange-signature.bin
</span></span><span class=line><span class=cl>Error in encoding
</span></span><span class=line><span class=cl>140545980245696:error:0D07207B:asn1 encoding routines:ASN1_get_object:header too long:asn1_lib.c:157:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ file stackexchange-signature.bin 
</span></span><span class=line><span class=cl>stackexchange-signature.bin: data
</span></span></code></pre></div><p>I&rsquo;ve no idea why that throws up that encoding error but the signature dump
is successful.</p></li></ul></li><li><p>Use issuer&rsquo;s public key (Remember the issuer signed the server certificate
using the corresponding private key) to decrypt the signature.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl rsautl -verify -inkey issuer-pub.pem -in stackexchange-signature.bin -pubin &gt; stackexchange-signature-decrypted.bin
</span></span></code></pre></div><p>Where,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rsautl: <span class=nb>command</span> can be used to sign, verify, encrypt and decrypt data using the RSA algorithm
</span></span><span class=line><span class=cl>-verify: verify the input data and output the recovered data
</span></span><span class=line><span class=cl>-inkey: the input key file
</span></span><span class=line><span class=cl>-in: input filename to <span class=nb>read</span> data from
</span></span><span class=line><span class=cl>-pubin: input file is an RSA public key
</span></span></code></pre></div></li><li><p>The decrypted signature is in binary again. The decrypted signature also
contains the signature Algorithm and other details in DER format. So, use
<code>asn1parse</code> to find out the decrypted hash</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl asn1parse -inform DER -in stackexchange-signature-decrypted.bin 
</span></span><span class=line><span class=cl>    0:d<span class=o>=</span><span class=m>0</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>  <span class=m>49</span> cons: SEQUENCE          
</span></span><span class=line><span class=cl>    2:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>  <span class=m>13</span> cons: SEQUENCE          
</span></span><span class=line><span class=cl>    4:d<span class=o>=</span><span class=m>2</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>9</span> prim: OBJECT            :sha256
</span></span><span class=line><span class=cl>   15:d<span class=o>=</span><span class=m>2</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>0</span> prim: NULL              
</span></span><span class=line><span class=cl>   17:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>  <span class=m>32</span> prim: OCTET STRING      <span class=o>[</span>HEX DUMP<span class=o>]</span>:CACF0060E3899C13F5758307C2050FCA8BB575F8760CCD80A99402A51B193AF1
</span></span></code></pre></div><p>Where,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>asn1parse: diagnostic utility that can parse ASN.1 structures
</span></span><span class=line><span class=cl>-inform: the input format. DER is binary format and PEM <span class=o>(</span>the default<span class=o>)</span> is base64 encoded
</span></span><span class=line><span class=cl>-in: input file
</span></span></code></pre></div><p>So the hash of certificate body is
<code>CACF0060E3899C13F5758307C2050FCA8BB575F8760CCD80A99402A51B193AF1</code>. Make a
note of this</p></li><li><p>Calculate the hash of the certificate body (excluding the RSA signature part)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Extract the body part of certificate without RSA signature part</span>
</span></span><span class=line><span class=cl>$ openssl asn1parse -in stackexchange.crt -strparse <span class=m>4</span> -out cert-body.bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Calculate the hash of certificate body</span>
</span></span><span class=line><span class=cl>$ openssl dgst -sha256 cert-body.bin
</span></span><span class=line><span class=cl>SHA256<span class=o>(</span>cert-body.bin<span class=o>)=</span> cacf0060e3899c13f5758307c2050fca8bb575f8760ccd80a99402a51b193af1
</span></span></code></pre></div><p>Where,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>asn1parse: diagnostic utility that can parse ASN.1 structures
</span></span><span class=line><span class=cl>-in: input file
</span></span><span class=line><span class=cl>-strparse: parse the contents octets of the ASN.1 object starting at specified offset
</span></span><span class=line><span class=cl>-out: output file to place the DER encoded data into
</span></span></code></pre></div><p><em><strong>Why did we use offset 4?</strong></em><br>We used <code>4</code> because the certificate body is at offset <code>4</code>. How do we know?
<img alt="stackoverflow certificate body offset image" loading=lazy src=%7B%7Bsite.baseurl%7D%7D%7B%7Bpage.imgdir%7D%7Dso-body-offset.png title="Stackoverflow certificate body offset"></p></li><li><p>We can see that the hash of body
<code>cacf0060e3899c13f5758307c2050fca8bb575f8760ccd80a99402a51b193af1</code> matches
the decrypted hash</p><p>This confirms that the contents of the certificate were not tampered and the
issuer has really signed this certificate with their private key.</p></li></ol><h3 id=faq>FAQ<a hidden class=anchor aria-hidden=true href=#faq>#</a></h3><p><strong>[Q] Let&rsquo;s say the website delivered a fake self signed certificate as issuer
certificate, is there a way to ensure we&rsquo;re not being cheated?<br></strong></p><p><strong>[A]</strong> Sure, check the issuer in your server&rsquo;s certificate and look up the
Issuer on Google. For example, in this example, this is the issuer
information from Server&rsquo;s certificate:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl x509 -in stackexchange.crt -noout -issuer
</span></span><span class=line><span class=cl><span class=nv>issuer</span><span class=o>=</span> /C<span class=o>=</span>US/O<span class=o>=</span>DigiCert Inc/OU<span class=o>=</span>www.digicert.com/CN<span class=o>=</span>DigiCert SHA2 High Assurance Server CA
</span></span></code></pre></div><p>If I search for <code>"DigiCert SHA2 High Assurance Server CA"</code>. I can find a list
of certificates listed on the official website of
<a href=https://www.digicert.com/digicert-root-certificates.htm>Digicert</a></p><p>Scroll down to the section that shows our listed certificate:</p><table><thead><tr><th>Certificate Name</th><th>Information</th></tr></thead><tbody><tr><td><strong>DigiCert SHA2 High Assurance Server CA</strong></td><td>Issuer: DigiCert High Assurance EV Root CA<br>Valid until: 22/Oct/2028<br>Serial #: 04:E1:E7:A4:DC:5C:F2:F3:6D:C0:2B:42:B8:5D:15:9F<br>Thumbprint: A031C46782E6E6C662C2C87C76DA9AA62CCABD8E<br><a href=https://dl.cacerts.digicert.com/DigiCertSHA2HighAssuranceServerCA.crt>Download</a></td></tr></tbody></table><p>The <em>thumbprint</em> published by Digicert is <em>160 bits</em> and hence I believe it&rsquo;s a
<em>SHA-1</em> hash.</p><p>Let&rsquo;s create a <em>SHA-1</em> hash of the Digicert certificate that we received from
the server</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl x509 -noout -fingerprint -sha1 -inform pem -in DigiCert_SHA2_High_Assurance_Server_CA.crt 
</span></span><span class=line><span class=cl>SHA1 <span class=nv>Fingerprint</span><span class=o>=</span>A0:31:C4:67:82:E6:E6:C6:62:C2:C8:7C:76:DA:9A:A6:2C:CA:BD:8E
</span></span></code></pre></div><p>Now, we can be sure that the server didn&rsquo;t produce some fake certificate and
signature since the certificate matches the certificate published by official
Digicert website.</p><p><strong>[Q] Is there a simpler way of verifying the signature using <code>openssl</code>?</strong><br></p><p><strong>[A]</strong> Yes. We can let <code>openssl</code> do the verification for us:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl dgst -sha256 -verify issuer-pub.pem -signature stackexchange-signature.bin cert-body.bin 
</span></span><span class=line><span class=cl>Verified OK
</span></span></code></pre></div><p>Where,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl dgst <span class=o>[</span>-digest<span class=o>]</span> <span class=o>[</span>-help<span class=o>]</span> <span class=o>[</span>-c<span class=o>]</span> <span class=o>[</span>-d<span class=o>]</span> <span class=o>[</span>-hex<span class=o>]</span> <span class=o>[</span>-binary<span class=o>]</span> <span class=o>[</span>-r<span class=o>]</span> <span class=o>[</span>-out filename<span class=o>]</span> <span class=o>[</span>-sign filename<span class=o>]</span> <span class=o>[</span>-keyform arg<span class=o>]</span> <span class=o>[</span>-passin arg<span class=o>]</span> <span class=o>[</span>-verify filename<span class=o>]</span> <span class=o>[</span>-prverify filename<span class=o>]</span> <span class=o>[</span>-signature filename<span class=o>]</span> <span class=o>[</span>-hmac key<span class=o>]</span> <span class=o>[</span>-fips-fingerprint<span class=o>]</span> <span class=o>[</span>-rand file...<span class=o>]</span> <span class=o>[</span>-engine id<span class=o>]</span> <span class=o>[</span>-engine_impl<span class=o>]</span> <span class=o>[</span>file...<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-verify file    verify a signature using public key in file
</span></span><span class=line><span class=cl>-signature file signature to verify
</span></span><span class=line><span class=cl>-sha256         to use the sha256 message digest algorithm
</span></span><span class=line><span class=cl>file			File or files to digest
</span></span></code></pre></div><p><code>openssl dgst</code> creates a <em>SHA256</em> hash of <code>cert-body.bin</code>. It decrypts the
<code>stackexchange-signature.bin</code> using <code>issuer-pub.pem</code> public key. It verifies if
the decrypted value is equal to the created hash or not.</p><p><strong>[Q] How does my browser inherently trust a CA mentioned by server?</strong><br><strong>[A]</strong> Your browser (and possibly your OS) ships with a list of trusted CAs. These
pre-installed certificates serve as trust anchors to derive all further trust
from.
More information:</p><ul><li><a href=https://wiki.mozilla.org/CA/Included_Certificates>Mozilla Included CA Certificate List</a></li><li><a href=https://www.chromium.org/Home/chromium-security/root-ca-policy>Chromium Security Root Certificate Policy</a></li><li><a href=https://support.apple.com/en-us/HT208127>Trusted root certificates in macOS High Sierra</a><blockquote><p>Please don&rsquo;t blame me if this link doesn&rsquo;t work. Documentation team at this
company has a bad habit of moving/deleting support documentation from time
to time</p></blockquote></li><li><a href=https://help.opera.com/en/latest/security-and-privacy/#securityCertificates>Security certificates in Opera</a></li></ul><p><strong>[Q] What if those pre-installed certificates expire?</strong><br><strong>[A]</strong> Root certificates do expire, but they tend to have exceptionally long
validity times (often about 20 years). In any case, your browser/OS update will
provide you fresh root certificates before the old ones expire.</p><h3 id=footnotes>Footnotes<a hidden class=anchor aria-hidden=true href=#footnotes>#</a></h3><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://en.wikipedia.org/wiki/RSA_(cryptosystem)>Rivest-Shamir-Adleman</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_Block_Chaining_(CBC)>Advanced Encryption Standard - Cipher Block Chaining</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>Diffie Hellman Key Exchange&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>Diffie Hellman&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/tls/>Tls</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/deep-dive-subjectpublickeyinfo-rsa-public-key/><span class=title>« Prev</span><br><span>Deep dive - Anatomy of a SubjectPublicKeyInfo RSA public key</span>
</a><a class=next href=http://localhost:1313/posts/demystifying-asn1-der-pem-pkcs1-pkcs8/><span class=title>Next »</span><br><span>Demystifying ASN.1, DER, PEM, PKCS1 and PKCS8</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Deep dive - Verify SSL/TLS Certificate Signature on x" href="https://x.com/intent/tweet/?text=Deep%20dive%20-%20Verify%20SSL%2fTLS%20Certificate%20Signature&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fdeep-dive-verify-tls-cert-signature%2f&amp;hashtags=tls"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Deep dive - Verify SSL/TLS Certificate Signature on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fdeep-dive-verify-tls-cert-signature%2f&amp;title=Deep%20dive%20-%20Verify%20SSL%2fTLS%20Certificate%20Signature&amp;summary=Deep%20dive%20-%20Verify%20SSL%2fTLS%20Certificate%20Signature&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fdeep-dive-verify-tls-cert-signature%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Deep dive - Verify SSL/TLS Certificate Signature on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fdeep-dive-verify-tls-cert-signature%2f&title=Deep%20dive%20-%20Verify%20SSL%2fTLS%20Certificate%20Signature"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Deep dive - Verify SSL/TLS Certificate Signature on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fdeep-dive-verify-tls-cert-signature%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Deep dive - Verify SSL/TLS Certificate Signature on whatsapp" href="https://api.whatsapp.com/send?text=Deep%20dive%20-%20Verify%20SSL%2fTLS%20Certificate%20Signature%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fdeep-dive-verify-tls-cert-signature%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Deep dive - Verify SSL/TLS Certificate Signature on telegram" href="https://telegram.me/share/url?text=Deep%20dive%20-%20Verify%20SSL%2fTLS%20Certificate%20Signature&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fdeep-dive-verify-tls-cert-signature%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Deep dive - Verify SSL/TLS Certificate Signature on ycombinator" href="https://news.ycombinator.com/submitlink?t=Deep%20dive%20-%20Verify%20SSL%2fTLS%20Certificate%20Signature&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fdeep-dive-verify-tls-cert-signature%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Learn part by part</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a><br><a href=https://www.flaticon.com/free-icons/timber title="timber icons">Timber icons created by imaginationlol - Flaticon</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>