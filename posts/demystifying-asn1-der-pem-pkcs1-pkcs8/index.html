<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Demystifying ASN.1, DER, PEM, PKCS1 and PKCS8 | Learn part by part</title>
<meta name=keywords content="first"><meta name=description content="Learn the fundamentals of ASN.1, DER, PEM, PKCS#1 and PKCS#8"><meta name=author content><link rel=canonical href=https://partbypart.github.io/posts/demystifying-asn1-der-pem-pkcs1-pkcs8/><meta name=google-site-verification content="G-MF6MC03DXC"><link crossorigin=anonymous href=/assets/css/stylesheet.8834bbfc85f85dae1fabab19c063b95ea1edb56c60989b5fd879c5084b58f9f1.css integrity="sha256-iDS7/IX4Xa4fq6sZwGO5XqHttWxgmJtf2HnFCEtY+fE=" rel="preload stylesheet" as=style><link rel=icon href=https://partbypart.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://partbypart.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://partbypart.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://partbypart.github.io/apple-touch-icon.png><link rel=mask-icon href=https://partbypart.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://partbypart.github.io/posts/demystifying-asn1-der-pem-pkcs1-pkcs8/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-MF6MC03DXC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-MF6MC03DXC")}</script><meta property="og:title" content="Demystifying ASN.1, DER, PEM, PKCS1 and PKCS8"><meta property="og:description" content="Learn the fundamentals of ASN.1, DER, PEM, PKCS#1 and PKCS#8"><meta property="og:type" content="article"><meta property="og:url" content="https://partbypart.github.io/posts/demystifying-asn1-der-pem-pkcs1-pkcs8/"><meta property="og:image" content="https://partbypart.github.io/%3Cimage%20path/url%3E"><meta property="article:section" content="posts"><meta property="og:site_name" content="Part by Part"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://partbypart.github.io/%3Cimage%20path/url%3E"><meta name=twitter:title content="Demystifying ASN.1, DER, PEM, PKCS1 and PKCS8"><meta name=twitter:description content="Learn the fundamentals of ASN.1, DER, PEM, PKCS#1 and PKCS#8"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://partbypart.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Demystifying ASN.1, DER, PEM, PKCS1 and PKCS8","item":"https://partbypart.github.io/posts/demystifying-asn1-der-pem-pkcs1-pkcs8/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Demystifying ASN.1, DER, PEM, PKCS1 and PKCS8","name":"Demystifying ASN.1, DER, PEM, PKCS1 and PKCS8","description":"Learn the fundamentals of ASN.1, DER, PEM, PKCS#1 and PKCS#8","keywords":["first"],"articleBody":"Part 1 - ASN.1 Abstract Syntax Notation One (ASN.1) is a standard interface description language for defining data structures that can be serialized and deserialized in a cross-platform way. It is a notation used to describe the structure and encoding of data elements in a standardized way. Why do we need an interface description language (IDL)? Without an IDL, components in a distributed systems may not have a language-neutral way to define interfaces and data structures to communicate and speak the same language. An IDL allows components written in various languages to communicate seamlessly without being tightly coupled to a specific programming language’s syntax. Without an IDL, different software components or systems may not be able to agree on format of data and order of data transmission. An IDL helps achieve interoperability by providing a standardized description of these interfaces, ensuring that different systems can understand and communicate with each other consistently. Without an IDL, developers have to spend time and energy on low level network protocols. IDL creates separation of concerns that provides greater maintainability and flexibility. Without an IDL, there would be no easy way to keep track of interface versions due to updates. An IDL allows for versioning of interfaces and ensures backward compatibility by providing mechanisms to handle different versions of interfaces and gracefully migrate from one version to another. It provides a way to define the format of data in a platform-independent and language-independent manner, making it essential for protocols used in networking, cryptography, and data serialization. Where is ASN.1 used? X.509 Certificates Cryptography and Public Key Infrastructure (PKI) LDAP (Lightweight Directory Access Protocol) SNMP (Simple Network Management Protocol) ITU-T (International Telecommunication Union - Telecommunication Standardization Sector) and so on. In essence, ASN.1 plays a crucial role in defining data structures and encoding formats for a wide range of applications in telecommunications, networking, cryptography, and data serialization, enabling interoperability and standardized communication across different systems and technologies.\nWhat does ASN.1 look like? Imagine we want to represent the following information about a student: their name and age. Here’s how we can express this using ASN.1:\nStudentInfo ::= SEQUENCE { name UTF8String, age Age } Age ::= INTEGER (13..18) Where,\nStudentInfo is the name of our data structure, similar to a “class” or “type” or “struct” in programming. SEQUENCE indicates that the data structure contains a sequence of fields. name is a field of type UTF8String, which represents the student’s name using Unicode characters. age is a field of type Age, which represents the student’s age as another data structure called Age that represents a non-negative integer between 13 and 18. Verifying RSA public and private key ASN.1 syntax RSA public and private key syntax can be verified using openssl asn1parse command. It should match the syntax presented in the previous part.\nVerifying PKCS #1 RSA public key syntax $ grep \"BEGIN\\|END\" id_rsa_2048_pkcs1.pem.pub -----BEGIN RSA PUBLIC KEY----- -----END RSA PUBLIC KEY----- $ openssl asn1parse -in id_rsa_2048_pkcs1.pem.pub -i 0:d=0 hl=4 l= 266 cons: SEQUENCE 4:d=1 hl=4 l= 257 prim: INTEGER :AEF71D4B9858D2BC...EAC15 265:d=1 hl=2 l= 3 prim: INTEGER :010001 Verifying RSA public key SubjectPublicKeyInfo syntax $ openssl rsa -in id_rsa_2048_pkcs1.pem.pub -RSAPublicKey_in \\ -out id_rsa_2048_subjectpublickeyinfo.pem.pub writing RSA key $ grep \"BEGIN\\|END\" id_rsa_2048_subjectpublickeyinfo.pem.pub -----BEGIN PUBLIC KEY----- -----END PUBLIC KEY----- $ openssl asn1parse -in id_rsa_2048_subjectpublickeyinfo.pem.pub -i 0:d=0 hl=4 l= 290 cons: SEQUENCE 4:d=1 hl=2 l= 13 cons: SEQUENCE 6:d=2 hl=2 l= 9 prim: OBJECT :rsaEncryption 17:d=2 hl=2 l= 0 prim: NULL 19:d=1 hl=4 l= 271 prim: BIT STRING # Drill into the BIT STRING at offset 19 $ openssl asn1parse -in id_rsa_2048_subjectpublickeyinfo.pem.pub -i -strparse 19 0:d=0 hl=4 l= 266 cons: SEQUENCE 4:d=1 hl=4 l= 257 prim: INTEGER :AEF71D4B9858D2BC...EAC15 265:d=1 hl=2 l= 3 prim: INTEGER :010001 Verify PKCS #1 RSA private key syntax $ grep \"BEGIN\\|END\" id_rsa_2048_pkcs1.pem -----BEGIN RSA PRIVATE KEY----- -----END RSA PRIVATE KEY----- $ openssl asn1parse -in id_rsa_2048_pkcs1.pem -i 0:d=0 hl=4 l=1186 cons: SEQUENCE 4:d=1 hl=2 l= 1 prim: INTEGER :00 7:d=1 hl=4 l= 257 prim: INTEGER :AEF7...EAC15 268:d=1 hl=2 l= 3 prim: INTEGER :010001 273:d=1 hl=4 l= 256 prim: INTEGER :0B64...8E01 533:d=1 hl=3 l= 129 prim: INTEGER :B8DB...B321 665:d=1 hl=3 l= 129 prim: INTEGER :F24C...0E75 797:d=1 hl=3 l= 128 prim: INTEGER :78DA...A5C1 928:d=1 hl=3 l= 128 prim: INTEGER :516C...5D2D 1059:d=1 hl=3 l= 128 prim: INTEGER :4707...F154 Verify PKCS #8 RSA private key syntax $ openssl rsa -in id_rsa_2048_pkcs1.pem -out id_rsa_2048_pkcs8.pem writing RSA key $ grep \"BEGIN\\|END\" id_rsa_2048_pkcs8.pem -----BEGIN PRIVATE KEY----- -----END PRIVATE KEY----- $ openssl asn1parse -in id_rsa_2048_pkcs8.pem -i 0:d=0 hl=4 l=1212 cons: SEQUENCE 4:d=1 hl=2 l= 1 prim: INTEGER :00 7:d=1 hl=2 l= 13 cons: SEQUENCE 9:d=2 hl=2 l= 9 prim: OBJECT :rsaEncryption 20:d=2 hl=2 l= 0 prim: NULL 22:d=1 hl=4 l=1190 prim: OCTET STRING [HEX DUMP]:3082...F154 # Drill into the OCTET STRING at offset 22 $ openssl asn1parse -in id_rsa_2048_pkcs8.pem -i -strparse 22 0:d=0 hl=4 l=1186 cons: SEQUENCE 4:d=1 hl=2 l= 1 prim: INTEGER :00 7:d=1 hl=4 l= 257 prim: INTEGER :AEF7...EAC15 268:d=1 hl=2 l= 3 prim: INTEGER :010001 273:d=1 hl=4 l= 256 prim: INTEGER :0B64...8E01 533:d=1 hl=3 l= 129 prim: INTEGER :B8DB...B321 665:d=1 hl=3 l= 129 prim: INTEGER :F24C...0E75 797:d=1 hl=3 l= 128 prim: INTEGER :78DA...A5C1 928:d=1 hl=3 l= 128 prim: INTEGER :516C...5D2D 1059:d=1 hl=3 l= 128 prim: INTEGER :4707...F154 Part 2 - DER (Distinguished Encoding Rules) What is DER? It is a specific binary encoding format that ensures consistent and unambiguous representation of data. DER is a subset of BER (Basic Encoding Rules) providing for exactly one way to encode an ASN.1 value. For example, in BER a Boolean value of true can be encoded as any of 255 non-zero byte values, while in DER there is one way to encode a boolean value of true. Why do we need DER? ASN.1 is just a notation used to specify the structure of data elements and their types. It provides a high-level description of how data should be organized. However, ASN.1 itself doesn’t dictate a specific binary encoding format for representing this structured data. This is where DER plays a critical role. DER is a binary encoding format that is derived from ASN.1. It defines precise rules for encoding data elements specified in ASN.1 into a compact and unambiguous binary format. DER ensures that the encoded data can be uniquely decoded and interpreted by different systems, making it suitable for use in various applications like cryptography and network protocols. In summary, ASN.1 is a language for specifying data structures, while DER is a specific way of encoding data according to the rules defined by ASN.1. How does DER encode data? TLV (Tag-Length-Value) encoding is a fundamental mechanism in DER for representing and structuring data. The “Tag” identifies the data type, the “Length” specifies the size of the value in bytes, and the “Value” contains the actual data. TLV ensures a standardized, self-descriptive format that allows for unambiguous decoding and interoperability Example: Suppose we want to encode a message that includes a person’s name and a short message content. Here’s how the TLV structure might look in ASN.1 notation: Message ::= SEQUENCE { personName UTF8String, messageContent OCTET STRING } Message is a SEQUENCE type that groups two fields: personName (of type UTF8String - name in UTF-8 encoding) and messageContent (of type OCTET STRING - sequence of arbitrary bytes). Now, let’s encode the data “Alice” (person’s name) and “hello” (message content) using TLV encoding in DER personName: Tag for UTF8String is 0x0C Length of “Alice” is 5 (0x05) Value is the UTF-8 encoded representation of “Alice” TLV-encoded bytes for “Alice” (person’s name): 0C 05 41 6C 69 63 65\tmessageContent: Tag for OCTET STRING is 0x04 Length of “hello” is 5 (0x05) Value is the ASCII representation of “hello” TLV-encoded bytes for “hello” (message content): 04 05 68 65 6C 6C 6F Combine both TLV-encoded parts within the SEQUENCE: SEQUENCE has a tag value of 0x30 The length of the content (data elements within the SEQUENCE) is 0x0E (14 bytes). TLV Encoded bytes for the entire sequence 30 0E 0C 05 41 6C 69 63 65 04 05 68 65 6C 6C 6F Part 3 - PEM (Privacy Enhanced Mail) PEM (Privacy-Enhanced Mail) is a widely used encoding format that originated from the email encryption and security domain. It often uses headers like -----BEGIN CERTIFICATE----- and -----END CERTIFICATE----- to mark the boundaries of the encoded data, enabling easy storage, sharing, and transport of cryptographic information in a human-readable form. Encoded ASN.1 data, which is usually binary, is often PEM-encoded (base64 encoded with header and trailer text) so that it can be transmitted as textual data Example PEM format -----BEGIN PUBLIC KEY----- MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC0EZoftiJV5Cwka0/0JpqTbi0S hBvg4USO4ZggeoRTxRLBsAm6d2L2t11GgX59jPqRBIpJDykaTazLy+hMVT8Flc+m JO40zWiadmI4RKRILwnKhI///msR4pePenSkt4ZKftJtaBRMw3JQlP2bwrHcBHGq lbSTqtiZxRAvYRxM0wIDAQAB -----END PUBLIC KEY----- Part 4 - PKCS #1 (Public Key Cryptography Standards) A set of specifications published by RSA Laboratories that provides basic definitions and recommendations for implementing the RSA algorithm. Primarily focuses on specifications related to RSA cryptography, including key pair generation, encryption, decryption, digital signatures, and other RSA-related operations. An RSA public key in PKCS #1 should be represented with the ASN.1 type RSAPublicKey: RSAPublicKey ::= SEQUENCE { modulus INTEGER, -- n publicExponent INTEGER -- e } ``` Sample PKCS #1 RSA private key without password in PEM format -----BEGIN RSA PRIVATE KEY----- MIIBPAIBAAJBAKuwRVKZBqd/i0JpUGMdnqsw1fsXhvJMf7EBVdfEuSYcxniCTQO9 sEnrpBD6I7alMl9idAnIjwYe3qnJUNs6QLMCAwEAAQJAIIrKuPs0Xa85MB9SE1db 6crZ5DvzYh3J3j0IjltFVMmz8h6BjP43++QucRE+2UKQXuZMeVR7D2Y9AgW92/sE kQIhANpj1ggcraLCFPzg0X6uhIldOJbesGhOyNrkj6iAttC3AiEAyUGCB0CCPt2G j6soRoKjHsbrrhsfpQyg+vxbvycD2+UCIQCrYYmHGCpS/YfG4w7EIWQ1AAj2rI83 bAxHavIpw8izhQIhAJgq/7WcAN6ngGaAcyNdAxjyLqClwXd55P3gcT5GsZRBAiEA jcpo7KCOxpXbbo1Z69ak/t8nnS3xyrKw1YyE9y7L06s= -----END RSA PRIVATE KEY----- Part 5 - PKCS #8 One of the family of standards called Public-Key Cryptography Standards (PKCS) created by RSA Laboratories. Describes a standard syntax for storing private key information for private keys of RSA, DSA, ECDSA, and other algorithms. Allows private keys to be encrypted using various algorithms and encryption schemes, enhancing security. Private-key information shall have ASN.1 type PrivateKeyInfo: PrivateKeyInfo ::= SEQUENCE { version Version, privateKeyAlgorithm PrivateKeyAlgorithmIdentifier, privateKey PrivateKey, attributes [0] IMPLICIT Attributes OPTIONAL } Version ::= INTEGER PrivateKeyAlgorithmIdentifier ::= AlgorithmIdentifier AlgorithmIdentifier ::= SEQUENCE { algorithm OBJECT IDENTIFIER, parameters ANY DEFINED BY algorithm OPTIONAL } PrivateKey ::= OCTET STRING Attributes ::= SET OF Attributes PrivateKey is an octet string whose contents are the value of the private key. The interpretation of the contents is defined in the registration of the private-key algorithm. For an RSA private key, for example, the contents are a BER encoding of a value of type RSAPrivateKey. Example: An RSA private key should be represented with the ASN.1 type RSAPrivateKey as specified in PKCS #1: RSAPrivateKey ::= SEQUENCE { version Version, modulus INTEGER, -- n publicExponent INTEGER, -- e privateExponent INTEGER, -- d prime1 INTEGER, -- p prime2 INTEGER, -- q exponent1 INTEGER, -- d mod (p-1) exponent2 INTEGER, -- d mod (q-1) coefficient INTEGER, -- (inverse of q) mod p otherPrimeInfos OtherPrimeInfos OPTIONAL } Sample PKCS #8 RSA private key without password in PEM format -----BEGIN PRIVATE KEY----- MIIBVgIBADANBgkqhkiG9w0BAQEFAASCAUAwggE8AgEAAkEAq7BFUpkGp3+LQmlQ Yx2eqzDV+xeG8kx/sQFV18S5JhzGeIJNA72wSeukEPojtqUyX2J0CciPBh7eqclQ 2zpAswIDAQABAkAgisq4+zRdrzkwH1ITV1vpytnkO/NiHcnePQiOW0VUybPyHoGM /jf75C5xET7ZQpBe5kx5VHsPZj0CBb3b+wSRAiEA2mPWCBytosIU/ODRfq6EiV04 lt6waE7I2uSPqIC20LcCIQDJQYIHQII+3YaPqyhGgqMexuuuGx+lDKD6/Fu/JwPb 5QIhAKthiYcYKlL9h8bjDsQhZDUACPasjzdsDEdq8inDyLOFAiEAmCr/tZwA3qeA ZoBzI10DGPIuoKXBd3nk/eBxPkaxlEECIQCNymjsoI7GldtujVnr1qT+3yedLfHK srDVjIT3LsvTqw== -----END PRIVATE KEY----- ","wordCount":"1778","inLanguage":"en","image":"https://partbypart.github.io/%3Cimage%20path/url%3E","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://partbypart.github.io/posts/demystifying-asn1-der-pem-pkcs1-pkcs8/"},"publisher":{"@type":"Organization","name":"Learn part by part","logo":{"@type":"ImageObject","url":"https://partbypart.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://partbypart.github.io/ accesskey=h title="PartByPart (Alt + H)"><img src=https://partbypart.github.io/apple-touch-icon.png alt aria-label=logo height=35>PartByPart</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://partbypart.github.io/categories/ title=CATEGORIES><span>CATEGORIES</span></a></li><li><a href=https://partbypart.github.io/tags/ title=TAGS><span>TAGS</span></a></li><li><a href=https://partbypart.github.io/archives/ title=ARCHIVES><span>ARCHIVES</span></a></li><li><a href=https://partbypart.github.io/search/ title="SEARCH (Alt + /)" accesskey=/><span>SEARCH</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://partbypart.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://partbypart.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Demystifying ASN.1, DER, PEM, PKCS1 and PKCS8</h1><div class=post-description>Learn the fundamentals of ASN.1, DER, PEM, PKCS#1 and PKCS#8</div><div class=post-meta>9 min&nbsp;·&nbsp;1778 words</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#part-1---asn1>Part 1 - ASN.1</a></li><li><a href=#part-2---der-distinguished-encoding-rules>Part 2 - DER (Distinguished Encoding Rules)</a></li><li><a href=#part-3---pem-privacy-enhanced-mail>Part 3 - PEM (Privacy Enhanced Mail)</a></li><li><a href=#part-4---pkcs-1-public-key-cryptography-standards>Part 4 - PKCS #1 (Public Key Cryptography Standards)</a></li><li><a href=#part-5---pkcs-8>Part 5 - PKCS #8</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h3 id=part-1---asn1>Part 1 - ASN.1<a hidden class=anchor aria-hidden=true href=#part-1---asn1>#</a></h3><ul><li><strong>Abstract Syntax Notation One</strong> (<strong>ASN.1</strong>) is a standard interface description language for defining data structures that can be serialized and deserialized in a cross-platform way. It is a notation used to describe the structure and encoding of data elements in a standardized way.</li></ul><h5 id=why-do-we-need-an-interface-description-language-idl>Why do we need an interface description language (IDL)?<a hidden class=anchor aria-hidden=true href=#why-do-we-need-an-interface-description-language-idl>#</a></h5><ul><li>Without an IDL, components in a distributed systems may not have a language-neutral way to define interfaces and data structures to communicate and speak the same language. An IDL allows components written in various languages to communicate seamlessly without being tightly coupled to a specific programming language&rsquo;s syntax.</li><li>Without an IDL, different software components or systems may not be able to agree on format of data and order of data transmission. An IDL helps achieve interoperability by providing a standardized description of these interfaces, ensuring that different systems can understand and communicate with each other consistently.</li><li>Without an IDL, developers have to spend time and energy on low level network protocols. IDL creates separation of concerns that provides greater maintainability and flexibility.</li><li>Without an IDL, there would be no easy way to keep track of interface versions due to updates. An IDL allows for versioning of interfaces and ensures backward compatibility by providing mechanisms to handle different versions of interfaces and gracefully migrate from one version to another.</li><li>It provides a way to define the format of data in a platform-independent and language-independent manner, making it essential for protocols used in networking, cryptography, and data serialization.</li></ul><h5 id=where-is-asn1-used>Where is ASN.1 used?<a hidden class=anchor aria-hidden=true href=#where-is-asn1-used>#</a></h5><ul><li>X.509 Certificates</li><li>Cryptography and Public Key Infrastructure (PKI)</li><li>LDAP (Lightweight Directory Access Protocol)</li><li>SNMP (Simple Network Management Protocol)</li><li>ITU-T (International Telecommunication Union - Telecommunication Standardization Sector)</li></ul><p>and so on.
In essence, ASN.1 plays a crucial role in defining data structures and encoding formats for a wide range of applications in telecommunications, networking, cryptography, and data serialization, enabling interoperability and standardized communication across different systems and technologies.</p><h5 id=what-does-asn1-look-like>What does ASN.1 look like?<a hidden class=anchor aria-hidden=true href=#what-does-asn1-look-like>#</a></h5><p>Imagine we want to represent the following information about a student: their name and age. Here&rsquo;s how we can express this using ASN.1:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>StudentInfo ::<span class=o>=</span> SEQUENCE <span class=o>{</span>
</span></span><span class=line><span class=cl>    name    UTF8String,
</span></span><span class=line><span class=cl>    age     Age
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Age ::<span class=o>=</span> INTEGER <span class=o>(</span>13..18<span class=o>)</span>
</span></span></code></pre></div><p>Where,</p><ul><li><code>StudentInfo</code> is the name of our data structure, similar to a &ldquo;<em>class</em>&rdquo; or &ldquo;<em>type</em>&rdquo; or &ldquo;<em>struct</em>&rdquo; in programming.</li><li><code>SEQUENCE</code> indicates that the data structure contains a sequence of fields.</li><li><code>name</code> is a field of type <code>UTF8String</code>, which represents the student&rsquo;s name using Unicode characters.</li><li><code>age</code> is a field of type <code>Age</code>, which represents the student&rsquo;s age as another data structure called <code>Age</code> that represents a non-negative integer between 13 and 18.</li></ul><h4 id=verifying-rsa-public-and-private-key-asn1-syntax>Verifying RSA public and private key ASN.1 syntax<a hidden class=anchor aria-hidden=true href=#verifying-rsa-public-and-private-key-asn1-syntax>#</a></h4><p>RSA public and private key syntax can be verified using <code>openssl asn1parse</code> command. It should match the syntax presented in the previous part.</p><ul><li>Verifying PKCS #1 RSA public key syntax<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ grep <span class=s2>&#34;BEGIN\|END&#34;</span> id_rsa_2048_pkcs1.pem.pub
</span></span><span class=line><span class=cl>-----BEGIN RSA PUBLIC KEY-----
</span></span><span class=line><span class=cl>-----END RSA PUBLIC KEY-----
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ openssl asn1parse -in id_rsa_2048_pkcs1.pem.pub -i
</span></span><span class=line><span class=cl>    0:d<span class=o>=</span><span class=m>0</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span> <span class=m>266</span> cons: SEQUENCE
</span></span><span class=line><span class=cl>    4:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span> <span class=m>257</span> prim:  INTEGER           :AEF71D4B9858D2BC...EAC15
</span></span><span class=line><span class=cl>  265:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>3</span> prim:  INTEGER           :010001
</span></span></code></pre></div></li><li>Verifying RSA public key <code>SubjectPublicKeyInfo</code> syntax<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl rsa  -in id_rsa_2048_pkcs1.pem.pub -RSAPublicKey_in <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-out id_rsa_2048_subjectpublickeyinfo.pem.pub
</span></span><span class=line><span class=cl>writing RSA key
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ grep <span class=s2>&#34;BEGIN\|END&#34;</span> id_rsa_2048_subjectpublickeyinfo.pem.pub
</span></span><span class=line><span class=cl>-----BEGIN PUBLIC KEY-----
</span></span><span class=line><span class=cl>-----END PUBLIC KEY-----
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ openssl asn1parse -in id_rsa_2048_subjectpublickeyinfo.pem.pub -i
</span></span><span class=line><span class=cl>    0:d<span class=o>=</span><span class=m>0</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span> <span class=m>290</span> cons: SEQUENCE
</span></span><span class=line><span class=cl>    4:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>  <span class=m>13</span> cons:  SEQUENCE
</span></span><span class=line><span class=cl>    6:d<span class=o>=</span><span class=m>2</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>9</span> prim:   OBJECT            :rsaEncryption
</span></span><span class=line><span class=cl>   17:d<span class=o>=</span><span class=m>2</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>0</span> prim:   NULL
</span></span><span class=line><span class=cl>   19:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span> <span class=m>271</span> prim:  BIT STRING
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Drill into the BIT STRING at offset 19</span>
</span></span><span class=line><span class=cl>$ openssl asn1parse -in id_rsa_2048_subjectpublickeyinfo.pem.pub -i -strparse <span class=m>19</span>
</span></span><span class=line><span class=cl>    0:d<span class=o>=</span><span class=m>0</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span> <span class=m>266</span> cons: SEQUENCE
</span></span><span class=line><span class=cl>    4:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span> <span class=m>257</span> prim:  INTEGER           :AEF71D4B9858D2BC...EAC15
</span></span><span class=line><span class=cl>  265:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>3</span> prim:  INTEGER           :010001
</span></span></code></pre></div></li><li>Verify PKCS #1 RSA private key syntax<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ grep <span class=s2>&#34;BEGIN\|END&#34;</span> id_rsa_2048_pkcs1.pem
</span></span><span class=line><span class=cl>-----BEGIN RSA PRIVATE KEY-----
</span></span><span class=line><span class=cl>-----END RSA PRIVATE KEY-----
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ openssl asn1parse -in id_rsa_2048_pkcs1.pem -i
</span></span><span class=line><span class=cl>    0:d<span class=o>=</span><span class=m>0</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span><span class=m>1186</span> cons: SEQUENCE
</span></span><span class=line><span class=cl>    4:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>1</span> prim:  INTEGER           :00
</span></span><span class=line><span class=cl>    7:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span> <span class=m>257</span> prim:  INTEGER           :AEF7...EAC15
</span></span><span class=line><span class=cl>  268:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>3</span> prim:  INTEGER           :010001
</span></span><span class=line><span class=cl>  273:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span> <span class=m>256</span> prim:  INTEGER           :0B64...8E01
</span></span><span class=line><span class=cl>  533:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>3</span> <span class=nv>l</span><span class=o>=</span> <span class=m>129</span> prim:  INTEGER           :B8DB...B321
</span></span><span class=line><span class=cl>  665:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>3</span> <span class=nv>l</span><span class=o>=</span> <span class=m>129</span> prim:  INTEGER           :F24C...0E75
</span></span><span class=line><span class=cl>  797:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>3</span> <span class=nv>l</span><span class=o>=</span> <span class=m>128</span> prim:  INTEGER           :78DA...A5C1
</span></span><span class=line><span class=cl>  928:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>3</span> <span class=nv>l</span><span class=o>=</span> <span class=m>128</span> prim:  INTEGER           :516C...5D2D
</span></span><span class=line><span class=cl> 1059:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>3</span> <span class=nv>l</span><span class=o>=</span> <span class=m>128</span> prim:  INTEGER           :4707...F154
</span></span></code></pre></div></li><li>Verify PKCS #8 RSA private key syntax<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ openssl rsa -in id_rsa_2048_pkcs1.pem -out id_rsa_2048_pkcs8.pem
</span></span><span class=line><span class=cl>writing RSA key
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ grep <span class=s2>&#34;BEGIN\|END&#34;</span> id_rsa_2048_pkcs8.pem
</span></span><span class=line><span class=cl>-----BEGIN PRIVATE KEY-----
</span></span><span class=line><span class=cl>-----END PRIVATE KEY-----
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ openssl asn1parse -in id_rsa_2048_pkcs8.pem -i
</span></span><span class=line><span class=cl>    0:d<span class=o>=</span><span class=m>0</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span><span class=m>1212</span> cons: SEQUENCE
</span></span><span class=line><span class=cl>    4:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>1</span> prim:  INTEGER           :00
</span></span><span class=line><span class=cl>    7:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>  <span class=m>13</span> cons:  SEQUENCE
</span></span><span class=line><span class=cl>    9:d<span class=o>=</span><span class=m>2</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>9</span> prim:   OBJECT            :rsaEncryption
</span></span><span class=line><span class=cl>   20:d<span class=o>=</span><span class=m>2</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>0</span> prim:   NULL
</span></span><span class=line><span class=cl>   22:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span><span class=m>1190</span> prim:  OCTET STRING      <span class=o>[</span>HEX DUMP<span class=o>]</span>:3082...F154
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Drill into the OCTET STRING at offset 22</span>
</span></span><span class=line><span class=cl>$ openssl asn1parse -in id_rsa_2048_pkcs8.pem -i -strparse <span class=m>22</span>
</span></span><span class=line><span class=cl>    0:d<span class=o>=</span><span class=m>0</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span><span class=m>1186</span> cons: SEQUENCE
</span></span><span class=line><span class=cl>    4:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>1</span> prim:  INTEGER           :00
</span></span><span class=line><span class=cl>    7:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span> <span class=m>257</span> prim:  INTEGER           :AEF7...EAC15
</span></span><span class=line><span class=cl>  268:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>2</span> <span class=nv>l</span><span class=o>=</span>   <span class=m>3</span> prim:  INTEGER           :010001
</span></span><span class=line><span class=cl>  273:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>4</span> <span class=nv>l</span><span class=o>=</span> <span class=m>256</span> prim:  INTEGER           :0B64...8E01
</span></span><span class=line><span class=cl>  533:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>3</span> <span class=nv>l</span><span class=o>=</span> <span class=m>129</span> prim:  INTEGER           :B8DB...B321
</span></span><span class=line><span class=cl>  665:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>3</span> <span class=nv>l</span><span class=o>=</span> <span class=m>129</span> prim:  INTEGER           :F24C...0E75
</span></span><span class=line><span class=cl>  797:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>3</span> <span class=nv>l</span><span class=o>=</span> <span class=m>128</span> prim:  INTEGER           :78DA...A5C1
</span></span><span class=line><span class=cl>  928:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>3</span> <span class=nv>l</span><span class=o>=</span> <span class=m>128</span> prim:  INTEGER           :516C...5D2D
</span></span><span class=line><span class=cl> 1059:d<span class=o>=</span><span class=m>1</span>  <span class=nv>hl</span><span class=o>=</span><span class=m>3</span> <span class=nv>l</span><span class=o>=</span> <span class=m>128</span> prim:  INTEGER           :4707...F154
</span></span></code></pre></div></li></ul><h3 id=part-2---der-distinguished-encoding-rules>Part 2 - DER (Distinguished Encoding Rules)<a hidden class=anchor aria-hidden=true href=#part-2---der-distinguished-encoding-rules>#</a></h3><h5 id=what-is-der>What is DER?<a hidden class=anchor aria-hidden=true href=#what-is-der>#</a></h5><ul><li>It is a specific binary encoding format that ensures consistent and unambiguous representation of data.</li><li>DER is a subset of BER (Basic Encoding Rules) providing for exactly <strong>one way</strong> to encode an ASN.1 value.<ul><li>For example, in BER a Boolean value of true can be encoded as any of 255 non-zero byte values, while in DER there is one way to encode a boolean value of true.</li></ul></li></ul><h5 id=why-do-we-need-der>Why do we need DER?<a hidden class=anchor aria-hidden=true href=#why-do-we-need-der>#</a></h5><ul><li>ASN.1 is just a notation used to specify the structure of data elements and their types. It provides a high-level description of how data should be organized. However, ASN.1 itself doesn&rsquo;t dictate a specific binary encoding format for representing this structured data. This is where DER plays a critical role.</li><li>DER is a binary encoding format that is derived from ASN.1. It defines precise rules for encoding data elements specified in ASN.1 into a compact and unambiguous binary format.</li><li>DER ensures that the encoded data can be uniquely decoded and interpreted by different systems, making it suitable for use in various applications like cryptography and network protocols.</li><li>In summary, ASN.1 is a language for specifying data structures, while DER is a specific way of encoding data according to the rules defined by ASN.1.</li></ul><h5 id=how-does-der-encode-data>How does DER encode data?<a hidden class=anchor aria-hidden=true href=#how-does-der-encode-data>#</a></h5><ul><li>TLV (Tag-Length-Value) encoding is a fundamental mechanism in DER for representing and structuring data.</li><li>The &ldquo;Tag&rdquo; identifies the data type, the &ldquo;Length&rdquo; specifies the size of the value in bytes, and the &ldquo;Value&rdquo; contains the actual data.</li><li>TLV ensures a standardized, self-descriptive format that allows for unambiguous decoding and interoperability</li><li>Example: Suppose we want to encode a message that includes a person&rsquo;s name and a short message content.<ul><li>Here&rsquo;s how the TLV structure might look in ASN.1 notation:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Message ::<span class=o>=</span> SEQUENCE <span class=o>{</span>
</span></span><span class=line><span class=cl>    personName  UTF8String,
</span></span><span class=line><span class=cl>    messageContent OCTET STRING
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><ul><li><code>Message</code> is a <code>SEQUENCE</code> type that groups two fields: <code>personName</code> (of type <code>UTF8String</code> - name in UTF-8 encoding) and <code>messageContent</code> (of type <code>OCTET STRING</code> - sequence of arbitrary bytes).</li><li>Now, let&rsquo;s encode the data &ldquo;Alice&rdquo; (person&rsquo;s name) and &ldquo;hello&rdquo; (message content) using TLV encoding in DER<ol><li><code>personName</code>:<ul><li>Tag for <code>UTF8String</code> is <code>0x0C</code></li><li>Length of &ldquo;Alice&rdquo; is 5 (0x05)</li><li>Value is the UTF-8 encoded representation of &ldquo;Alice&rdquo;</li><li>TLV-encoded bytes for &ldquo;Alice&rdquo; (person&rsquo;s name):<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>0C <span class=m>05</span> <span class=m>41</span> 6C <span class=m>69</span> <span class=m>63</span> 65	
</span></span></code></pre></div></li></ul></li><li><code>messageContent</code>:<ul><li>Tag for <code>OCTET STRING</code> is <code>0x04</code></li><li>Length of &ldquo;hello&rdquo; is 5 (0x05)</li><li>Value is the ASCII representation of &ldquo;hello&rdquo;</li><li>TLV-encoded bytes for &ldquo;hello&rdquo; (message content):<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=m>04</span> <span class=m>05</span> <span class=m>68</span> <span class=m>65</span> 6C 6C 6F
</span></span></code></pre></div></li></ul></li><li>Combine both TLV-encoded parts within the <code>SEQUENCE</code>:<ul><li><code>SEQUENCE</code> has a tag value of <code>0x30</code></li></ul><ul><li>The length of the content (data elements within the <code>SEQUENCE</code>) is <code>0x0E</code> (14 bytes).</li><li>TLV Encoded bytes for the entire sequence<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=m>30</span> 0E 0C <span class=m>05</span> <span class=m>41</span> 6C <span class=m>69</span> <span class=m>63</span> <span class=m>65</span> <span class=m>04</span> <span class=m>05</span> <span class=m>68</span> <span class=m>65</span> 6C 6C 6F
</span></span></code></pre></div></li></ul></li></ol></li></ul></li></ul><h3 id=part-3---pem-privacy-enhanced-mail>Part 3 - PEM (Privacy Enhanced Mail)<a hidden class=anchor aria-hidden=true href=#part-3---pem-privacy-enhanced-mail>#</a></h3><ul><li>PEM (Privacy-Enhanced Mail) is a widely used encoding format that originated from the email encryption and security domain.</li><li>It often uses headers like <code>-----BEGIN CERTIFICATE-----</code> and <code>-----END CERTIFICATE-----</code> to mark the boundaries of the encoded data, enabling easy storage, sharing, and transport of cryptographic information in a human-readable form.</li><li>Encoded ASN.1 data, which is usually binary, is often PEM-encoded (base64 encoded with header and trailer text) so that it can be transmitted as textual data</li><li>Example PEM format<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>-----BEGIN PUBLIC KEY-----
</span></span><span class=line><span class=cl>MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC0EZoftiJV5Cwka0/0JpqTbi0S
</span></span><span class=line><span class=cl>hBvg4USO4ZggeoRTxRLBsAm6d2L2t11GgX59jPqRBIpJDykaTazLy+hMVT8Flc+m
</span></span><span class=line><span class=cl>JO40zWiadmI4RKRILwnKhI///msR4pePenSkt4ZKftJtaBRMw3JQlP2bwrHcBHGq
</span></span><span class=line><span class=cl>lbSTqtiZxRAvYRxM0wIDAQAB
</span></span><span class=line><span class=cl>-----END PUBLIC KEY-----
</span></span></code></pre></div></li></ul><h3 id=part-4---pkcs-1-public-key-cryptography-standards>Part 4 - PKCS #1 (Public Key Cryptography Standards)<a hidden class=anchor aria-hidden=true href=#part-4---pkcs-1-public-key-cryptography-standards>#</a></h3><ul><li>A set of specifications published by RSA Laboratories that provides basic definitions and recommendations for implementing the <strong>RSA</strong> algorithm.</li><li>Primarily focuses on <strong>specifications related to RSA cryptography</strong>, including key pair generation, encryption, decryption, digital signatures, and other RSA-related operations.</li><li>An RSA public key in PKCS #1 should be represented with the <a href=https://datatracker.ietf.org/doc/html/rfc8017#appendix-A.1.1>ASN.1 type</a> <code>RSAPublicKey</code>:<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>	RSAPublicKey ::<span class=o>=</span> SEQUENCE <span class=o>{</span>
</span></span><span class=line><span class=cl>		modulus           INTEGER,  -- n
</span></span><span class=line><span class=cl>		publicExponent    INTEGER   -- e
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl>	<span class=sb>```</span>
</span></span></code></pre></div></li><li>Sample PKCS #1 RSA private key without password in PEM format<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>-----BEGIN RSA PRIVATE KEY-----
</span></span><span class=line><span class=cl>MIIBPAIBAAJBAKuwRVKZBqd/i0JpUGMdnqsw1fsXhvJMf7EBVdfEuSYcxniCTQO9
</span></span><span class=line><span class=cl>sEnrpBD6I7alMl9idAnIjwYe3qnJUNs6QLMCAwEAAQJAIIrKuPs0Xa85MB9SE1db
</span></span><span class=line><span class=cl>6crZ5DvzYh3J3j0IjltFVMmz8h6BjP43++QucRE+2UKQXuZMeVR7D2Y9AgW92/sE
</span></span><span class=line><span class=cl>kQIhANpj1ggcraLCFPzg0X6uhIldOJbesGhOyNrkj6iAttC3AiEAyUGCB0CCPt2G
</span></span><span class=line><span class=cl>j6soRoKjHsbrrhsfpQyg+vxbvycD2+UCIQCrYYmHGCpS/YfG4w7EIWQ1AAj2rI83
</span></span><span class=line><span class=cl>bAxHavIpw8izhQIhAJgq/7WcAN6ngGaAcyNdAxjyLqClwXd55P3gcT5GsZRBAiEA
</span></span><span class=line><span class=cl>jcpo7KCOxpXbbo1Z69ak/t8nnS3xyrKw1YyE9y7L06s<span class=o>=</span>
</span></span><span class=line><span class=cl>-----END RSA PRIVATE KEY-----
</span></span></code></pre></div></li></ul><h3 id=part-5---pkcs-8>Part 5 - PKCS #8<a hidden class=anchor aria-hidden=true href=#part-5---pkcs-8>#</a></h3><ul><li>One of the family of standards called Public-Key Cryptography Standards (PKCS) created by RSA Laboratories.</li><li>Describes a standard syntax for storing private key information for private keys of RSA, DSA, ECDSA, and other algorithms.</li><li>Allows private keys to be encrypted using various algorithms and encryption schemes, enhancing security.</li><li>Private-key information shall have <a href=https://datatracker.ietf.org/doc/html/rfc5208#section-5>ASN.1 type</a> <code>PrivateKeyInfo</code>:<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PrivateKeyInfo ::<span class=o>=</span> SEQUENCE <span class=o>{</span>
</span></span><span class=line><span class=cl>	version                   Version,
</span></span><span class=line><span class=cl>	privateKeyAlgorithm       PrivateKeyAlgorithmIdentifier,
</span></span><span class=line><span class=cl>	privateKey                PrivateKey,
</span></span><span class=line><span class=cl>	attributes           <span class=o>[</span>0<span class=o>]</span>  IMPLICIT Attributes OPTIONAL 
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Version ::<span class=o>=</span> INTEGER
</span></span><span class=line><span class=cl>PrivateKeyAlgorithmIdentifier ::<span class=o>=</span> AlgorithmIdentifier
</span></span><span class=line><span class=cl>AlgorithmIdentifier  ::<span class=o>=</span>  SEQUENCE  <span class=o>{</span>
</span></span><span class=line><span class=cl>    algorithm               OBJECT IDENTIFIER,
</span></span><span class=line><span class=cl>    parameters              ANY DEFINED BY algorithm OPTIONAL  
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>PrivateKey ::<span class=o>=</span> OCTET STRING
</span></span><span class=line><span class=cl>Attributes ::<span class=o>=</span> SET OF Attributes
</span></span></code></pre></div><ul><li><code>PrivateKey</code> is an octet string whose contents are the value of the private key. The interpretation of the contents is defined in the registration of the private-key algorithm. For an RSA private key, for example, the contents are a BER encoding of a value of type <code>RSAPrivateKey</code>.</li><li>Example: An RSA private key should be represented with the ASN.1 type <code>RSAPrivateKey</code> as specified in <a href=https://datatracker.ietf.org/doc/html/rfc8017#appendix-A.1.2>PKCS #1</a>:<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl> RSAPrivateKey ::<span class=o>=</span> SEQUENCE <span class=o>{</span>
</span></span><span class=line><span class=cl>	 version           Version,
</span></span><span class=line><span class=cl>	 modulus           INTEGER,  -- n
</span></span><span class=line><span class=cl>	 publicExponent    INTEGER,  -- e
</span></span><span class=line><span class=cl>	 privateExponent   INTEGER,  -- d
</span></span><span class=line><span class=cl>	 prime1            INTEGER,  -- p
</span></span><span class=line><span class=cl>	 prime2            INTEGER,  -- q
</span></span><span class=line><span class=cl>	 exponent1         INTEGER,  -- d mod <span class=o>(</span>p-1<span class=o>)</span>
</span></span><span class=line><span class=cl>	 exponent2         INTEGER,  -- d mod <span class=o>(</span>q-1<span class=o>)</span>
</span></span><span class=line><span class=cl>	 coefficient       INTEGER,  -- <span class=o>(</span>inverse of q<span class=o>)</span> mod p
</span></span><span class=line><span class=cl>	 otherPrimeInfos   OtherPrimeInfos OPTIONAL
</span></span><span class=line><span class=cl> <span class=o>}</span>
</span></span></code></pre></div></li></ul></li><li>Sample PKCS #8 RSA private key without password in PEM format<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>-----BEGIN PRIVATE KEY-----
</span></span><span class=line><span class=cl>MIIBVgIBADANBgkqhkiG9w0BAQEFAASCAUAwggE8AgEAAkEAq7BFUpkGp3+LQmlQ
</span></span><span class=line><span class=cl>Yx2eqzDV+xeG8kx/sQFV18S5JhzGeIJNA72wSeukEPojtqUyX2J0CciPBh7eqclQ
</span></span><span class=line><span class=cl>2zpAswIDAQABAkAgisq4+zRdrzkwH1ITV1vpytnkO/NiHcnePQiOW0VUybPyHoGM
</span></span><span class=line><span class=cl>/jf75C5xET7ZQpBe5kx5VHsPZj0CBb3b+wSRAiEA2mPWCBytosIU/ODRfq6EiV04
</span></span><span class=line><span class=cl>lt6waE7I2uSPqIC20LcCIQDJQYIHQII+3YaPqyhGgqMexuuuGx+lDKD6/Fu/JwPb
</span></span><span class=line><span class=cl>5QIhAKthiYcYKlL9h8bjDsQhZDUACPasjzdsDEdq8inDyLOFAiEAmCr/tZwA3qeA
</span></span><span class=line><span class=cl>ZoBzI10DGPIuoKXBd3nk/eBxPkaxlEECIQCNymjsoI7GldtujVnr1qT+3yedLfHK
</span></span><span class=line><span class=cl><span class=nv>srDVjIT3LsvTqw</span><span class=o>==</span>
</span></span><span class=line><span class=cl>-----END PRIVATE KEY-----
</span></span></code></pre></div></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://partbypart.github.io/tags/first/>First</a></li></ul><nav class=paginav><a class=prev href=https://partbypart.github.io/posts/deep-dive-subjectpublickeyinfo-rsa-public-key/><span class=title>« Prev</span><br><span>Deep dive - Anatomy of a SubjectPublicKeyInfo RSA public key</span>
</a><a class=next href=https://partbypart.github.io/posts/encrypt-decrypt-file-using-openssl-command/><span class=title>Next »</span><br><span>Encrypt/Decrypt a file using openssl command</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Demystifying ASN.1, DER, PEM, PKCS1 and PKCS8 on x" href="https://x.com/intent/tweet/?text=Demystifying%20ASN.1%2c%20DER%2c%20PEM%2c%20PKCS1%20and%20PKCS8&amp;url=https%3a%2f%2fpartbypart.github.io%2fposts%2fdemystifying-asn1-der-pem-pkcs1-pkcs8%2f&amp;hashtags=first"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Demystifying ASN.1, DER, PEM, PKCS1 and PKCS8 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fpartbypart.github.io%2fposts%2fdemystifying-asn1-der-pem-pkcs1-pkcs8%2f&amp;title=Demystifying%20ASN.1%2c%20DER%2c%20PEM%2c%20PKCS1%20and%20PKCS8&amp;summary=Demystifying%20ASN.1%2c%20DER%2c%20PEM%2c%20PKCS1%20and%20PKCS8&amp;source=https%3a%2f%2fpartbypart.github.io%2fposts%2fdemystifying-asn1-der-pem-pkcs1-pkcs8%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Demystifying ASN.1, DER, PEM, PKCS1 and PKCS8 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fpartbypart.github.io%2fposts%2fdemystifying-asn1-der-pem-pkcs1-pkcs8%2f&title=Demystifying%20ASN.1%2c%20DER%2c%20PEM%2c%20PKCS1%20and%20PKCS8"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Demystifying ASN.1, DER, PEM, PKCS1 and PKCS8 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fpartbypart.github.io%2fposts%2fdemystifying-asn1-der-pem-pkcs1-pkcs8%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Demystifying ASN.1, DER, PEM, PKCS1 and PKCS8 on whatsapp" href="https://api.whatsapp.com/send?text=Demystifying%20ASN.1%2c%20DER%2c%20PEM%2c%20PKCS1%20and%20PKCS8%20-%20https%3a%2f%2fpartbypart.github.io%2fposts%2fdemystifying-asn1-der-pem-pkcs1-pkcs8%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Demystifying ASN.1, DER, PEM, PKCS1 and PKCS8 on telegram" href="https://telegram.me/share/url?text=Demystifying%20ASN.1%2c%20DER%2c%20PEM%2c%20PKCS1%20and%20PKCS8&amp;url=https%3a%2f%2fpartbypart.github.io%2fposts%2fdemystifying-asn1-der-pem-pkcs1-pkcs8%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Demystifying ASN.1, DER, PEM, PKCS1 and PKCS8 on ycombinator" href="https://news.ycombinator.com/submitlink?t=Demystifying%20ASN.1%2c%20DER%2c%20PEM%2c%20PKCS1%20and%20PKCS8&u=https%3a%2f%2fpartbypart.github.io%2fposts%2fdemystifying-asn1-der-pem-pkcs1-pkcs8%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://partbypart.github.io/>Learn part by part</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a><br><a href=https://www.flaticon.com/free-icons/timber title="timber icons">Timber icons created by imaginationlol - Flaticon</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>