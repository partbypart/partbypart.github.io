<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Load FIPS module using OpenSSL 3 config file | Learn part by part</title>
<meta name=keywords content="fips,openssl3,openssl.cnf"><meta name=description content="Learn how to load and use OpenSSL 3.0.8 FIPS module from config file"><meta name=author content><link rel=canonical href=http://localhost:1313/posts/load-fips-module-by-config/><meta name=google-site-verification content="G-MF6MC03DXC"><link crossorigin=anonymous href=/assets/css/stylesheet.c7cdf9ec6ae3b64eadba619dd56fa18edf29c5eccfcb44ab0084078b63dfa9c7.css integrity="sha256-x8357Grjtk6tumGd1W+hjt8pxezPy0SrAIQHi2Pfqcc=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=alternate hreflang=en href=http://localhost:1313/posts/load-fips-module-by-config/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-MF6MC03DXC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-MF6MC03DXC")}</script><meta property="og:url" content="http://localhost:1313/posts/load-fips-module-by-config/"><meta property="og:site_name" content="Learn part by part"><meta property="og:title" content="Load FIPS module using OpenSSL 3 config file"><meta property="og:description" content="Learn how to load and use OpenSSL 3.0.8 FIPS module from config file"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:tag" content="Fips"><meta property="article:tag" content="Openssl3"><meta property="article:tag" content="Openssl.cnf"><meta property="og:image" content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:title content="Load FIPS module using OpenSSL 3 config file"><meta name=twitter:description content="Learn how to load and use OpenSSL 3.0.8 FIPS module from config file"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Load FIPS module using OpenSSL 3 config file","item":"http://localhost:1313/posts/load-fips-module-by-config/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Load FIPS module using OpenSSL 3 config file","name":"Load FIPS module using OpenSSL 3 config file","description":"Learn how to load and use OpenSSL 3.0.8 FIPS module from config file","keywords":["fips","openssl3","openssl.cnf"],"articleBody":"Prerequisites OpenSSL 3.0.8 built/installed [How to build and install OpenSSL 3.0.8 on linux] Why OpenSSL 3.0.8? OpenSSL 3.0.8 is the FIPS validated version (Certificate)(Valid until: 9/21/2026) OpenSSL 3 headers, OpenSSL 3 crypto library (libcrypto.a), OpenSSL 3 openssl.cnf and OpenSSL 3 fipsmodule.cnf $ mkdir -p ~/projects/fips-auto-load/ $ cd ~/projects/fips-auto-load/ $ cp -r ~/installed/openssl-3.0.8/{ssl,include,lib} ~/projects/fips-auto-load/ $ ls -gG ~/projects/fips-auto-load/ total 16 drwxrwxr-x 3 4096 Aug 1 05:23 include drwxrwxr-x 5 4096 Aug 1 05:22 lib -rw-rw-r-- 1 2579 Aug 2 02:53 main.c drwxrwxr-x 5 4096 Aug 2 02:29 ssl $ find . \\( -name libcrypto.a -o -name fips.so \\ -o -name openssl.cnf -o -name fipsmodule.cnf \\) ./ssl/openssl.cnf ./ssl/fipsmodule.cnf ./lib/libcrypto.a ./lib/ossl-modules/fips.so Edit ssl/openssl.cnf to enable fips section and add the path to include fipsmodule.cnf. (Reference: Making all applications use the FIPS module by default) $ grep \"fips = fips_sect\\|^\\.include\" ssl/openssl.cnf .include /home/alice/projects/fips-auto-load/ssl/fipsmodule.cnf fips = fips_sect NOTE: The path to fipsmodule.cnf in the .include should be absolute and full path. If you wish to use relative path, you need to set OPENSSL_CONF_INCLUDE environment variable to specify the directory for included files (Reference: OPENSSL_CONF_INCLUDE) Ensure default provider is not enabled in openssl.cnf (activate = 1 should be commented out) $ grep -A1 \"\\[default_sect\\]\" ssl/openssl.cnf [default_sect] # activate = 1 Constructing the program A program can load and use FIPS implementations in any of the following ways: Explicitly load a config file pointing to fipsmodule.cnf (with activate = 1 ) using OSSL_LIB_CTX_load_config() API. Loading a config file with activated fips section, loads the fips provider in the program and prevents automatic loading of fallback providers. Provide a path to config file pointing to fipsmodule.cnf (with activate = 1 ) using environment variable OPENSSL_CONF and explicitly load fips provider using OSSL_PROVIDER_load() API before performing any crypto operations. If you attempt any crypto operations or make calls like OSSL_PROVIDER_available() before loading fips provider, the fallback default provider will be loaded and your program needs to set additional property query (fips=yes) to explicitly fetch fips provider implementations of digests. Without the explicit property query, we’re not guaranteed to get a fips provider implementation of the requested digest/cipher. Provide a path to config file pointing to fipsmodule.cnf (with activate = 1 ) using environment variable OPENSSL_CONF and fetch your cipher/digest implementation before performing any other crypto operations. If fips provider is loaded first, then default provider will have to be loaded explicitly if required. It will not be loaded automatically. This approach does not require setting any property query since fips will be the only loaded provider. NOTE: The sample program used in this page will follow the third approach (Automatic loading) Accept digest name as user input and set a default text to create digest if not provided by user. Default text is set to “hello world” if (argc \u003e 1) { digest_algorithm = argv[1]; /* Use a default message for hashing if not provided by user */ message = (argv[2] == NULL) ? \"hello world\" : argv[2]; } Create ctx_init() function to perform the following tasks: Set default search path that is to be used for looking for providers in the specified libctx (NULL) using OSSL_PROVIDER_set_default_search_path() API. If this is not set, the path used for search is determined by MODULESDIR as reported by $ ~/installed/openssl-3.0.8/bin/openssl version -m Load a configuration file (ssl/openssl.cnf) into a given libctx (NULL) using OSSL_LIB_CTX_load_config() API. If this is not set, the path used for configuration file will be determined by OPENSSLDIR as reported by $ ~/installed/openssl-3.0.8/bin/openssl version -d NOTE: NULL is the default OpenSSL library context void ctx_init( char *provider_path, const char *config_path) { /* * Set the default search path to look for * providers in the specified library context (NULL) */ if (!OSSL_PROVIDER_set_default_search_path(NULL, provider_path)) { fprintf(stdout, \"[ERR] Failed to set provider search path to: %s\\n\", provider_path); ERR_print_errors_fp(stdout); exit(EXIT_FAILURE); } /* * Load the given configuration file into the * default library context (NULL) */ if (!OSSL_LIB_CTX_load_config(NULL, config_path)) { fprintf(stdout, \"[ERR] Failed to load config path: %s\\n\", config_path); ERR_print_errors_fp(stdout); exit(EXIT_FAILURE); } } Call EVP_MD_fetch() to fetch a digest implementation for a given digest algorithm name from the NULL library context without any property query. This should return an implementation from the loaded provider. digest = EVP_MD_fetch(NULL, digest_algorithm, NULL); Print the provider name for reference. Since there are no crypto operations before calling EVP_MD_fetch() and since fips section has been activated in fipsmodule.cnf, fips provider will be loaded and printed on this line fprintf(stdout, \"Provider: %s\\n\", OSSL_PROVIDER_get0_name(EVP_MD_get0_provider(digest))); Use a single shot simple wrapper function like EVP_Digest() to calculate the digest of a single piece of text NOTE: EVP_Q_digest() can also be used but it doesn’t allow us to verify the provider used. if (!EVP_Digest(message, strlen(message), md, \u0026mdlen, digest, NULL)) { fprintf(stdout, \"[ERR] Failed to calculate %s digest\\n\", digest_algorithm); rc = 0; goto err; } Create a function print_digest() to print the digest in hex void print_digest( char *digest_name, char *message, unsigned char *md, unsigned int mdlen) { if (mdlen) { fprintf(stdout, \"%s(\\\"%s\\\") = \", digest_name, message); while (mdlen) { fprintf(stdout, \"%02x\", *md++); mdlen--; } fprintf(stdout, \"\\n\"); } } Release the fetched digest implementation and exit by returning success Complete program #include #include #include #include #include void usage(char **argv) { fprintf(stderr, \"Usage:\\n\"); fprintf(stderr, \"%s []\\n\\n\", argv[0]); fprintf(stderr, \":\\tExample: \\\"md5\\\", \\\"sha1\\\", \" \"\\\"sha256\\\", \\\"sha384\\\", \\\"sha512\\\"\\n\"); fprintf(stderr, \"[]:\\tAny text (optional)\\n\\n\"); } void print_digest( char *digest_name, char *message, unsigned char *md, unsigned int mdlen) { if (mdlen) { fprintf(stdout, \"%s(\\\"%s\\\") = \", digest_name, message); while (mdlen) { fprintf(stdout, \"%02x\", *md++); mdlen--; } fprintf(stdout, \"\\n\"); } } void ctx_init( char *provider_path, const char *config_path) { /* * Set the default search path to look for * providers in the specified library context (NULL) */ if (!OSSL_PROVIDER_set_default_search_path(NULL, provider_path)) { fprintf(stdout, \"[ERR] Failed to set provider search path to: %s\\n\", provider_path); ERR_print_errors_fp(stdout); exit(EXIT_FAILURE); } /* * Load the given configuration file into the * default library context (NULL) */ if (!OSSL_LIB_CTX_load_config(NULL, config_path)) { fprintf(stdout, \"[ERR] Failed to load config path: %s\\n\", config_path); ERR_print_errors_fp(stdout); exit(EXIT_FAILURE); } } int main(int argc, char *argv[]) { EVP_MD *digest = NULL; char *message = NULL; int rc = 1; char *digest_algorithm = NULL; unsigned char md[EVP_MAX_MD_SIZE] = {}; unsigned char *mdptr = md; unsigned int mdlen = 0; /* Make sure lib/ossl-modules has fips.so provider */ char *provider_path = \"lib/ossl-modules\"; /* * Make sure openssl.cnf points to a fipsmodule.cnf * that has \"activate = 1\" set for fips provider */ const char *config_path = \"ssl/openssl.cnf\"; if (argc \u003e 1) { digest_algorithm = argv[1]; /* Use a default message for hashing if not provided by user */ message = (argv[2] == NULL) ? \"hello world\" : argv[2]; } else { /* Make sure digest name is supplied as argument */ fprintf(stderr, \"[ERR] Digest name missing\\n\"); usage(argv); exit(EXIT_FAILURE); } /* * Set default search path for providers and load * the given config file into the default library context */ ctx_init(provider_path, config_path); /* * Fetch the digest implementation for the given * algorithm from any available provider */ digest = EVP_MD_fetch(NULL, digest_algorithm, NULL); if (digest == NULL) { fprintf(stdout, \"[ERR] Failed to fetch %s digest implementation\\n\", digest_algorithm); exit(EXIT_FAILURE); } fprintf(stdout, \"Provider: %s\\n\", OSSL_PROVIDER_get0_name(EVP_MD_get0_provider(digest))); /* * EVP_Digest() is a wrapper around the Digest Init_ex, * Update and Final_ex functions. */ if (!EVP_Digest(message, strlen(message), md, \u0026mdlen, digest, NULL)) { fprintf(stdout, \"[ERR] Failed to calculate %s digest\\n\", digest_algorithm); rc = 0; goto err; } print_digest(digest_algorithm, message, mdptr, mdlen); err: EVP_MD_free(digest); ERR_print_errors_fp(stdout); if (!rc) { exit(EXIT_FAILURE); } exit(EXIT_SUCCESS); } Compilation Make sure you have gcc $ gcc --version | head -1 gcc (Ubuntu 11.3.0-1ubuntu1~22.04.1) 11.3.0 If gcc cannot be found, install it Rocky linux $ sudo yum install gcc Ubuntu $ apt install gcc Compile with required OpenSSL headers and libraries $ gcc -ggdb3 -O0 -I include -L lib -o program main.c -lcrypto Where, -ggdb3: Produce debugging information for use by GDB. Level 3 includes extra information, such as all the macro definitions present in the program -O0: Disable most optimizations -I include: Add the directory include to the list of directories to be searched for header files during preprocessing. -L lib: Add directory lib to the list of directories to be searched for -l. -o program: Place the primary output in file program (Primary output in this case is an executable). If -o is not specified, the default is to put an executable file in a.out. main.c: File(s) to be compiled and linked with library -lcrypto: Link with a library named libcrypto.a NOTE: -lcrypto should be at the end. It shouldn’t appear before main.c. The traditional behavior of linkers is to search for external functions from left to right in the libraries specified on the command line. This means that a library containing the definition of a function should appear after any source files or object files which use it. Execution Run the program and attempt calculating a message digest using FIPS approved digests $ ./program sha1 Provider: fips sha1(\"hello world\") = 2aae6c35c94fcfb415dbe95f408b9ce91ee846ed $ ./program sha256 Provider: fips sha256(\"hello world\") = b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9 $ ./program sha384 Provider: fips sha384(\"hello world\") = fdbd8e75a67f29f701a4e040385e2e23986303ea10239211af907fcbb83578b3e417cb71ce646efd0819dd8c088de1bd $ ./program sha512 Provider: fips sha512(\"hello world\") = 309ecc489c12d6eb4cc40f50c902f2b4d0ed77ee511a7c7a9bcd3ca86d4cd86f989dd35bc5ff499670da34255b45b0cfd830e81f605dcf7dc5542e93ae9cd76f Verify if the calculated digests are correct $ echo -n \"hello world\" | ~/installed/openssl-3.0.8/bin/openssl sha1 SHA1(stdin)= 2aae6c35c94fcfb415dbe95f408b9ce91ee846ed $ echo -n \"hello world\" | ~/installed/openssl-3.0.8/bin/openssl sha256 SHA2-256(stdin)= b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9 $ echo -n \"hello world\" | ~/installed/openssl-3.0.8/bin/openssl sha384 SHA2-384(stdin)= fdbd8e75a67f29f701a4e040385e2e23986303ea10239211af907fcbb83578b3e417cb71ce646efd0819dd8c088de1bd $ echo -n \"hello world\" | ~/installed/openssl-3.0.8/bin/openssl sha512 SHA2-512(stdin)= 309ecc489c12d6eb4cc40f50c902f2b4d0ed77ee511a7c7a9bcd3ca86d4cd86f989dd35bc5ff499670da34255b45b0cfd830e81f605dcf7dc5542e93ae9cd76f Run the program and attempt calculating a message digest using non-FIPS digest like md5 $ ./program md5 [ERR] Failed to fetch md5 digest implementation References gcc - options to add header file directories to search path gcc - search path gcc - directory search options gcc - Output options gcc - options for debugging your C program gcc - options that control optimization OpenSSL 3 API reference - OSSL_LIB_CTX_load_config() OpenSSL 3 API reference - OSSL_PROVIDER_set_default_search_path() OpenSSL 3 API reference - EVP_MD_fetch() OpenSSL 3 API reference - EVP_MD_get0_provider() OpenSSL 3 API reference - OSSL_PROVIDER_get0_name() OpenSSL 3 API reference - EVP_Digest() ","wordCount":"1653","inLanguage":"en","image":"http://localhost:1313/%3Cimage%20path/url%3E","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/load-fips-module-by-config/"},"publisher":{"@type":"Organization","name":"Learn part by part","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="PartByPart (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>PartByPart</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=CATEGORIES><span>CATEGORIES</span></a></li><li><a href=http://localhost:1313/tags/ title=TAGS><span>TAGS</span></a></li><li><a href=http://localhost:1313/archives/ title=ARCHIVES><span>ARCHIVES</span></a></li><li><a href=http://localhost:1313/search/ title="SEARCH (Alt + /)" accesskey=/><span>SEARCH</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Load FIPS module using OpenSSL 3 config file
<span class=entry-hint title=Draft><svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h1><div class=post-description>Learn how to load and use OpenSSL 3.0.8 FIPS module from config file</div><div class=post-meta>8 min&nbsp;·&nbsp;1653 words</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#constructing-the-program>Constructing the program</a></li><li><a href=#complete-program>Complete program</a></li><li><a href=#compilation>Compilation</a></li><li><a href=#execution>Execution</a></li><li><a href=#references>References</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h3 id=prerequisites>Prerequisites<a hidden class=anchor aria-hidden=true href=#prerequisites>#</a></h3><ul><li>OpenSSL 3.0.8 built/installed<ul><li>[How to build and install OpenSSL 3.0.8 on linux]</li><li>Why OpenSSL 3.0.8?<ul><li>OpenSSL 3.0.8 is the FIPS validated version (<a href=https://csrc.nist.gov/projects/cryptographic-module-validation-program/certificate/4282>Certificate</a>)(Valid until: 9/21/2026)</li></ul></li></ul></li><li>OpenSSL 3 headers, OpenSSL 3 crypto library (<code>libcrypto.a</code>), OpenSSL 3 <code>openssl.cnf</code> and OpenSSL 3 <code>fipsmodule.cnf</code><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mkdir -p ~/projects/fips-auto-load/
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> ~/projects/fips-auto-load/
</span></span><span class=line><span class=cl>$ cp -r ~/installed/openssl-3.0.8/<span class=o>{</span>ssl,include,lib<span class=o>}</span> ~/projects/fips-auto-load/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ ls -gG ~/projects/fips-auto-load/
</span></span><span class=line><span class=cl>total <span class=m>16</span>
</span></span><span class=line><span class=cl>drwxrwxr-x <span class=m>3</span> <span class=m>4096</span> Aug  <span class=m>1</span> 05:23 include
</span></span><span class=line><span class=cl>drwxrwxr-x <span class=m>5</span> <span class=m>4096</span> Aug  <span class=m>1</span> 05:22 lib
</span></span><span class=line><span class=cl>-rw-rw-r-- <span class=m>1</span> <span class=m>2579</span> Aug  <span class=m>2</span> 02:53 main.c
</span></span><span class=line><span class=cl>drwxrwxr-x <span class=m>5</span> <span class=m>4096</span> Aug  <span class=m>2</span> 02:29 ssl
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ find . <span class=se>\(</span> -name libcrypto.a -o -name fips.so <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-o -name openssl.cnf -o -name fipsmodule.cnf <span class=se>\)</span>
</span></span><span class=line><span class=cl>./ssl/openssl.cnf
</span></span><span class=line><span class=cl>./ssl/fipsmodule.cnf
</span></span><span class=line><span class=cl>./lib/libcrypto.a
</span></span><span class=line><span class=cl>./lib/ossl-modules/fips.so
</span></span></code></pre></div></li><li>Edit <code>ssl/openssl.cnf</code> to enable <code>fips</code> section and add the path to include <code>fipsmodule.cnf</code>. (Reference: <a href=https://www.openssl.org/docs/man3.0/man7/fips_module.html>Making all applications use the FIPS module by default</a>)<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ grep <span class=s2>&#34;fips = fips_sect\|^\.include&#34;</span> ssl/openssl.cnf
</span></span><span class=line><span class=cl>.include /home/alice/projects/fips-auto-load/ssl/fipsmodule.cnf
</span></span><span class=line><span class=cl><span class=nv>fips</span> <span class=o>=</span> fips_sect
</span></span></code></pre></div><ul><li>NOTE: The path to <code>fipsmodule.cnf</code> in the <code>.include</code> should be absolute and full path. If you wish to use relative path, you need to set <code>OPENSSL_CONF_INCLUDE</code> environment variable to specify the directory for included files (Reference: <a href=https://www.openssl.org/docs/manmaster/man7/openssl-env.html>OPENSSL_CONF_INCLUDE</a>)</li><li>Ensure <code>default</code> provider is <strong>not</strong> enabled in <code>openssl.cnf</code> (<code>activate = 1</code> should be commented out)<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ grep -A1 <span class=s2>&#34;\[default_sect\]&#34;</span> ssl/openssl.cnf
</span></span><span class=line><span class=cl><span class=o>[</span>default_sect<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=c1># activate = 1</span>
</span></span></code></pre></div></li></ul></li></ul><h3 id=constructing-the-program>Constructing the program<a hidden class=anchor aria-hidden=true href=#constructing-the-program>#</a></h3><ul><li>A program can load and use FIPS implementations in any of the following ways:<ul><li>Explicitly load a config file pointing to <code>fipsmodule.cnf</code> (with <code>activate = 1</code> ) using <code>OSSL_LIB_CTX_load_config()</code> <a href=https://www.openssl.org/docs/man3.0/man3/OSSL_LIB_CTX_load_config.html>API</a>. Loading a config file with activated fips section, loads the <code>fips</code> provider in the program and prevents automatic loading of fallback providers.</li><li>Provide a path to config file pointing to <code>fipsmodule.cnf</code> (with <code>activate = 1</code> ) using environment variable <code>OPENSSL_CONF</code> and explicitly load <code>fips</code> provider using <code>OSSL_PROVIDER_load()</code> <a href=https://www.openssl.org/docs/manmaster/man3/OSSL_PROVIDER_load.html>API</a> <strong>before</strong> performing any crypto operations. If you attempt any crypto operations or make calls like <code>OSSL_PROVIDER_available()</code> before loading <code>fips</code> provider, the fallback <code>default</code> provider will be loaded and your program needs to set additional property query (<code>fips=yes</code>) to explicitly fetch <code>fips</code> provider implementations of digests. Without the explicit property query, we&rsquo;re not guaranteed to get a <code>fips</code> provider implementation of the requested digest/cipher.</li><li>Provide a path to config file pointing to <code>fipsmodule.cnf</code> (with <code>activate = 1</code> ) using environment variable <code>OPENSSL_CONF</code> and fetch your cipher/digest implementation <strong>before</strong> performing any other crypto operations. If <code>fips</code> provider is loaded first, then <code>default</code> provider will have to be loaded explicitly if required. It will not be loaded automatically. This approach does not require setting any property query since <code>fips</code> will be the only loaded provider.</li><li>NOTE: The sample program used in this page will follow the <em>third</em> approach (Automatic loading)</li></ul></li><li>Accept digest name as user input and set a default text to create digest if not provided by user. Default text is set to &ldquo;hello world&rdquo;<div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>argc</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>digest_algorithm</span> <span class=o>=</span> <span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* Use a default message for hashing if not provided by user */</span>
</span></span><span class=line><span class=cl>    <span class=n>message</span> <span class=o>=</span> <span class=p>(</span><span class=n>argv</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span> <span class=o>?</span> <span class=s>&#34;hello world&#34;</span> <span class=o>:</span> <span class=n>argv</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li><li>Create <code>ctx_init()</code> function to perform the following tasks:<ul><li>Set default search path that is to be used for looking for providers in the specified <code>libctx</code> (NULL) using <code>OSSL_PROVIDER_set_default_search_path()</code> <a href=https://www.openssl.org/docs/manmaster/man3/OSSL_PROVIDER_set_default_search_path.html>API</a>. If this is not set, the path used for search is determined by <code>MODULESDIR</code> as reported by <code>$ ~/installed/openssl-3.0.8/bin/openssl version -m</code></li><li>Load a configuration file (<code>ssl/openssl.cnf</code>) into a given <code>libctx</code> (NULL) using <code>OSSL_LIB_CTX_load_config()</code> <a href=https://www.openssl.org/docs/man3.0/man3/OSSL_LIB_CTX_load_config.html>API</a>. If this is not set, the path used for configuration file will be determined by <code>OPENSSLDIR</code> as reported by <code>$ ~/installed/openssl-3.0.8/bin/openssl version -d</code></li><li>NOTE: <code>NULL</code> is the default OpenSSL library context</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>ctx_init</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=o>*</span><span class=n>provider_path</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>config_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>     * Set the default search path to look for
</span></span></span><span class=line><span class=cl><span class=cm>     * providers in the specified library context (NULL)
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nf>OSSL_PROVIDER_set_default_search_path</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span> <span class=n>provider_path</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>fprintf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=s>&#34;[ERR] Failed to set provider search path to: %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>provider_path</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>ERR_print_errors_fp</span><span class=p>(</span><span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>exit</span><span class=p>(</span><span class=n>EXIT_FAILURE</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm>     * Load the given configuration file into the
</span></span></span><span class=line><span class=cl><span class=cm>     * default library context (NULL)
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nf>OSSL_LIB_CTX_load_config</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span> <span class=n>config_path</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>fprintf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=s>&#34;[ERR] Failed to load config path: %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>config_path</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>ERR_print_errors_fp</span><span class=p>(</span><span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>exit</span><span class=p>(</span><span class=n>EXIT_FAILURE</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li><li>Call <code>EVP_MD_fetch()</code> to fetch a digest implementation for a given digest algorithm name from the <code>NULL</code> library context without any property query. This should return an implementation from the loaded provider.<div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>digest</span> <span class=o>=</span> <span class=nf>EVP_MD_fetch</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span> <span class=n>digest_algorithm</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>);</span>
</span></span></code></pre></div></li><li>Print the provider name for reference. Since there are no crypto operations before calling <code>EVP_MD_fetch()</code> and since <code>fips</code> section has been activated in <code>fipsmodule.cnf</code>, <code>fips</code> provider will be loaded and printed on this line<div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=nf>fprintf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=s>&#34;Provider: %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nf>OSSL_PROVIDER_get0_name</span><span class=p>(</span><span class=nf>EVP_MD_get0_provider</span><span class=p>(</span><span class=n>digest</span><span class=p>)));</span>
</span></span></code></pre></div></li><li>Use a single shot simple wrapper function like <code>EVP_Digest()</code> to calculate the digest of a single piece of text<ul><li>NOTE: <code>EVP_Q_digest()</code> can also be used but it doesn&rsquo;t allow us to verify the provider used.<div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nf>EVP_Digest</span><span class=p>(</span><span class=n>message</span><span class=p>,</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>message</span><span class=p>),</span> <span class=n>md</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>mdlen</span><span class=p>,</span> <span class=n>digest</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>fprintf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=s>&#34;[ERR] Failed to calculate %s digest</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>digest_algorithm</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>rc</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>goto</span> <span class=n>err</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ul></li><li>Create a function <code>print_digest()</code> to print the digest in hex<div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>print_digest</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=o>*</span><span class=n>digest_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=o>*</span><span class=n>message</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>md</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>mdlen</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>mdlen</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>fprintf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=s>&#34;%s(</span><span class=se>\&#34;</span><span class=s>%s</span><span class=se>\&#34;</span><span class=s>) = &#34;</span><span class=p>,</span> <span class=n>digest_name</span><span class=p>,</span> <span class=n>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=p>(</span><span class=n>mdlen</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nf>fprintf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=s>&#34;%02x&#34;</span><span class=p>,</span> <span class=o>*</span><span class=n>md</span><span class=o>++</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>mdlen</span><span class=o>--</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nf>fprintf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=s>&#34;</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li><li>Release the fetched digest implementation and exit by returning success</li></ul><h3 id=complete-program>Complete program<a hidden class=anchor aria-hidden=true href=#complete-program>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;openssl/evp.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;openssl/provider.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;openssl/err.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>usage</span><span class=p>(</span><span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span> <span class=s>&#34;Usage:</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span> <span class=s>&#34;%s &lt;digest_name&gt; [&lt;message_to_hash&gt;]</span><span class=se>\n\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>argv</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=nf>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span> <span class=s>&#34;&lt;digest_name&gt;:</span><span class=se>\t</span><span class=s>Example: </span><span class=se>\&#34;</span><span class=s>md5</span><span class=se>\&#34;</span><span class=s>, </span><span class=se>\&#34;</span><span class=s>sha1</span><span class=se>\&#34;</span><span class=s>, &#34;</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;</span><span class=se>\&#34;</span><span class=s>sha256</span><span class=se>\&#34;</span><span class=s>, </span><span class=se>\&#34;</span><span class=s>sha384</span><span class=se>\&#34;</span><span class=s>, </span><span class=se>\&#34;</span><span class=s>sha512</span><span class=se>\&#34;\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span> <span class=s>&#34;[&lt;message&gt;]:</span><span class=se>\t</span><span class=s>Any text (optional)</span><span class=se>\n\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>print_digest</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=o>*</span><span class=n>digest_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=o>*</span><span class=n>message</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>md</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>mdlen</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>mdlen</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>fprintf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=s>&#34;%s(</span><span class=se>\&#34;</span><span class=s>%s</span><span class=se>\&#34;</span><span class=s>) = &#34;</span><span class=p>,</span> <span class=n>digest_name</span><span class=p>,</span> <span class=n>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=p>(</span><span class=n>mdlen</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nf>fprintf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=s>&#34;%02x&#34;</span><span class=p>,</span> <span class=o>*</span><span class=n>md</span><span class=o>++</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>mdlen</span><span class=o>--</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nf>fprintf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=s>&#34;</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span>
</span></span><span class=line><span class=cl><span class=nf>ctx_init</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=o>*</span><span class=n>provider_path</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>config_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>     * Set the default search path to look for
</span></span></span><span class=line><span class=cl><span class=cm>     * providers in the specified library context (NULL)
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nf>OSSL_PROVIDER_set_default_search_path</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span> <span class=n>provider_path</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>fprintf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=s>&#34;[ERR] Failed to set provider search path to: %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>provider_path</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>ERR_print_errors_fp</span><span class=p>(</span><span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>exit</span><span class=p>(</span><span class=n>EXIT_FAILURE</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm>     * Load the given configuration file into the
</span></span></span><span class=line><span class=cl><span class=cm>     * default library context (NULL)
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nf>OSSL_LIB_CTX_load_config</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span> <span class=n>config_path</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>fprintf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=s>&#34;[ERR] Failed to load config path: %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>config_path</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>ERR_print_errors_fp</span><span class=p>(</span><span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>exit</span><span class=p>(</span><span class=n>EXIT_FAILURE</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>argv</span><span class=p>[])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>EVP_MD</span> <span class=o>*</span><span class=n>digest</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=o>*</span><span class=n>message</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>rc</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=o>*</span><span class=n>digest_algorithm</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>char</span> <span class=n>md</span><span class=p>[</span><span class=n>EVP_MAX_MD_SIZE</span><span class=p>]</span> <span class=o>=</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>mdptr</span> <span class=o>=</span> <span class=n>md</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>mdlen</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/* Make sure lib/ossl-modules has fips.so provider */</span>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=o>*</span><span class=n>provider_path</span> <span class=o>=</span> <span class=s>&#34;lib/ossl-modules&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>     * Make sure openssl.cnf points to a fipsmodule.cnf
</span></span></span><span class=line><span class=cl><span class=cm>     * that has &#34;activate = 1&#34; set for fips provider
</span></span></span><span class=line><span class=cl><span class=cm>     */</span> 
</span></span><span class=line><span class=cl>    <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>config_path</span> <span class=o>=</span> <span class=s>&#34;ssl/openssl.cnf&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>argc</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>digest_algorithm</span> <span class=o>=</span> <span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=cm>/* Use a default message for hashing if not provided by user */</span>
</span></span><span class=line><span class=cl>        <span class=n>message</span> <span class=o>=</span> <span class=p>(</span><span class=n>argv</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span> <span class=o>?</span> <span class=s>&#34;hello world&#34;</span> <span class=o>:</span> <span class=n>argv</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=cm>/* Make sure digest name is supplied as argument */</span>
</span></span><span class=line><span class=cl>        <span class=nf>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span> <span class=s>&#34;[ERR] Digest name missing</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>usage</span><span class=p>(</span><span class=n>argv</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>exit</span><span class=p>(</span><span class=n>EXIT_FAILURE</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm>     * Set default search path for providers and load
</span></span></span><span class=line><span class=cl><span class=cm>     * the given config file into the default library context
</span></span></span><span class=line><span class=cl><span class=cm>     */</span> 
</span></span><span class=line><span class=cl>    <span class=nf>ctx_init</span><span class=p>(</span><span class=n>provider_path</span><span class=p>,</span> <span class=n>config_path</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>     * Fetch the digest implementation for the given 
</span></span></span><span class=line><span class=cl><span class=cm>     * algorithm from any available provider
</span></span></span><span class=line><span class=cl><span class=cm>     */</span> 
</span></span><span class=line><span class=cl>    <span class=n>digest</span> <span class=o>=</span> <span class=nf>EVP_MD_fetch</span><span class=p>(</span><span class=nb>NULL</span><span class=p>,</span> <span class=n>digest_algorithm</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>digest</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>fprintf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=s>&#34;[ERR] Failed to fetch %s digest implementation</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>digest_algorithm</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>exit</span><span class=p>(</span><span class=n>EXIT_FAILURE</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nf>fprintf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=s>&#34;Provider: %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nf>OSSL_PROVIDER_get0_name</span><span class=p>(</span><span class=nf>EVP_MD_get0_provider</span><span class=p>(</span><span class=n>digest</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm>     * EVP_Digest() is a wrapper around the Digest Init_ex, 
</span></span></span><span class=line><span class=cl><span class=cm>     * Update and Final_ex functions.
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nf>EVP_Digest</span><span class=p>(</span><span class=n>message</span><span class=p>,</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>message</span><span class=p>),</span> <span class=n>md</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>mdlen</span><span class=p>,</span> <span class=n>digest</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>fprintf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,</span> <span class=s>&#34;[ERR] Failed to calculate %s digest</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>digest_algorithm</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>rc</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>goto</span> <span class=n>err</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nf>print_digest</span><span class=p>(</span><span class=n>digest_algorithm</span><span class=p>,</span> <span class=n>message</span><span class=p>,</span> <span class=n>mdptr</span><span class=p>,</span> <span class=n>mdlen</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nl>err</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nf>EVP_MD_free</span><span class=p>(</span><span class=n>digest</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>ERR_print_errors_fp</span><span class=p>(</span><span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>rc</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>exit</span><span class=p>(</span><span class=n>EXIT_FAILURE</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nf>exit</span><span class=p>(</span><span class=n>EXIT_SUCCESS</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=compilation>Compilation<a hidden class=anchor aria-hidden=true href=#compilation>#</a></h3><ul><li>Make sure you have <code>gcc</code><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ gcc --version <span class=p>|</span> head -1
</span></span><span class=line><span class=cl>gcc <span class=o>(</span>Ubuntu 11.3.0-1ubuntu1~22.04.1<span class=o>)</span> 11.3.0
</span></span></code></pre></div><ul><li>If <code>gcc</code> cannot be found, install it<ul><li>Rocky linux<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo yum install gcc
</span></span></code></pre></div></li><li>Ubuntu<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ apt install gcc
</span></span></code></pre></div></li></ul></li></ul></li><li>Compile with required OpenSSL headers and libraries<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ gcc -ggdb3 -O0 -I include -L lib -o program main.c -lcrypto
</span></span></code></pre></div><ul><li>Where,<ul><li><code>-ggdb3</code>: Produce debugging information for use by GDB. Level 3 includes extra information, such as all the macro definitions present in the program</li><li><code>-O0</code>: Disable most optimizations</li><li><code>-I include</code>: Add the directory <code>include</code> to the list of directories to be searched for header files during preprocessing.</li><li><code>-L lib</code>: Add directory <code>lib</code> to the list of directories to be searched for <code>-l</code>.</li><li><code>-o program</code>: Place the primary output in file <code>program</code> (Primary output in this case is an executable). If <code>-o</code> is not specified, the default is to put an executable file in <code>a.out</code>.</li><li><code>main.c</code>: File(s) to be compiled and linked with library</li><li><code>-lcrypto</code>: Link with a library named <code>libcrypto.a</code></li></ul></li><li>NOTE: <code>-lcrypto</code> should be at the end. It shouldn&rsquo;t appear before <code>main.c</code>. The traditional behavior of linkers is to search for external functions from left to right in the libraries specified on the command line. This means that a library containing the definition of a function should appear after any source files or object files which use it.</li></ul></li></ul><h3 id=execution>Execution<a hidden class=anchor aria-hidden=true href=#execution>#</a></h3><ul><li>Run the program and attempt calculating a message digest using FIPS approved digests<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ./program sha1
</span></span><span class=line><span class=cl>Provider: fips
</span></span><span class=line><span class=cl>sha1<span class=o>(</span><span class=s2>&#34;hello world&#34;</span><span class=o>)</span> <span class=o>=</span> 2aae6c35c94fcfb415dbe95f408b9ce91ee846ed
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ ./program sha256
</span></span><span class=line><span class=cl>Provider: fips
</span></span><span class=line><span class=cl>sha256<span class=o>(</span><span class=s2>&#34;hello world&#34;</span><span class=o>)</span> <span class=o>=</span> b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ ./program sha384
</span></span><span class=line><span class=cl>Provider: fips
</span></span><span class=line><span class=cl>sha384<span class=o>(</span><span class=s2>&#34;hello world&#34;</span><span class=o>)</span> <span class=o>=</span> fdbd8e75a67f29f701a4e040385e2e23986303ea10239211af907fcbb83578b3e417cb71ce646efd0819dd8c088de1bd
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ ./program sha512
</span></span><span class=line><span class=cl>Provider: fips
</span></span><span class=line><span class=cl>sha512<span class=o>(</span><span class=s2>&#34;hello world&#34;</span><span class=o>)</span> <span class=o>=</span> 309ecc489c12d6eb4cc40f50c902f2b4d0ed77ee511a7c7a9bcd3ca86d4cd86f989dd35bc5ff499670da34255b45b0cfd830e81f605dcf7dc5542e93ae9cd76f
</span></span></code></pre></div></li><li>Verify if the calculated digests are correct<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> -n <span class=s2>&#34;hello world&#34;</span> <span class=p>|</span> ~/installed/openssl-3.0.8/bin/openssl sha1
</span></span><span class=line><span class=cl>SHA1<span class=o>(</span>stdin<span class=o>)=</span> 2aae6c35c94fcfb415dbe95f408b9ce91ee846ed
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ <span class=nb>echo</span> -n <span class=s2>&#34;hello world&#34;</span> <span class=p>|</span> ~/installed/openssl-3.0.8/bin/openssl sha256
</span></span><span class=line><span class=cl>SHA2-256<span class=o>(</span>stdin<span class=o>)=</span> b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ <span class=nb>echo</span> -n <span class=s2>&#34;hello world&#34;</span> <span class=p>|</span> ~/installed/openssl-3.0.8/bin/openssl sha384
</span></span><span class=line><span class=cl>SHA2-384<span class=o>(</span>stdin<span class=o>)=</span> fdbd8e75a67f29f701a4e040385e2e23986303ea10239211af907fcbb83578b3e417cb71ce646efd0819dd8c088de1bd
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ <span class=nb>echo</span> -n <span class=s2>&#34;hello world&#34;</span> <span class=p>|</span> ~/installed/openssl-3.0.8/bin/openssl sha512
</span></span><span class=line><span class=cl>SHA2-512<span class=o>(</span>stdin<span class=o>)=</span> 309ecc489c12d6eb4cc40f50c902f2b4d0ed77ee511a7c7a9bcd3ca86d4cd86f989dd35bc5ff499670da34255b45b0cfd830e81f605dcf7dc5542e93ae9cd76f
</span></span></code></pre></div></li><li>Run the program and attempt calculating a message digest using non-FIPS digest like <code>md5</code><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ./program md5
</span></span><span class=line><span class=cl><span class=o>[</span>ERR<span class=o>]</span> Failed to fetch md5 digest implementation
</span></span></code></pre></div></li></ul><h3 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h3><ul><li><a href=https://gcc.gnu.org/onlinedocs/cpp/Invocation.html>gcc - options to add header file directories to search path</a></li><li><a href=https://gcc.gnu.org/onlinedocs/cpp/Search-Path.html>gcc - search path</a></li><li><a href=https://gcc.gnu.org/onlinedocs/gcc/Directory-Options.html>gcc - directory search options</a></li><li><a href=https://gcc.gnu.org/onlinedocs/gcc/Overall-Options.html>gcc - Output options</a></li><li><a href=https://gcc.gnu.org/onlinedocs/gcc/Debugging-Options.html#Options-for-Debugging-Your-Program>gcc - options for debugging your C program</a></li><li><a href=https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html#Options-That-Control-Optimization>gcc - options that control optimization</a></li><li><a href=https://www.openssl.org/docs/man3.0/man3/OSSL_LIB_CTX_load_config.html>OpenSSL 3 API reference - OSSL_LIB_CTX_load_config()</a></li><li><a href=https://www.openssl.org/docs/man3.0/man3/OSSL_PROVIDER_set_default_search_path.html>OpenSSL 3 API reference - OSSL_PROVIDER_set_default_search_path()</a></li><li><a href=https://www.openssl.org/docs/man3.0/man3/EVP_MD_fetch.html>OpenSSL 3 API reference - EVP_MD_fetch()</a></li><li><a href=https://www.openssl.org/docs/man3.0/man3/EVP_MD_get0_provider.html>OpenSSL 3 API reference - EVP_MD_get0_provider()</a></li><li><a href=https://www.openssl.org/docs/man3.0/man3/OSSL_PROVIDER_get0_name.html>OpenSSL 3 API reference - OSSL_PROVIDER_get0_name()</a></li><li><a href=https://www.openssl.org/docs/man3.0/man3/EVP_Digest.html>OpenSSL 3 API reference - EVP_Digest()</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/fips/>Fips</a></li><li><a href=http://localhost:1313/tags/openssl3/>Openssl3</a></li><li><a href=http://localhost:1313/tags/openssl.cnf/>Openssl.cnf</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/deep-dive-pkcs1-rsa-private-key/><span class=title>« Prev</span><br><span>Deep dive - Anatomy of a PKCS#1 RSA private key</span>
</a><a class=next href=http://localhost:1313/posts/quick-bytes-oauth-grant-types/><span class=title>Next »</span><br><span>Quick bytes - Introduction to OAuth 2.0 grant types</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Load FIPS module using OpenSSL 3 config file on x" href="https://x.com/intent/tweet/?text=Load%20FIPS%20module%20using%20OpenSSL%203%20config%20file&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fload-fips-module-by-config%2f&amp;hashtags=fips%2copenssl3%2copenssl.cnf"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Load FIPS module using OpenSSL 3 config file on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fload-fips-module-by-config%2f&amp;title=Load%20FIPS%20module%20using%20OpenSSL%203%20config%20file&amp;summary=Load%20FIPS%20module%20using%20OpenSSL%203%20config%20file&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fload-fips-module-by-config%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Load FIPS module using OpenSSL 3 config file on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fload-fips-module-by-config%2f&title=Load%20FIPS%20module%20using%20OpenSSL%203%20config%20file"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Load FIPS module using OpenSSL 3 config file on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fload-fips-module-by-config%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Load FIPS module using OpenSSL 3 config file on whatsapp" href="https://api.whatsapp.com/send?text=Load%20FIPS%20module%20using%20OpenSSL%203%20config%20file%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fload-fips-module-by-config%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Load FIPS module using OpenSSL 3 config file on telegram" href="https://telegram.me/share/url?text=Load%20FIPS%20module%20using%20OpenSSL%203%20config%20file&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fload-fips-module-by-config%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Load FIPS module using OpenSSL 3 config file on ycombinator" href="https://news.ycombinator.com/submitlink?t=Load%20FIPS%20module%20using%20OpenSSL%203%20config%20file&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fload-fips-module-by-config%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Learn part by part</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a><br><a href=https://www.flaticon.com/free-icons/timber title="timber icons">Timber icons created by imaginationlol - Flaticon</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>